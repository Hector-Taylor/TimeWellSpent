{"version":3,"file":"app-pp1ZKoQF.js","sources":["../../src/shared/time.ts","../../src/renderer/components/PomodoroPanel.tsx","../../src/renderer/components/DayCompass.tsx","../../src/renderer/components/ActivityChart.tsx","../../src/renderer/components/DayJourney.tsx","../../src/renderer/components/AttentionMap.tsx","../../src/renderer/components/Insights.tsx","../../src/renderer/components/FriendDetailModal.tsx","../../src/renderer/components/Dashboard.tsx","../../src/renderer/components/Domains.tsx","../../src/renderer/components/CurveEditor.tsx","../../src/renderer/components/EconomyTuner.tsx","../../src/renderer/components/Settings.tsx","../../src/renderer/components/Analytics.tsx","../../src/renderer/components/SudokuChallenge.tsx","../../src/renderer/components/PaywallOverlay.tsx","../../src/renderer/components/Library.tsx","../../src/renderer/components/Friends.tsx","../../src/shared/trophies.ts","../../src/renderer/components/Profile.tsx","../../src/renderer/components/Games.tsx","../../src/renderer/components/CameraCapture.tsx","../../src/renderer/components/DailyOnboardingModal.tsx","../../src/renderer/App.tsx","../../src/renderer/main.tsx"],"sourcesContent":["export const DAY_START_HOUR = 4;\n\nexport function shiftHourToDayStart(hour: number, dayStartHour: number = DAY_START_HOUR) {\n  const normalized = ((hour - dayStartHour) % 24 + 24) % 24;\n  return normalized;\n}\n\nexport function unshiftHourFromDayStart(shiftedHour: number, dayStartHour: number = DAY_START_HOUR) {\n  return (shiftedHour + dayStartHour) % 24;\n}\n\nexport function getLocalDayStartMs(referenceMs: number, dayStartHour: number = DAY_START_HOUR) {\n  const date = new Date(referenceMs);\n  if (date.getHours() < dayStartHour) {\n    date.setDate(date.getDate() - 1);\n  }\n  date.setHours(dayStartHour, 0, 0, 0);\n  return date.getTime();\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport type { PomodoroMode, PomodoroSession, RendererApi } from '@shared/types';\n\ntype Props = {\n  api: RendererApi;\n};\n\ntype AllowlistEntry = { value: string; kind: 'site' | 'app' };\n\nexport default function PomodoroPanel({ api }: Props) {\n  const [session, setSession] = useState<PomodoroSession | null>(null);\n  const [remainingMs, setRemainingMs] = useState(0);\n  const [mode, setMode] = useState<PomodoroMode>('strict');\n  const [duration, setDuration] = useState(25);\n  const [breakDuration, setBreakDuration] = useState(5);\n  const [temporaryUnlock, setTemporaryUnlock] = useState(5);\n  const [allowlist, setAllowlist] = useState<AllowlistEntry[]>([]);\n  const [suggested, setSuggested] = useState<AllowlistEntry[]>([]);\n  const [customAllowlist, setCustomAllowlist] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    api.pomodoro.status().then((s) => {\n      if (s) {\n        setSession(s);\n        setRemainingMs(s.remainingMs);\n        setMode(s.mode);\n      }\n    });\n\n    const unsubTick = api.events.on<PomodoroSession>('pomodoro:tick', (payload) => {\n      setSession((prev) => (prev ? { ...prev, ...payload } : payload));\n      setRemainingMs(payload.remainingMs);\n    });\n    const unsubStart = api.events.on<PomodoroSession>('pomodoro:start', (payload) => {\n      setSession(payload);\n      setRemainingMs(payload.remainingMs);\n      setMode(payload.mode);\n    });\n    const unsubStop = api.events.on<PomodoroSession>('pomodoro:stop', () => {\n      setSession(null);\n      setRemainingMs(0);\n    });\n    const unsubPause = api.events.on<PomodoroSession>('pomodoro:pause', (payload) => setSession(payload));\n    const unsubResume = api.events.on<PomodoroSession>('pomodoro:resume', (payload) => setSession(payload));\n\n    return () => {\n      unsubTick();\n      unsubStart();\n      unsubStop();\n      unsubPause();\n      unsubResume();\n    };\n  }, [api]);\n\n  useEffect(() => {\n    api.settings.categorisation()\n      .then((cfg) => {\n        const productives = (cfg?.productive ?? []).map<AllowlistEntry>((value) => ({ value, kind: 'site' }));\n        const defaults: AllowlistEntry[] = [\n          { value: 'docs.google.com', kind: 'site' },\n          { value: 'notion.so', kind: 'site' },\n          { value: 'linear.app', kind: 'site' },\n          { value: 'github.com', kind: 'site' },\n          { value: 'stackoverflow.com', kind: 'site' }\n        ];\n        const merged = [...productives, ...defaults];\n        const unique: AllowlistEntry[] = [];\n        const seen = new Set<string>();\n        for (const entry of merged) {\n          const key = `${entry.kind}:${entry.value.toLowerCase()}`;\n          if (seen.has(key)) continue;\n          seen.add(key);\n          unique.push(entry);\n        }\n        setSuggested(unique);\n        setAllowlist(unique.slice(0, 3));\n      })\n      .catch(() => {\n        // fallback to defaults if categorisation fails\n        setSuggested([\n          { value: 'docs.google.com', kind: 'site' },\n          { value: 'notion.so', kind: 'site' },\n          { value: 'linear.app', kind: 'site' }\n        ]);\n        setAllowlist([\n          { value: 'docs.google.com', kind: 'site' },\n          { value: 'notion.so', kind: 'site' },\n          { value: 'linear.app', kind: 'site' }\n        ]);\n      });\n  }, [api.settings]);\n\n  const formattedTime = useMemo(() => {\n    const ms = session ? remainingMs : duration * 60 * 1000;\n    const totalSec = Math.max(0, Math.round(ms / 1000));\n    const minutes = Math.floor(totalSec / 60);\n    const seconds = totalSec % 60;\n    return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  }, [remainingMs, duration, session]);\n\n  async function start() {\n    try {\n      setLoading(true);\n      const allowlistPayload = allowlist.map((entry, idx) => ({\n        id: `${entry.value}-${idx}`,\n        kind: entry.kind,\n        value: entry.value\n      }));\n      const config = {\n        durationSec: duration * 60,\n        breakDurationSec: breakDuration * 60,\n        mode,\n        allowlist: allowlistPayload,\n        temporaryUnlockSec: temporaryUnlock * 60\n      };\n      const next = await api.pomodoro.start(config);\n      setSession(next);\n      setRemainingMs(next.remainingMs);\n    } catch (error) {\n      console.error('Failed to start pomodoro', error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function addAllowlist(value: string) {\n    const cleaned = value.trim();\n    if (!cleaned) return;\n    if (allowlist.some((entry) => entry.value.toLowerCase() === cleaned.toLowerCase())) return;\n    setAllowlist((prev) => [...prev, { value: cleaned, kind: 'site' }]);\n  }\n\n  function removeAllowlist(value: string) {\n    setAllowlist((prev) => prev.filter((entry) => entry.value !== value));\n  }\n\n  async function stop(reason: 'completed' | 'canceled' | 'expired' = 'canceled') {\n    setLoading(true);\n    try {\n      await api.pomodoro.stop(reason);\n      setSession(null);\n      setRemainingMs(0);\n    } catch (error) {\n      console.error('Failed to stop pomodoro', error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function pause() {\n    setLoading(true);\n    try {\n      const next = await api.pomodoro.pause();\n      setSession(next);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function resume() {\n    setLoading(true);\n    try {\n      const next = await api.pomodoro.resume();\n      setSession(next);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function triggerBreak() {\n    setLoading(true);\n    try {\n      const next = await api.pomodoro.startBreak(breakDuration * 60);\n      setSession(next);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"card pomodoro-card\">\n      <div className=\"card-header-row\">\n        <div>\n          <p className=\"eyebrow\">Pomodoro</p>\n          <h2>Allowlist focus</h2>\n        </div>\n        <span className=\"pill ghost\">{session ? session.mode : mode}</span>\n      </div>\n\n      <div className=\"pomodoro-grid\">\n        <div className=\"pomodoro-timer\">\n          <div className=\"pomodoro-face\">\n            <span className=\"pomodoro-time\">{formattedTime}</span>\n            <span className=\"pomodoro-label\">{session ? session.state : 'idle'}</span>\n          </div>\n          <div className=\"pomodoro-controls\">\n            {session ? (\n              <>\n                <button onClick={() => stop('canceled')} disabled={loading} className=\"ghost\">End</button>\n                {session.state === 'paused' ? (\n                  <button onClick={resume} disabled={loading} className=\"primary\">Resume</button>\n                ) : (\n                  <button onClick={pause} disabled={loading} className=\"ghost\">Pause</button>\n                )}\n                <button onClick={triggerBreak} disabled={loading} className=\"ghost\">Start break</button>\n              </>\n            ) : (\n              <button onClick={start} disabled={loading} className=\"primary\">Start focus</button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"pomodoro-config\">\n          <label className=\"field\">\n            <span>Duration (minutes)</span>\n            <input type=\"number\" min={5} max={180} value={duration} onChange={(e) => setDuration(Number(e.target.value) || 0)} />\n          </label>\n          <label className=\"field\">\n            <span>Break length (minutes)</span>\n            <input type=\"number\" min={1} max={60} value={breakDuration} onChange={(e) => setBreakDuration(Number(e.target.value) || 0)} />\n          </label>\n          <label className=\"field\">\n            <span>Mode</span>\n            <div className=\"segmented\">\n              <button className={mode === 'strict' ? 'active' : ''} onClick={() => setMode('strict')}>Strict</button>\n              <button className={mode === 'soft' ? 'active' : ''} onClick={() => setMode('soft')}>Soft</button>\n            </div>\n          </label>\n          <label className=\"field\">\n            <span>Soft unlock minutes</span>\n            <input type=\"number\" min={1} max={30} value={temporaryUnlock} onChange={(e) => setTemporaryUnlock(Number(e.target.value) || 0)} />\n          </label>\n          <label className=\"field\">\n            <div className=\"field-label\">\n              <span>Allowlist</span>\n              <span className=\"info-tooltip\" title=\"Add productive domains in the Domains section!\">?</span>\n            </div>\n            <div className=\"allowlist-picker\">\n              <select\n                value=\"\"\n                onChange={(e) => {\n                  addAllowlist(e.target.value);\n                }}\n              >\n                <option value=\"\" disabled>Select a site</option>\n                {suggested.filter((entry) => !allowlist.some((sel) => sel.value === entry.value && sel.kind === entry.kind)).map((entry) => (\n                  <option key={entry.value} value={entry.value}>{entry.value}</option>\n                ))}\n              </select>\n              <div className=\"allowlist-custom\">\n                <input\n                  type=\"text\"\n                  placeholder=\"custom site or app\"\n                  value={customAllowlist}\n                  onChange={(e) => setCustomAllowlist(e.target.value)}\n                />\n                <button type=\"button\" className=\"ghost\" onClick={() => { addAllowlist(customAllowlist); setCustomAllowlist(''); }} disabled={!customAllowlist.trim()}>\n                  Add\n                </button>\n              </div>\n              {allowlist.length > 0 && (\n                <div className=\"allowlist-tags\">\n                  {allowlist.map((entry) => (\n                    <span key={entry.value} className=\"pill\">\n                      {entry.value}\n                      <button type=\"button\" className=\"chip-remove\" onClick={() => removeAllowlist(entry.value)} aria-label={`Remove ${entry.value}`}>√ó</button>\n                    </span>\n                  ))}\n                </div>\n              )}\n            </div>\n          </label>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useMemo, useState } from 'react';\nimport type { ActivitySummary, EconomyState } from '@shared/types';\n\ntype DayCompassProps = {\n  summary: ActivitySummary | null;\n  economy: EconomyState | null;\n};\n\ntype CompassView = 'aggregate' | 'timeline';\n\ntype SliceMeta = {\n  path: string;\n  color: string;\n  label: string;\n  seconds: number;\n  slot?: ActivitySummary['timeline'][number];\n};\n\nconst categoryColors: Record<string, string> = {\n  productive: 'var(--cat-productive)',\n  neutral: 'var(--cat-neutral)',\n  frivolity: 'var(--cat-frivolity)',\n  draining: 'var(--cat-draining)',\n  idle: 'var(--cat-idle)'\n};\n\nexport default function DayCompass({ summary, economy }: DayCompassProps) {\n  const [view, setView] = useState<CompassView>('aggregate');\n  const [hoveredIndex, setHoveredIndex] = useState<number | null>(null);\n\n  const aggregate = useMemo(() => {\n    if (!summary) return null;\n    const totals = summary.totalsByCategory;\n    const slices = [\n      { key: 'productive', label: 'Productive', seconds: totals.productive ?? 0, color: categoryColors.productive },\n      { key: 'neutral', label: 'Neutral', seconds: (totals.neutral ?? 0) + (totals.uncategorised ?? 0), color: categoryColors.neutral },\n      { key: 'frivolity', label: 'Frivolity', seconds: totals.frivolity ?? 0, color: categoryColors.frivolity },\n      { key: 'draining', label: 'Draining', seconds: (totals as any).draining ?? 0, color: categoryColors.draining },\n      { key: 'idle', label: 'Idle', seconds: totals.idle ?? 0, color: categoryColors.idle }\n    ].filter((item) => item.seconds > 0);\n\n    const totalSeconds = slices.reduce((sum, item) => sum + item.seconds, 0);\n    let cursor = -90;\n    const arcs: SliceMeta[] = slices.map((slice) => {\n      const sweep = totalSeconds ? (slice.seconds / totalSeconds) * 360 : 0;\n      const path = buildArc(150, 150, 120, cursor, cursor + sweep);\n      cursor += sweep;\n      return {\n        path,\n        color: slice.color,\n        label: slice.label,\n        seconds: slice.seconds\n      };\n    });\n\n    return { arcs, slices, totalSeconds: Math.max(0, totalSeconds) };\n  }, [summary]);\n\n  const timeline = useMemo(() => {\n    if (!summary || summary.timeline.length === 0) return { arcs: [] as SliceMeta[], centerSeconds: 0 };\n    const step = 360 / summary.timeline.length;\n    const windowSeconds = (summary.windowHours ?? 24) * 3600;\n    const arcs = summary.timeline.map((slot, idx) => {\n      const startAngle = idx * step - 90;\n      const endAngle = startAngle + step;\n      const path = buildArc(150, 150, 120, startAngle, endAngle);\n      const color = categoryColors[slot.dominant] ?? categoryColors.neutral;\n      return {\n        path,\n        color,\n        label: slot.hour,\n        slot,\n        seconds: slot.productive + slot.neutral + slot.frivolity + slot.draining + slot.idle\n      };\n    });\n    const centerSeconds = Math.min(\n      windowSeconds,\n      (summary.totalSeconds ?? 0) + (summary.totalsByCategory.idle ?? 0)\n    );\n    return { arcs, centerSeconds };\n  }, [summary]);\n\n  if (!summary) {\n    return (\n      <article className=\"card compass-card\">\n        <h2>Day compass</h2>\n        <p className=\"subtle\">We need at least one tracked session to build your orbit.</p>\n      </article>\n    );\n  }\n\n  const activeTimelineSlot =\n    view === 'timeline'\n      ? (hoveredIndex !== null ? summary.timeline[hoveredIndex] : summary.timeline[summary.timeline.length - 1])\n      : null;\n  const activeTimelineDominant = activeTimelineSlot?.dominant;\n\n  const breakdown = view === 'aggregate'\n    ? (aggregate?.slices ?? [])\n    : activeTimelineSlot ? [\n      { label: 'Productive', seconds: activeTimelineSlot.productive, color: categoryColors.productive },\n      { label: 'Neutral', seconds: activeTimelineSlot.neutral, color: categoryColors.neutral },\n      { label: 'Frivolity', seconds: activeTimelineSlot.frivolity, color: categoryColors.frivolity },\n      { label: 'Draining', seconds: activeTimelineSlot.draining, color: categoryColors.draining },\n      { label: 'Idle', seconds: activeTimelineSlot.idle, color: categoryColors.idle }\n    ] : [];\n\n  const windowSeconds = (summary?.windowHours ?? 24) * 3600;\n  const centerSeconds = view === 'aggregate'\n    ? Math.min(windowSeconds, aggregate?.totalSeconds ?? 0)\n    : timeline.centerSeconds;\n\n  const arcs = view === 'aggregate' ? (aggregate?.arcs ?? []) : timeline.arcs;\n\n  return (\n    <article className=\"card compass-card\">\n      <div className=\"card-header-row compass-header\">\n        <div>\n          <p className=\"eyebrow\">Day diagram</p>\n          <h2>Orbit of attention</h2>\n        </div>\n        <div className=\"compass-controls\">\n          <div className=\"compass-toggle\">\n            <button\n              className={view === 'aggregate' ? 'active' : ''}\n              onClick={() => { setView('aggregate'); setHoveredIndex(null); }}\n            >\n              Total day\n            </button>\n            <button\n              className={view === 'timeline' ? 'active' : ''}\n              onClick={() => { setView('timeline'); setHoveredIndex(null); }}\n            >\n              24h orbit\n            </button>\n          </div>\n          <span className=\"pill ghost\">{economy?.activeCategory ?? 'idle'} ‚Ä¢ live</span>\n        </div>\n      </div>\n      <div className=\"compass-body\">\n        <div className=\"compass-visual\">\n          <svg viewBox=\"0 0 300 300\" role=\"img\" aria-label=\"Day compass\">\n            <circle cx=\"150\" cy=\"150\" r=\"140\" fill=\"rgba(255,255,255,0.02)\" stroke=\"rgba(255,255,255,0.05)\" strokeWidth=\"1\" />\n            {arcs.map((slice, idx) => (\n              <path\n                key={`${slice.label}-${idx}`}\n                d={slice.path}\n                fill={slice.color}\n                opacity={hoveredIndex !== null && hoveredIndex !== idx ? 0.35 : 0.92}\n                onMouseEnter={() => setHoveredIndex(idx)}\n                onMouseLeave={() => setHoveredIndex(null)}\n              />\n            ))}\n            <circle cx=\"150\" cy=\"150\" r=\"80\" fill=\"var(--bg-soft)\" stroke=\"rgba(255,255,255,0.08)\" strokeWidth=\"2\" />\n            <text x=\"150\" y=\"140\" textAnchor=\"middle\" className=\"compass-center\">\n              {formatHours(centerSeconds)}\n            </text>\n            <text x=\"150\" y=\"165\" textAnchor=\"middle\" className=\"compass-center-sub\">\n              {view === 'aggregate' ? 'hours captured' : `${summary.windowHours}h window`}\n            </text>\n          </svg>\n          {view === 'timeline' && activeTimelineSlot && (\n            <div className=\"compass-tooltip\">\n              <div>\n                <span className=\"tooltip-hour\">{activeTimelineSlot.hour}</span>\n                <span className=\"tooltip-dominant\">{activeTimelineDominant}</span>\n              </div>\n              {activeTimelineSlot.topContext ? (\n                <p>\n                  {activeTimelineSlot.topContext.label}\n                  <br />\n                  <small>{Math.round(activeTimelineSlot.topContext.seconds / 60)} min captured</small>\n                </p>\n              ) : (\n                <p>No activity recorded</p>\n              )}\n            </div>\n          )}\n        </div>\n        <div className=\"compass-details\">\n          {breakdown.map((row) => (\n            <div key={row.label} className=\"detail-row\">\n              <div className=\"legend-chip\">\n                <span style={{ background: row.color }} />\n                <span>{row.label}</span>\n              </div>\n              <strong>{formatMinutes(row.seconds)}</strong>\n            </div>\n          ))}\n        </div>\n      </div>\n    </article>\n  );\n}\n\nfunction buildArc(cx: number, cy: number, radius: number, startAngle: number, endAngle: number) {\n  const start = polarToCartesian(cx, cy, radius, endAngle);\n  const end = polarToCartesian(cx, cy, radius, startAngle);\n  const largeArc = endAngle - startAngle <= 180 ? '0' : '1';\n  return ['M', start.x, start.y, 'A', radius, radius, 0, largeArc, 0, end.x, end.y, 'L', cx, cy, 'Z'].join(' ');\n}\n\nfunction polarToCartesian(cx: number, cy: number, radius: number, angleInDegrees: number) {\n  const angleInRadians = (angleInDegrees * Math.PI) / 180.0;\n  return {\n    x: cx + radius * Math.cos(angleInRadians),\n    y: cy + radius * Math.sin(angleInRadians)\n  };\n}\n\nfunction formatMinutes(value: number) {\n  if (!value) return '0m';\n  const minutes = Math.round(value / 60);\n  return `${minutes}m`;\n}\n\nfunction formatHours(value: number) {\n  const hours = Math.max(0, value) / 3600;\n  return `${Math.round(hours * 10) / 10}h`;\n}\n","import { useMemo, useState } from 'react';\nimport type { ActivityRecord, ActivitySummary } from '@shared/types';\n\ninterface ActivityChartProps {\n  activities: ActivityRecord[];\n  summary?: ActivitySummary | null;\n}\n\nexport default function ActivityChart({ activities, summary }: ActivityChartProps) {\n  const colors: Record<string, string> = {\n    productive: 'var(--cat-productive)',\n    neutral: 'var(--cat-neutral)',\n    frivolity: 'var(--cat-frivolity)',\n    draining: 'var(--cat-draining)',\n    idle: 'var(--cat-idle)'\n  };\n  type CategoryKey = keyof typeof colors;\n  const [hovered, setHovered] = useState<CategoryKey | null>(null);\n  const cutoff = Date.now() - 24 * 60 * 60 * 1000; // rolling 24h window\n\n  const stats = useMemo(() => {\n    if (summary) {\n      const totals = summary.totalsByCategory;\n      const productive = totals.productive ?? 0;\n      const neutral = (totals.neutral ?? 0) + (totals.uncategorised ?? 0);\n      const frivolity = totals.frivolity ?? 0;\n      const draining = (totals as any).draining ?? 0;\n      const idle = totals.idle ?? 0;\n      const totalSeconds = productive + neutral + frivolity + draining + idle;\n      return {\n        total: totalSeconds,\n        byCategory: {\n          productive,\n          neutral,\n          frivolity,\n          draining,\n          idle\n        }\n      };\n    }\n\n    const recentActivities = activities.filter((activity) => new Date(activity.startedAt).getTime() >= cutoff);\n    const totalActive = recentActivities.reduce((acc, curr) => acc + curr.secondsActive, 0);\n    const totalIdle = recentActivities.reduce((acc, curr) => acc + curr.idleSeconds, 0);\n    const total = totalActive + totalIdle;\n    const byCategory: Record<string, number> = { productive: 0, neutral: 0, frivolity: 0, draining: 0, idle: 0 };\n    recentActivities.forEach((curr) => {\n      const raw = curr.category || 'neutral';\n      byCategory[raw] = (byCategory[raw] || 0) + curr.secondsActive;\n    });\n    byCategory.idle = totalIdle;\n\n    return { total, byCategory };\n  }, [activities, summary, cutoff]);\n\n  const breakdownByCategory = useMemo(() => {\n    const base: Record<CategoryKey, Array<{ label: string; seconds: number }>> = {\n      productive: [],\n      neutral: [],\n      frivolity: [],\n      draining: [],\n      idle: []\n    };\n\n    if (summary?.topContexts) {\n      summary.topContexts.forEach((ctx) => {\n        if (!ctx.category) return;\n        const cat = ctx.category as CategoryKey;\n        base[cat].push({ label: ctx.label, seconds: ctx.seconds });\n      });\n    } else {\n      const recentActivities = activities.filter((activity) => new Date(activity.startedAt).getTime() >= cutoff);\n      const buckets = new Map<string, { label: string; cat: CategoryKey; seconds: number }>();\n      recentActivities.forEach((activity) => {\n        const raw = activity.category || 'neutral';\n        const cat = raw as CategoryKey;\n        const label = activity.domain ?? activity.appName ?? 'Unknown';\n        const key = `${cat}:${label}`;\n        if (!buckets.has(key)) {\n          buckets.set(key, { label, cat, seconds: 0 });\n        }\n        const entry = buckets.get(key)!;\n        entry.seconds += activity.secondsActive;\n      });\n      buckets.forEach((entry) => base[entry.cat].push({ label: entry.label, seconds: entry.seconds }));\n    }\n\n    (Object.keys(base) as CategoryKey[]).forEach((cat) => {\n      base[cat] = base[cat].sort((a, b) => b.seconds - a.seconds);\n    });\n\n    return base;\n  }, [activities, summary, cutoff]);\n\n  if (stats.total === 0) {\n    return (\n      <div className=\"card\" style={{ alignItems: 'center', justifyContent: 'center', minHeight: '240px' }}>\n        <p className=\"subtle\">No activity recorded yet</p>\n      </div>\n    );\n  }\n\n  let currentAngle = 0;\n  const radius = 90;\n  const center = 110;\n\n  const entries = Object.entries(stats.byCategory) as Array<[keyof typeof colors, number]>;\n\n  const slices = entries.map(([category, seconds]) => {\n    const percentage = seconds / stats.total;\n    const angle = percentage * 360;\n\n    const x1 = center + radius * Math.cos((Math.PI * currentAngle) / 180);\n    const y1 = center + radius * Math.sin((Math.PI * currentAngle) / 180);\n    const x2 = center + radius * Math.cos((Math.PI * (currentAngle + angle)) / 180);\n    const y2 = center + radius * Math.sin((Math.PI * (currentAngle + angle)) / 180);\n\n    const largeArcFlag = angle > 180 ? 1 : 0;\n\n    const pathData = [\n      `M ${center} ${center}`,\n      `L ${x1} ${y1}`,\n      `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,\n      'Z'\n    ].join(' ');\n\n    currentAngle += angle;\n\n    return {\n      category,\n      path: pathData,\n      color: colors[category] || colors.neutral,\n      percentage: Math.round(percentage * 100)\n    };\n  });\n\n  const highlight = summary?.topContexts?.[0];\n  const tooltipCategory = hovered;\n  const tooltipSeconds = tooltipCategory ? stats.byCategory[tooltipCategory] ?? 0 : 0;\n  const tooltipPercent = tooltipCategory && stats.total > 0 ? Math.round((tooltipSeconds / stats.total) * 100) : 0;\n\n  return (\n    <div className=\"card activity-card\">\n      <div className=\"card-header-row\">\n        <div>\n          <h2>Time distribution</h2>\n          <p className=\"subtle\">Blended from desktop apps and the extension feed.</p>\n        </div>\n        {highlight && (\n          <div className=\"pill ghost\">\n            {highlight.label} ¬∑ {Math.round(highlight.seconds / 60)}m\n          </div>\n        )}\n      </div>\n      <div className=\"activity-chart\" style={{ position: 'relative', overflow: 'visible' }}>\n        {tooltipCategory && (\n          <div\n            className=\"activity-tooltip\"\n            style={{\n              position: 'absolute',\n              top: '50%',\n              left: '260px',\n              transform: 'translateY(-50%)',\n              background: 'var(--bg-raised, #12141a)',\n              border: `1px solid ${colors[tooltipCategory]}`,\n              boxShadow: '0 8px 32px rgba(0,0,0,0.5)',\n              zIndex: 100,\n              padding: '14px 16px',\n              borderRadius: '10px',\n              minWidth: '200px',\n              maxWidth: '260px',\n              lineHeight: 1.45,\n              fontSize: '13px',\n              color: 'var(--fg, #f0f0f0)'\n            }}\n          >\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '10px', paddingBottom: '10px', borderBottom: '1px solid rgba(255,255,255,0.08)' }}>\n              <span style={{\n                width: '10px',\n                height: '10px',\n                borderRadius: '50%',\n                background: colors[tooltipCategory],\n                flexShrink: 0\n              }}\n              />\n              <strong style={{ textTransform: 'capitalize', fontSize: '14px' }}>{tooltipCategory}</strong>\n              <span style={{ marginLeft: 'auto', opacity: 0.6, fontSize: '12px' }}>{tooltipPercent}%</span>\n            </div>\n            <div style={{ marginBottom: '10px', fontSize: '11px', opacity: 0.7 }}>\n              {formatHoursMinutes(tooltipSeconds)} total\n            </div>\n            <ul style={{ listStyle: 'none', padding: 0, margin: 0, maxHeight: '160px', overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: '3px' }}>\n              {breakdownByCategory[tooltipCategory]?.length === 0 && (\n                <li style={{ opacity: 0.5, fontSize: '12px' }}>No entries</li>\n              )}\n              {breakdownByCategory[tooltipCategory]?.slice(0, 6).map((ctx) => (\n                <li\n                  key={`${tooltipCategory}-${ctx.label}`}\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    padding: '5px 6px',\n                    borderRadius: '4px',\n                    background: 'rgba(255,255,255,0.04)',\n                    fontSize: '12px'\n                  }}\n                >\n                  <span style={{ maxWidth: '60%', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>{ctx.label}</span>\n                  <span style={{ opacity: 0.6, fontSize: '11px' }}>{Math.round(ctx.seconds / 60)}m</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n        <div className=\"donut-shell\" style={{ position: 'relative' }}>\n          <div className=\"donut-glow\" />\n          <svg width=\"240\" height=\"240\" viewBox=\"0 0 220 220\">\n            {slices.map((slice) => (\n              <path\n                key={slice.category}\n                d={slice.path}\n                fill={slice.color}\n                stroke=\"rgba(255,255,255,0.14)\"\n                strokeWidth=\"2\"\n                onMouseEnter={() => setHovered(slice.category)}\n                onMouseLeave={() => setHovered(null)}\n              />\n            ))}\n            <circle cx={center} cy={center} r={radius * 0.6} fill=\"var(--bg-soft)\" />\n          </svg>\n          <div className=\"donut-center\">\n            <strong>{formatHoursMinutes(stats.total)}</strong>\n            <span>logged</span>\n          </div>\n        </div>\n\n        <ul className=\"detail-list\" style={{ flex: 1 }}>\n          {slices.map((slice) => (\n            <li\n              key={slice.category}\n              onMouseEnter={() => setHovered(slice.category)}\n              onMouseLeave={() => setHovered(null)}\n            >\n              <div className=\"legend-chip\">\n                <span style={{\n                  width: '12px',\n                  height: '12px',\n                  borderRadius: '50%',\n                  background: slice.color\n                }} />\n                <span style={{ textTransform: 'capitalize' }}>{slice.category}</span>\n              </div>\n              <div className=\"legend-values\">\n                <strong>{slice.percentage}%</strong>\n                <span className=\"subtle\">{Math.round((stats.byCategory[slice.category] ?? 0) / 60)}m</span>\n              </div>\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n\nfunction formatHoursMinutes(totalSeconds: number) {\n  const totalMinutes = Math.max(0, Math.round(totalSeconds / 60));\n  const hours = Math.floor(totalMinutes / 60);\n  const minutes = totalMinutes % 60;\n  return `${hours}h ${minutes}m`;\n}\n","import { useMemo } from 'react';\nimport type { ActivityJourney } from '@shared/types';\n\ntype Props = {\n  journey: ActivityJourney | null;\n  loading?: boolean;\n  isRemote?: boolean;\n};\n\nconst categoryLabels: Record<string, string> = {\n  productive: 'Productive',\n  neutral: 'Neutral',\n  frivolity: 'Frivolity',\n  draining: 'Draining',\n  idle: 'Idle'\n};\n\nexport default function DayJourney({ journey, loading, isRemote }: Props) {\n  const totalSeconds = useMemo(() => {\n    if (!journey) return 0;\n    return journey.segments.reduce((acc, seg) => acc + seg.seconds, 0);\n  }, [journey]);\n\n  if (!journey || journey.segments.length === 0) {\n    return (\n      <div className=\"card journey-card\">\n        <div className=\"card-header-row\">\n          <div>\n            <p className=\"eyebrow\">Day journey</p>\n            <h2>Attention trail</h2>\n          </div>\n          <span className=\"pill ghost\">\n            {loading ? 'Loading...' : isRemote ? 'Local device only' : 'Local device'}\n          </span>\n        </div>\n        <p className=\"subtle\">\n          {isRemote ? 'Journey data is available on the active device.' : 'No activity recorded in this window yet.'}\n        </p>\n      </div>\n    );\n  }\n\n  const neutralCounts = journey.neutralCounts ?? [];\n\n  return (\n    <div className=\"card journey-card\">\n      <div className=\"card-header-row\">\n        <div>\n          <p className=\"eyebrow\">Day journey</p>\n          <h2>Attention trail</h2>\n        </div>\n        <span className=\"pill ghost\">{journey.windowHours}h window</span>\n      </div>\n      <div className=\"journey-layout\">\n        <div className=\"journey-bar-wrap\">\n          <div className=\"journey-bar\" role=\"img\" aria-label=\"Timeline of context switches\">\n            {journey.segments.map((seg, idx) => {\n              const pct = totalSeconds > 0 ? (seg.seconds / totalSeconds) * 100 : 0;\n              const label = seg.label ?? '';\n              const title = [\n                label || categoryLabels[seg.category] || 'Session',\n                `${formatMinutes(seg.seconds)} active`\n              ].join(' - ');\n              return (\n                <div\n                  key={`${seg.start}-${idx}`}\n                  className={`journey-seg ${seg.category}`}\n                  style={{ flexGrow: seg.seconds }}\n                  title={title}\n                >\n                  {label && pct >= 6 ? <span>{label}</span> : null}\n                </div>\n              );\n            })}\n          </div>\n          <div className=\"journey-legend\">\n            {(['productive', 'neutral', 'draining', 'frivolity', 'idle'] as const).map((key) => (\n              <span key={key} className=\"legend-chip\">\n                <span className={`dot ${key}`} />\n                {categoryLabels[key]}\n              </span>\n            ))}\n          </div>\n        </div>\n        <div className=\"journey-neutral\">\n          <span className=\"label\">Neutral touchpoints</span>\n          {neutralCounts.length === 0 ? (\n            <span className=\"subtle\">No neutral apps surfaced yet.</span>\n          ) : (\n            <div className=\"journey-neutral-list\">\n              {neutralCounts.slice(0, 5).map((entry) => (\n                <div key={entry.label} className=\"journey-neutral-row\">\n                  <span>{entry.label}</span>\n                  <span className=\"subtle\">{entry.count}√ó ‚Ä¢ {formatMinutes(entry.seconds)}</span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction formatMinutes(seconds: number) {\n  const minutes = Math.max(1, Math.round(seconds / 60));\n  return `${minutes}m`;\n}\n","import { useMemo, useState } from 'react';\nimport type { ActivityJourney } from '@shared/types';\n\ntype Props = {\n  journey: ActivityJourney | null;\n  loading?: boolean;\n  isRemote?: boolean;\n};\n\ntype Transition = {\n  from: string;\n  to: string;\n  count: number;\n};\n\ntype FlowData = {\n  nodes: string[];\n  transitions: Transition[];\n};\n\nconst MAX_NODES = 8;\nconst MAX_TRANSITIONS = 14;\nconst MAX_PATH_SEGMENTS = 36;\nconst ROW_HEIGHT = 32;\nconst MAP_WIDTH = 520;\nconst MAP_PADDING = 24;\n\nexport default function AttentionMap({ journey, loading, isRemote }: Props) {\n  const [view, setView] = useState<'flow' | 'path'>('flow');\n\n  const { nodes, transitions } = useMemo<FlowData>(() => {\n    if (!journey?.segments?.length) return { nodes: [], transitions: [] };\n    // Journey labels already normalize domains (e.g., all youtube.com pages collapse to one bucket).\n    const labeled = journey.segments.filter((seg) => Boolean(seg.label));\n    if (labeled.length < 2) return { nodes: [], transitions: [] };\n\n    const transitionMap = new Map<string, Transition>();\n    for (let i = 1; i < labeled.length; i += 1) {\n      const from = labeled[i - 1].label ?? '';\n      const to = labeled[i].label ?? '';\n      if (!from || !to || from === to) continue;\n      const key = `${from}->${to}`;\n      const entry = transitionMap.get(key);\n      if (entry) {\n        entry.count += 1;\n      } else {\n        transitionMap.set(key, { from, to, count: 1 });\n      }\n    }\n\n    const weights = new Map<string, number>();\n    for (const entry of transitionMap.values()) {\n      weights.set(entry.from, (weights.get(entry.from) ?? 0) + entry.count);\n      weights.set(entry.to, (weights.get(entry.to) ?? 0) + entry.count);\n    }\n\n    const nodes = Array.from(weights.entries())\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, MAX_NODES)\n      .map(([label]) => label);\n\n    const transitions = Array.from(transitionMap.values())\n      .filter((entry) => nodes.includes(entry.from) && nodes.includes(entry.to))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, MAX_TRANSITIONS);\n\n    return { nodes, transitions };\n  }, [journey]);\n\n  const pathSegments = useMemo(() => {\n    if (!journey?.segments?.length) return [];\n    const labeled = journey.segments.filter((seg) => Boolean(seg.label));\n    return labeled.slice(-MAX_PATH_SEGMENTS);\n  }, [journey]);\n\n  const maxCount = transitions.reduce((acc, entry) => Math.max(acc, entry.count), 1);\n  const mapHeight = Math.max(220, nodes.length * ROW_HEIGHT + MAP_PADDING * 2);\n  const leftX = 140;\n  const rightX = MAP_WIDTH - 140;\n  const midX = MAP_WIDTH / 2;\n\n  const nodePositions = new Map<string, number>();\n  nodes.forEach((label, idx) => {\n    nodePositions.set(label, MAP_PADDING + idx * ROW_HEIGHT);\n  });\n\n  if (!journey || journey.segments.length === 0) {\n    return (\n      <div className=\"card attention-map-card\">\n        <div className=\"card-header-row\">\n          <div>\n            <p className=\"eyebrow\">Attention map</p>\n            <h2>Context flow</h2>\n          </div>\n          <span className=\"pill ghost\">\n            {loading ? 'Loading...' : isRemote ? 'Local device only' : 'Local device'}\n          </span>\n        </div>\n        <p className=\"subtle\">\n          {isRemote ? 'Flow maps are generated on the active device.' : 'No activity recorded in this window yet.'}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"card attention-map-card\">\n      <div className=\"card-header-row\">\n        <div>\n          <p className=\"eyebrow\">Attention map</p>\n          <h2>Context flow</h2>\n        </div>\n        <div className=\"attention-map-controls\">\n          <button\n            type=\"button\"\n            className={`pill ghost ${view === 'flow' ? 'active' : ''}`}\n            onClick={() => setView('flow')}\n          >\n            Flow map\n          </button>\n          <button\n            type=\"button\"\n            className={`pill ghost ${view === 'path' ? 'active' : ''}`}\n            onClick={() => setView('path')}\n          >\n            Day path\n          </button>\n        </div>\n      </div>\n\n      {view === 'flow' ? (\n        <div className=\"attention-map\">\n          {nodes.length === 0 || transitions.length === 0 ? (\n            <p className=\"subtle\">Not enough context changes yet.</p>\n          ) : (\n            <svg\n              className=\"attention-map-svg\"\n              viewBox={`0 0 ${MAP_WIDTH} ${mapHeight}`}\n              preserveAspectRatio=\"xMidYMid meet\"\n              role=\"img\"\n              aria-label=\"Most common context switches\"\n            >\n              <defs>\n                <marker id=\"arrow\" markerWidth=\"8\" markerHeight=\"8\" refX=\"6\" refY=\"3\" orient=\"auto\">\n                  <path d=\"M0,0 L6,3 L0,6\" fill=\"currentColor\" />\n                </marker>\n              </defs>\n              {transitions.map((entry) => {\n                const fromY = nodePositions.get(entry.from) ?? MAP_PADDING;\n                const toY = nodePositions.get(entry.to) ?? MAP_PADDING;\n                const width = 1 + (entry.count / maxCount) * 6;\n                const path = `M ${leftX} ${fromY} C ${midX} ${fromY}, ${midX} ${toY}, ${rightX} ${toY}`;\n                return (\n                  <path\n                    key={`${entry.from}-${entry.to}`}\n                    d={path}\n                    className=\"attention-map-link\"\n                    strokeWidth={width}\n                    markerEnd=\"url(#arrow)\"\n                  />\n                );\n              })}\n\n              {nodes.map((label) => {\n                const y = nodePositions.get(label) ?? MAP_PADDING;\n                return (\n                  <g key={`left-${label}`}>\n                    <circle cx={leftX} cy={y} r={4} className=\"attention-map-node\" />\n                    <text x={leftX - 12} y={y + 4} textAnchor=\"end\" className=\"attention-map-label\">\n                      {label}\n                    </text>\n                  </g>\n                );\n              })}\n\n              {nodes.map((label) => {\n                const y = nodePositions.get(label) ?? MAP_PADDING;\n                return (\n                  <g key={`right-${label}`}>\n                    <circle cx={rightX} cy={y} r={4} className=\"attention-map-node\" />\n                    <text x={rightX + 12} y={y + 4} textAnchor=\"start\" className=\"attention-map-label\">\n                      {label}\n                    </text>\n                  </g>\n                );\n              })}\n            </svg>\n          )}\n          {transitions.length > 0 && (\n            <div className=\"attention-map-list\">\n              {transitions.map((entry) => (\n                <div key={`list-${entry.from}-${entry.to}`} className=\"attention-map-row\">\n                  <span>{entry.from}</span>\n                  <span className=\"subtle\">-&gt;</span>\n                  <span>{entry.to}</span>\n                  <span className=\"attention-map-count\">{entry.count}x</span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div className=\"attention-path\">\n          {pathSegments.length === 0 ? (\n            <p className=\"subtle\">Not enough labeled context yet.</p>\n          ) : (\n            <div className=\"attention-path-strip\">\n              {pathSegments.map((seg, idx) => (\n                <div key={`${seg.start}-${idx}`} className=\"attention-path-item\">\n                  <span className={`attention-chip ${seg.category}`}>{seg.label}</span>\n                  <span className=\"subtle\">{formatTime(seg.start)}</span>\n                </div>\n              ))}\n            </div>\n          )}\n          <p className=\"subtle\">Showing recent labeled contexts in order.</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction formatTime(value: string) {\n  const date = new Date(value);\n  return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport type { AnalyticsOverview, RendererApi } from '@shared/types';\n\ninterface InsightsProps {\n    api: RendererApi;\n    overview?: AnalyticsOverview | null;\n    loading?: boolean;\n    onRefresh?: () => void;\n}\n\nexport default function Insights({ api, overview, loading, onRefresh }: InsightsProps) {\n    const isControlled = typeof overview !== 'undefined' || typeof loading !== 'undefined';\n    const [localOverview, setLocalOverview] = useState<AnalyticsOverview | null>(null);\n    const [localLoading, setLocalLoading] = useState(true);\n    const [excludedKeywords, setExcludedKeywords] = useState<string[]>([]);\n\n    const refresh = useCallback(async () => {\n        if (onRefresh) {\n            onRefresh();\n            return;\n        }\n        setLocalLoading(true);\n        try {\n            const data = await api.analytics.overview(7);\n            setLocalOverview(data);\n        } catch (error) {\n            console.error('Failed to load insights:', error);\n        }\n        setLocalLoading(false);\n    }, [api, onRefresh]);\n\n    useEffect(() => {\n        if (!isControlled) {\n            refresh();\n        }\n    }, [isControlled, refresh]);\n\n    useEffect(() => {\n        api.settings.excludedKeywords().then(setExcludedKeywords).catch(() => { });\n    }, [api]);\n\n    const resolvedOverview = isControlled ? overview ?? null : localOverview;\n    const resolvedLoading = isControlled ? Boolean(loading) : localLoading;\n\n    const formatHour = (h: number) => {\n        const ampm = h >= 12 ? 'PM' : 'AM';\n        const hour = h % 12 || 12;\n        return `${hour}${ampm}`;\n    };\n\n    if (resolvedLoading) {\n        return (\n            <div className=\"card insights-card\">\n                <div className=\"card-header-row\">\n                    <h2>Insights</h2>\n                    <span className=\"loading-spinner\" />\n                </div>\n                <div className=\"insights-loading\">\n                    <div className=\"skeleton skeleton-text\" />\n                    <div className=\"skeleton skeleton-text short\" />\n                    <div className=\"skeleton skeleton-text\" />\n                </div>\n            </div>\n        );\n    }\n\n    if (!resolvedOverview) {\n        return null;\n    }\n\n    const trendIcon = resolvedOverview.focusTrend === 'improving' ? 'üìà' : resolvedOverview.focusTrend === 'declining' ? 'üìâ' : '‚û°Ô∏è';\n    const trendLabel = resolvedOverview.focusTrend === 'improving' ? 'Improving' : resolvedOverview.focusTrend === 'declining' ? 'Declining' : 'Stable';\n\n    const scrubText = (value: string) => {\n        if (!excludedKeywords.length) return value;\n        let next = value;\n        for (const keyword of excludedKeywords) {\n            if (!keyword) continue;\n            const escaped = keyword.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n            next = next.replace(new RegExp(escaped, 'gi'), '[hidden]');\n        }\n        return next;\n    };\n\n    return (\n        <div className=\"card insights-card\">\n            <div className=\"card-header-row\">\n                <h2>Insights</h2>\n                <button className=\"pill ghost\" onClick={refresh} disabled={resolvedLoading}>\n                    Refresh\n                </button>\n            </div>\n\n            <div className=\"insights-summary\">\n                <div className=\"insight-metric\">\n                    <span className=\"insight-value\">{resolvedOverview.productivityScore}%</span>\n                    <span className=\"insight-label\">Productivity</span>\n                </div>\n                <div className=\"insight-metric\">\n                    <span className=\"insight-value\">{formatHour(resolvedOverview.peakProductiveHour)}</span>\n                    <span className=\"insight-label\">Peak hour</span>\n                </div>\n                <div className=\"insight-metric\">\n                    <span className=\"insight-value\">{trendIcon}</span>\n                    <span className=\"insight-label\">{trendLabel}</span>\n                </div>\n            </div>\n\n            <ul className=\"insights-list\">\n                {resolvedOverview.insights.map((insight, idx) => (\n                    <li key={idx} className=\"insight-item\">\n                        {scrubText(insight)}\n                    </li>\n                ))}\n                {resolvedOverview.insights.length === 0 && (\n                    <li className=\"insight-item subtle\">\n                        Not enough data yet. Keep tracking your activity!\n                    </li>\n                )}\n            </ul>\n\n            {resolvedOverview.riskHour !== resolvedOverview.peakProductiveHour && (\n                <div className=\"insight-warning\">\n                    <span className=\"warning-icon\">‚ö†Ô∏è</span>\n                    <span>\n                        Watch out at <strong>{formatHour(resolvedOverview.riskHour)}</strong> - that's when you're most likely to get distracted.\n                    </span>\n                </div>\n            )}\n        </div>\n    );\n}\n","import type { FriendConnection, FriendLibraryItem, FriendSummary, FriendTimeline, TrophyStatus } from '@shared/types';\n\ntype Props = {\n  open: boolean;\n  friend: FriendConnection | null;\n  summary: FriendSummary | null;\n  timeline: FriendTimeline | null;\n  publicLibraryItems?: FriendLibraryItem[];\n  trophies?: TrophyStatus[];\n  onClose: () => void;\n};\n\nexport default function FriendDetailModal({ open, friend, summary, timeline, publicLibraryItems = [], trophies = [], onClose }: Props) {\n  if (!open || !friend) return null;\n\n  const totals = timeline?.totalsByCategory ?? summary?.categoryBreakdown ?? null;\n  const activeSeconds = summary?.totalActiveSeconds ?? 0;\n  const productivityScore = summary?.productivityScore ?? 0;\n  const trophyById = new Map(trophies.map((trophy) => [trophy.id, trophy]));\n  const friendTrophies = (friend.pinnedTrophies ?? [])\n    .map((id) => trophyById.get(id))\n    .filter((trophy): trophy is TrophyStatus => Boolean(trophy));\n\n  return (\n    <div className=\"friend-modal-overlay\" onClick={onClose}>\n      <div className=\"friend-modal\" onClick={(event) => event.stopPropagation()}>\n        <div className=\"friend-modal-header\">\n          <div>\n            <h3>{friend.displayName ?? friend.handle ?? 'Friend'}</h3>\n            <p className=\"subtle\">@{friend.handle ?? 'no-handle'}</p>\n          </div>\n          <button className=\"ghost\" onClick={onClose}>Close</button>\n        </div>\n\n        <div className=\"friend-modal-metrics\">\n          <div>\n            <span className=\"label\">Productivity</span>\n            <strong>{summary ? `${productivityScore}%` : '--'}</strong>\n          </div>\n          <div>\n            <span className=\"label\">Active time</span>\n            <strong>{summary ? formatHoursFromSeconds(activeSeconds) : '--'}</strong>\n          </div>\n          <div>\n            <span className=\"label\">Updated</span>\n            <strong>{summary ? new Date(summary.updatedAt).toLocaleTimeString() : '--'}</strong>\n          </div>\n        </div>\n\n        {friendTrophies.length > 0 && (\n          <div className=\"friends-trophies\">\n            {friendTrophies.slice(0, 4).map((trophy) => (\n              <span key={trophy.id} className=\"trophy-badge\">\n                <span className=\"emoji\">{trophy.emoji}</span>\n                {trophy.name}\n              </span>\n            ))}\n          </div>\n        )}\n\n        {totals && (\n          <div className=\"friend-modal-breakdown\">\n            <div className=\"friend-modal-break-row\">\n              <span>Productive</span>\n              <span>{formatHoursFromSeconds(totals.productive)}</span>\n            </div>\n            <div className=\"friend-modal-bar\">\n              <span className=\"cat-productive\" style={{ width: `${percentOfTotal(totals, 'productive')}%` }} />\n              <span className=\"cat-neutral\" style={{ width: `${percentOfTotal(totals, 'neutral')}%` }} />\n              <span className=\"cat-frivolity\" style={{ width: `${percentOfTotal(totals, 'frivolity')}%` }} />\n              <span className=\"cat-draining\" style={{ width: `${percentOfTotal(totals, 'draining')}%` }} />\n              <span className=\"cat-idle\" style={{ width: `${percentOfTotal(totals, 'idle')}%` }} />\n            </div>\n            <div className=\"friend-modal-break-row\">\n              <span>Neutral</span>\n              <span>{formatHoursFromSeconds(totals.neutral)}</span>\n            </div>\n            <div className=\"friend-modal-break-row\">\n              <span>Frivolity</span>\n              <span>{formatHoursFromSeconds(totals.frivolity)}</span>\n            </div>\n            <div className=\"friend-modal-break-row\">\n              <span>Draining</span>\n              <span>{formatHoursFromSeconds(totals.draining ?? 0)}</span>\n            </div>\n            <div className=\"friend-modal-break-row\">\n              <span>Idle</span>\n              <span>{formatHoursFromSeconds(totals.idle)}</span>\n            </div>\n          </div>\n        )}\n\n        {publicLibraryItems.length > 0 && (\n          <div className=\"friend-modal-library\">\n            <div className=\"friend-modal-timeline-header\" style={{ marginBottom: 12 }}>\n              <span className=\"label\">Public library</span>\n              <span className=\"subtle\">Shared links</span>\n            </div>\n            <div className=\"friend-modal-library-list\">\n              {publicLibraryItems.map((item) => {\n                const title = item.title ?? item.domain ?? item.url;\n                return (\n                  <div key={item.id} className=\"friend-modal-library-item\">\n                    <div className=\"friend-modal-library-main\">\n                      <strong>{title}</strong>\n                      <span className=\"subtle\">{item.note ?? item.url}</span>\n                    </div>\n                    <div className=\"friend-modal-library-meta\">\n                      <span>Added {formatShortDate(item.createdAt)}</span>\n                      {typeof item.price === 'number' && <span>{item.price} f-coins</span>}\n                      <a className=\"ghost\" href={item.url} target=\"_blank\" rel=\"noopener noreferrer\">Open</a>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        <div className=\"friend-modal-timeline\">\n          <div className=\"friend-modal-timeline-header\">\n            <span className=\"label\">Last {timeline?.windowHours ?? 24}h</span>\n            <span className=\"subtle\">Dominant attention per hour</span>\n          </div>\n          <div className=\"friend-modal-timeline-bars\">\n            {(timeline?.timeline ?? []).map((slot, idx) => {\n              const total = slot.productive + slot.neutral + slot.frivolity + slot.draining + slot.idle;\n              const height = total === 0 ? 8 : Math.max(12, Math.min(52, Math.round((total / maxTimeline(timeline)) * 52)));\n              const dominant = slot.dominant;\n              return (\n                <div key={`${slot.start}-${idx}`} className=\"friend-modal-bar-col\" title={`${slot.hour}`}>\n                  <span className={`friend-modal-bar-fill cat-${dominant}`} style={{ height: `${height}px` }} />\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction percentOfTotal(\n  totals: NonNullable<FriendTimeline['totalsByCategory']>,\n  key: 'productive' | 'neutral' | 'frivolity' | 'draining' | 'idle'\n) {\n  const total = totals.productive + totals.neutral + totals.frivolity + (totals.draining ?? 0) + totals.idle;\n  const value = totals[key] ?? 0;\n  return total > 0 ? Math.round((value / total) * 100) : 0;\n}\n\nfunction formatHoursFromSeconds(seconds: number) {\n  const hours = seconds / 3600;\n  return hours >= 10 ? `${hours.toFixed(0)}h` : `${hours.toFixed(1)}h`;\n}\n\nfunction maxTimeline(timeline: FriendTimeline | null) {\n  if (!timeline || timeline.timeline.length === 0) return 1;\n  return Math.max(...timeline.timeline.map((slot) => slot.productive + slot.neutral + slot.frivolity + slot.draining + slot.idle), 1);\n}\n\nfunction formatShortDate(value: string) {\n  const parsed = new Date(value);\n  if (Number.isNaN(parsed.getTime())) return value;\n  return parsed.toLocaleDateString([], { month: 'short', day: 'numeric' });\n}\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport type {\n  ActivityRecord,\n  ActivitySummary,\n  ActivityJourney,\n  AnalyticsOverview,\n  EconomyState,\n  FriendConnection,\n  FriendLibraryItem,\n  FriendProfile,\n  FriendSummary,\n  FriendTimeline,\n  RendererApi,\n  TrophyProfileSummary,\n  TrophyStatus,\n  WalletSnapshot\n} from '@shared/types';\nimport { DAY_START_HOUR, getLocalDayStartMs } from '@shared/time';\nimport PomodoroPanel from './PomodoroPanel';\nimport DayCompass from './DayCompass';\nimport ActivityChart from './ActivityChart';\nimport DayJourney from './DayJourney';\nimport AttentionMap from './AttentionMap';\nimport Insights from './Insights';\nimport FriendDetailModal from './FriendDetailModal';\n\ninterface DashboardProps {\n  api: RendererApi;\n  wallet: WalletSnapshot;\n  economy: EconomyState | null;\n  productivityGoalHoursOverride?: number;\n}\n\nconst DASHBOARD_SCENES = [\n  { id: 'focus', label: 'Focus', hint: 'Ring, streak, and core metrics' },\n  { id: 'signals', label: 'Signals', hint: 'Flow quality and attention telemetry' },\n  { id: 'journey', label: 'Journey', hint: 'Day timeline and orbit map' },\n  { id: 'social', label: 'Social', hint: 'Friends and trophy highlights' }\n] as const;\n\ntype DashboardScene = (typeof DASHBOARD_SCENES)[number]['id'];\n\nexport default function Dashboard({ api, wallet, economy, productivityGoalHoursOverride }: DashboardProps) {\n  const [activities, setActivities] = useState<ActivityRecord[]>([]);\n  const [summary, setSummary] = useState<ActivitySummary | null>(null);\n  const [loadingSummary, setLoadingSummary] = useState(true);\n  const [overview, setOverview] = useState<AnalyticsOverview | null>(null);\n  const [loadingOverview, setLoadingOverview] = useState(true);\n  const [lastFrivolityAt, setLastFrivolityAt] = useState<number | null>(null);\n  const [lastFrivolityLoaded, setLastFrivolityLoaded] = useState(false);\n  const [frivolityCount24h, setFrivolityCount24h] = useState<number | null>(null);\n  const [now, setNow] = useState(Date.now());\n  const [devices, setDevices] = useState<{ id: string; name: string; isCurrent?: boolean }[]>([]);\n  const [selectedDeviceId, setSelectedDeviceId] = useState<string | null>(null);\n  const [localDeviceId, setLocalDeviceId] = useState<string | null>(null);\n  const [friends, setFriends] = useState<FriendConnection[]>([]);\n  const [friendSummaries, setFriendSummaries] = useState<Record<string, FriendSummary>>({});\n  const [friendsReady, setFriendsReady] = useState(false);\n  const [myFriendSummary, setMyFriendSummary] = useState<FriendSummary | null>(null);\n  const [myProfile, setMyProfile] = useState<FriendProfile | null>(null);\n  const [selectedFriend, setSelectedFriend] = useState<FriendConnection | null>(null);\n  const [friendTimeline, setFriendTimeline] = useState<FriendTimeline | null>(null);\n  const [friendPublicLibrary, setFriendPublicLibrary] = useState<FriendLibraryItem[]>([]);\n  const [friendDetailOpen, setFriendDetailOpen] = useState(false);\n  const [trophies, setTrophies] = useState<TrophyStatus[]>([]);\n  const [trophySummary, setTrophySummary] = useState<TrophyProfileSummary | null>(null);\n  const [trophyToast, setTrophyToast] = useState<TrophyStatus | null>(null);\n  const [flowMetric, setFlowMetric] = useState<'productivity' | 'switches' | 'idle' | 'thrash'>('productivity');\n  const [journey, setJourney] = useState<ActivityJourney | null>(null);\n  const [excludedKeywords, setExcludedKeywords] = useState<string[]>([]);\n  const [competitiveOptIn, setCompetitiveOptIn] = useState(false);\n  const [pomodoroOpen, setPomodoroOpen] = useState(false);\n  const [productivityGoalHours, setProductivityGoalHours] = useState(2);\n  const [dashboardScene, setDashboardScene] = useState<DashboardScene>(() => {\n    try {\n      const saved = window.localStorage.getItem('tws-dashboard-scene');\n      if (saved && DASHBOARD_SCENES.some((scene) => scene.id === saved)) {\n        return saved as DashboardScene;\n      }\n    } catch {\n      // ignore\n    }\n    return 'focus';\n  });\n\n  const refresh = useCallback(async (silent = false) => {\n    if (!silent) setLoadingSummary(true);\n    const isRemote = Boolean(selectedDeviceId && (selectedDeviceId === 'all' || (localDeviceId && selectedDeviceId !== localDeviceId)));\n    const [recent, aggregate, journeyData] = await Promise.all([\n      isRemote ? Promise.resolve([]) : api.activities.recent(30),\n      api.activities.summary(24, selectedDeviceId ?? undefined),\n      isRemote ? Promise.resolve(null) : api.activities.journey(24, selectedDeviceId ?? undefined)\n    ]);\n    setActivities(recent);\n    setSummary(aggregate);\n    setJourney(journeyData);\n    setLoadingSummary(false);\n  }, [api, localDeviceId, selectedDeviceId]);\n\n  const refreshOverview = useCallback(async () => {\n    setLoadingOverview(true);\n    try {\n      const data = await api.analytics.overview(7);\n      setOverview(data);\n    } catch (error) {\n      console.error('Failed to load analytics overview:', error);\n    } finally {\n      setLoadingOverview(false);\n    }\n  }, [api]);\n\n  const loadLastFrivolity = useCallback(async () => {\n    setLastFrivolityLoaded(false);\n    try {\n      const cutoff = Date.now() - 24 * 60 * 60 * 1000;\n      const today = formatDayInput(new Date());\n      const yesterday = formatDayInput(new Date(Date.now() - 24 * 60 * 60 * 1000));\n      const recentEntries = await Promise.all([api.history.list(today), api.history.list(yesterday)]);\n      const flatEntries = recentEntries.flat();\n      const count24h = flatEntries.filter((entry) => entry.kind === 'frivolous-session' && Date.parse(entry.occurredAt) >= cutoff).length;\n      setFrivolityCount24h(count24h);\n\n      const days = await api.history.days(60);\n      for (const day of days) {\n        const entries = await api.history.list(day.day);\n        const last = entries.find((entry) => entry.kind === 'frivolous-session');\n        if (last) {\n          setLastFrivolityAt(new Date(last.occurredAt).getTime());\n          setLastFrivolityLoaded(true);\n          return;\n        }\n      }\n      setLastFrivolityAt(null);\n    } catch (error) {\n      console.error('Failed to load frivolity history:', error);\n      setLastFrivolityAt(null);\n      setFrivolityCount24h(null);\n    } finally {\n      setLastFrivolityLoaded(true);\n    }\n  }, [api]);\n\n  const refreshDevices = useCallback(async () => {\n    try {\n      const status = await api.sync.status();\n      const deviceList = status.configured && status.authenticated ? await api.sync.listDevices() : [];\n      const localId = status.device?.id ?? null;\n      const normalized = deviceList.map((device) => ({\n        id: device.id,\n        name: device.name,\n        isCurrent: device.id === localId\n      }));\n      setDevices(normalized);\n      setLocalDeviceId(localId);\n      if (localId && !selectedDeviceId) {\n        setSelectedDeviceId(localId);\n      }\n    } catch (error) {\n      console.error('Failed to load devices', error);\n    }\n  }, [api, selectedDeviceId]);\n\n  const refreshFriends = useCallback(async () => {\n    try {\n      const status = await api.sync.status();\n      if (!status.configured || !status.authenticated) {\n        setFriends([]);\n        setFriendSummaries({});\n        setFriendsReady(false);\n        return;\n      }\n      const [list, summaries, mySummaryResult] = await Promise.all([\n        api.friends.list(),\n        api.friends.summaries(24),\n        api.friends.meSummary(24)\n      ]);\n      setFriends(list);\n      setFriendSummaries(summaries);\n      setMyFriendSummary(mySummaryResult);\n      const profile = await api.friends.profile();\n      setMyProfile(profile);\n      setFriendsReady(true);\n    } catch (error) {\n      console.error('Failed to load friends', error);\n      setFriends([]);\n      setFriendSummaries({});\n      setFriendsReady(false);\n      setMyFriendSummary(null);\n    }\n  }, [api]);\n\n  const refreshTrophies = useCallback(async () => {\n    try {\n      const [summaryResult, statusResult] = await Promise.all([\n        api.trophies.profile(),\n        api.trophies.list()\n      ]);\n      setTrophySummary(summaryResult);\n      setTrophies(statusResult);\n    } catch (error) {\n      console.error('Failed to load trophies', error);\n    }\n  }, [api]);\n\n  const openFriendDetail = useCallback(async (friend: FriendConnection) => {\n    setSelectedFriend(friend);\n    setFriendTimeline(null);\n    setFriendPublicLibrary([]);\n    setFriendDetailOpen(true);\n    try {\n      const [timeline, publicLibrary] = await Promise.all([\n        api.friends.timeline(friend.userId, 24),\n        api.friends.publicLibrary(friend.userId, 168)\n      ]);\n      setFriendTimeline(timeline);\n      setFriendPublicLibrary(publicLibrary ?? []);\n    } catch (error) {\n      console.error('Failed to load friend timeline', error);\n    }\n  }, [api]);\n\n  useEffect(() => {\n    refresh();\n    refreshOverview();\n    loadLastFrivolity();\n    refreshDevices();\n    refreshFriends();\n    refreshTrophies();\n  }, [refresh, refreshOverview, loadLastFrivolity, refreshDevices, refreshFriends, refreshTrophies]);\n\n  useEffect(() => {\n    api.settings.excludedKeywords().then(setExcludedKeywords).catch(() => { });\n  }, [api]);\n\n  useEffect(() => {\n    api.settings.competitiveOptIn().then(setCompetitiveOptIn).catch(() => { });\n  }, [api]);\n\n  useEffect(() => {\n    api.settings.productivityGoalHours().then(setProductivityGoalHours).catch(() => { });\n  }, [api]);\n\n  useEffect(() => {\n    try {\n      window.localStorage.setItem('tws-dashboard-scene', dashboardScene);\n    } catch {\n      // ignore\n    }\n  }, [dashboardScene]);\n\n  useEffect(() => {\n    const unsub = api.events.on('economy:activity', () => {\n      refresh(true);\n    });\n    const unsubPaywallStart = api.events.on('paywall:session-started', () => {\n      setLastFrivolityAt(Date.now());\n      setLastFrivolityLoaded(true);\n    });\n    return () => {\n      unsub();\n      unsubPaywallStart();\n    };\n  }, [api, refresh]);\n\n  useEffect(() => {\n    const id = window.setInterval(() => {\n      setNow(Date.now());\n    }, 1000);\n    return () => window.clearInterval(id);\n  }, []);\n\n  useEffect(() => {\n    const unsub = api.events.on<TrophyStatus>('trophies:earned', (trophy) => {\n      setTrophyToast(trophy);\n      refreshTrophies();\n      window.setTimeout(() => setTrophyToast(null), 6000);\n    });\n    return () => {\n      unsub();\n    };\n  }, [api, refreshTrophies]);\n\n  const isAggregateView = selectedDeviceId === 'all';\n  const isRemoteView = Boolean(selectedDeviceId && localDeviceId && selectedDeviceId !== localDeviceId && !isAggregateView);\n  const activeLabel = isAggregateView\n    ? 'All devices'\n    : isRemoteView\n      ? devices.find((device) => device.id === selectedDeviceId)?.name ?? 'Remote device'\n    : economy?.activeDomain ?? economy?.activeApp ?? 'Waiting...';\n  const activeCategory = (isRemoteView ? 'neutral' : (economy?.activeCategory ?? 'idle')) as string;\n  const totalHours = useMemo(() => Math.max(0, Math.round(((summary?.totalSeconds ?? 0) / 3600) * 10) / 10), [summary]);\n  const isExcludedLabel = useCallback((label: string) => {\n    if (!excludedKeywords.length) return false;\n    const haystack = label.toLowerCase();\n    return excludedKeywords.some((keyword) => keyword && haystack.includes(keyword));\n  }, [excludedKeywords]);\n  const topContexts = useMemo(() => {\n    if (!summary?.topContexts?.length) return [];\n    return summary.topContexts.filter((ctx) => !isExcludedLabel(ctx.label));\n  }, [summary, isExcludedLabel]);\n  const timelineWindow = summary?.windowHours ?? 24;\n  const timeline = (summary?.timeline ?? []).slice(-timelineWindow);\n  const sortedActivities = useMemo(() => {\n    return [...activities].sort((a, b) => Date.parse(a.startedAt) - Date.parse(b.startedAt));\n  }, [activities]);\n  const THRASH_WINDOW_SECONDS = 90;\n  const switchesByHour = useMemo(() => {\n    const map = new Map<string, number>();\n    if (!sortedActivities.length) return map;\n    let prevKey: string | null = null;\n    let prevHour: string | null = null;\n    for (const activity of sortedActivities) {\n      const hourStart = toHourStart(activity.startedAt);\n      if (!map.has(hourStart)) map.set(hourStart, 0);\n      const key = activity.domain ?? activity.appName ?? activity.windowTitle ?? 'unknown';\n      if (prevHour === hourStart && prevKey && key !== prevKey) {\n        map.set(hourStart, (map.get(hourStart) ?? 0) + 1);\n      }\n      prevHour = hourStart;\n      prevKey = key;\n    }\n    return map;\n  }, [sortedActivities]);\n  // Thrash = rapid context hops where a context lasts <~90s before switching.\n  const thrashByHour = useMemo(() => {\n    const map = new Map<string, number>();\n    if (sortedActivities.length < 2) return map;\n    let prev = sortedActivities[0];\n    for (let idx = 1; idx < sortedActivities.length; idx += 1) {\n      const activity = sortedActivities[idx];\n      const prevKey = prev.domain ?? prev.appName ?? prev.windowTitle ?? 'unknown';\n      const key = activity.domain ?? activity.appName ?? activity.windowTitle ?? 'unknown';\n      const prevDuration = (prev.secondsActive ?? 0) + (prev.idleSeconds ?? 0);\n      if (prevKey && key !== prevKey && prevDuration > 0 && prevDuration <= THRASH_WINDOW_SECONDS) {\n        const hourStart = toHourStart(activity.startedAt);\n        map.set(hourStart, (map.get(hourStart) ?? 0) + 1);\n      }\n      prev = activity;\n    }\n    return map;\n  }, [sortedActivities]);\n  const switchesPerHour = useMemo(() => {\n    if (!summary || sortedActivities.length < 2) return null;\n    let switches = 0;\n    let lastKey: string | null = null;\n    for (const activity of sortedActivities) {\n      const key = activity.domain ?? activity.appName ?? activity.windowTitle ?? 'unknown';\n      if (lastKey && key !== lastKey) switches += 1;\n      lastKey = key;\n    }\n    return switches / summary.windowHours;\n  }, [sortedActivities, summary]);\n  const thrashPerHour = useMemo(() => {\n    if (!summary || sortedActivities.length < 2) return null;\n    let thrash = 0;\n    let prev = sortedActivities[0];\n    for (let idx = 1; idx < sortedActivities.length; idx += 1) {\n      const activity = sortedActivities[idx];\n      const prevKey = prev.domain ?? prev.appName ?? prev.windowTitle ?? 'unknown';\n      const key = activity.domain ?? activity.appName ?? activity.windowTitle ?? 'unknown';\n      const prevDuration = (prev.secondsActive ?? 0) + (prev.idleSeconds ?? 0);\n      if (prevKey && key !== prevKey && prevDuration > 0 && prevDuration <= THRASH_WINDOW_SECONDS) {\n        thrash += 1;\n      }\n      prev = activity;\n    }\n    return thrash / summary.windowHours;\n  }, [sortedActivities, summary]);\n  const myHeadToHeadSummary = useMemo(() => {\n    if (myFriendSummary) return myFriendSummary;\n    return summary ? activityToFriendSummary(summary) : null;\n  }, [myFriendSummary, summary]);\n  const flowTrend = useMemo(() => {\n    if (!timeline.length) return [];\n    if (flowMetric === 'switches') {\n      return timeline.map((slot) => switchesByHour.get(slot.start) ?? 0);\n    }\n    if (flowMetric === 'thrash') {\n      return timeline.map((slot) => thrashByHour.get(slot.start) ?? 0);\n    }\n    if (flowMetric === 'idle') {\n      return timeline.map((slot) => {\n        const total = slot.productive + slot.neutral + slot.frivolity + slot.draining + slot.idle;\n        return total > 0 ? slot.idle / total : 0;\n      });\n    }\n    return timeline.map((slot) => {\n      const active = slot.productive + slot.neutral + slot.frivolity + slot.draining;\n      return active > 0 ? slot.productive / active : 0;\n    });\n  }, [flowMetric, timeline, switchesByHour, thrashByHour]);\n  const idleRatio = useMemo(() => {\n    if (!summary) return null;\n    const idleSeconds = summary.totalsByCategory.idle ?? 0;\n    const total = summary.totalSeconds + idleSeconds;\n    return total > 0 ? idleSeconds / total : 0;\n  }, [summary]);\n  const longestProductiveRunHours = useMemo(() => {\n    if (!timeline.length) return 0;\n    let best = 0;\n    let current = 0;\n    for (const slot of timeline) {\n      if (slot.dominant === 'productive') {\n        current += 1;\n        if (current > best) best = current;\n      } else {\n        current = 0;\n      }\n    }\n    return best;\n  }, [timeline]);\n\n  const lastFrivolityAgeMs = lastFrivolityAt ? Math.max(0, now - lastFrivolityAt) : null;\n  const streakTargetMs = 72 * 60 * 60 * 1000;\n  const streakProgress = lastFrivolityAgeMs ? Math.min(1, lastFrivolityAgeMs / streakTargetMs) : 0;\n  const streakHue = Math.round(20 + 30 * streakProgress);\n  const streakLight = Math.round(48 + 18 * streakProgress);\n  const streakColor = lastFrivolityAgeMs ? `hsl(${streakHue} 70% ${streakLight}%)` : 'rgba(200, 149, 108, 0.7)';\n  const deepWorkMinutes = useMemo(() => summary ? Math.round(summary.deepWorkSeconds / 60) : null, [summary]);\n  const startOfDayMs = useMemo(() => getLocalDayStartMs(now, DAY_START_HOUR), [now]);\n  const productiveTodaySeconds = useMemo(() => {\n    if (!summary) return 0;\n    if (!summary.timeline?.length) return summary.totalsByCategory.productive ?? 0;\n    return summary.timeline.reduce((acc, slot) => {\n      const slotStart = Date.parse(slot.start);\n      if (!Number.isFinite(slotStart) || slotStart < startOfDayMs) return acc;\n      return acc + (slot.productive ?? 0);\n    }, 0);\n  }, [summary, startOfDayMs]);\n  const goalHours = Number.isFinite(productivityGoalHoursOverride) && (productivityGoalHoursOverride ?? 0) > 0\n    ? (productivityGoalHoursOverride as number)\n    : (Number.isFinite(productivityGoalHours) && productivityGoalHours > 0 ? productivityGoalHours : 2);\n  const goalSeconds = goalHours * 3600;\n  const ringProgressRaw = goalSeconds > 0 ? productiveTodaySeconds / goalSeconds : 0;\n  const ringProgress = Math.max(0, Math.min(1, ringProgressRaw));\n  const ringPercent = Math.round(ringProgressRaw * 100);\n  const ringRadius = 52;\n  const ringCircumference = 2 * Math.PI * ringRadius;\n  const ringOffset = ringCircumference * (1 - ringProgress);\n  const ringComplete = ringProgressRaw >= 1;\n  const remainingSeconds = Math.max(0, goalSeconds - productiveTodaySeconds);\n\n  const trophyById = useMemo(() => {\n    const map = new Map<string, TrophyStatus>();\n    trophies.forEach((trophy) => map.set(trophy.id, trophy));\n    return map;\n  }, [trophies]);\n\n  const pinnedTrophyIds = trophySummary?.pinnedTrophies?.length\n    ? trophySummary.pinnedTrophies\n    : trophies.filter((trophy) => trophy.pinned).map((trophy) => trophy.id);\n\n  const pinnedTrophies = pinnedTrophyIds\n    .map((id) => trophyById.get(id))\n    .filter((trophy): trophy is TrophyStatus => Boolean(trophy))\n    .slice(0, 3);\n\n  const nextTrophy = trophies\n    .filter((trophy) => trophy.progress.state === 'locked')\n    .sort((a, b) => b.progress.ratio - a.progress.ratio)[0] ?? null;\n\n  return (\n    <section className=\"panel\">\n      <header className=\"panel-header dashboard-header\">\n        <div className=\"dashboard-hero-left\">\n          <div>\n            <p className=\"eyebrow\">Attention control</p>\n            <h1>Your day at a glance</h1>\n            <div className=\"pill-row pill-row-tight topbar-actions\">\n              <div className=\"pill-group\">\n                <span className=\"pill ghost\">Wallet {wallet.balance} f-coins</span>\n                <button type=\"button\" className=\"pomodoro-trigger\" onClick={() => setPomodoroOpen(true)}>\n                  Locking in?\n                </button>\n              </div>\n              <span className=\"pill ghost\">\n                {deepWorkMinutes == null ? 'Deep work ‚Äî' : `Deep work ${deepWorkMinutes} min`}\n              </span>\n            </div>\n            {devices.length > 0 && (\n              <div className=\"dashboard-device-switch\">\n                <span className=\"subtle\">Viewing</span>\n                <select\n                  value={selectedDeviceId ?? ''}\n                  onChange={(event) => setSelectedDeviceId(event.target.value)}\n                >\n                  {devices.length > 1 && (\n                    <option value=\"all\">All devices</option>\n                  )}\n                  {devices.map((device) => (\n                    <option key={device.id} value={device.id}>\n                      {device.name}{device.isCurrent ? ' (this device)' : ''}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"card dashboard-time\">\n          <ActivityChart activities={activities} summary={summary} />\n        </div>\n      </header>\n\n      <div className=\"dashboard-controls\">\n        <div className=\"dashboard-tabs\" role=\"tablist\" aria-label=\"Dashboard scenes\">\n          {DASHBOARD_SCENES.map((scene) => (\n            <button\n              key={scene.id}\n              type=\"button\"\n              role=\"tab\"\n              className={dashboardScene === scene.id ? 'active' : ''}\n              aria-selected={dashboardScene === scene.id}\n              onClick={() => setDashboardScene(scene.id)}\n            >\n              <span className=\"dashboard-tab-label\">{scene.label}</span>\n              <span className=\"dashboard-tab-hint\">{scene.hint}</span>\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {pomodoroOpen && (\n        <div className=\"pomodoro-flyout\">\n          <div className=\"pomodoro-flyout-bar\">\n            <div>\n              <p className=\"eyebrow\">Deep work</p>\n              <strong>Pomodoro control</strong>\n            </div>\n            <button type=\"button\" className=\"ghost\" onClick={() => setPomodoroOpen(false)}>Close</button>\n          </div>\n          <PomodoroPanel api={api} />\n        </div>\n      )}\n\n      <div className=\"dashboard-scenes\">\n        {dashboardScene === 'focus' && (\n          <div className=\"dashboard-focus-grid\">\n            <div className={`card productivity-ring ${ringComplete ? 'complete' : ''}`}>\n              <div className=\"card-header-row\">\n                <div>\n                  <p className=\"eyebrow\">Daily productivity</p>\n                  <h2>Close your ring</h2>\n                </div>\n                <span className=\"pill ghost\">{formatGoalHours(goalHours)} goal</span>\n              </div>\n              <div className=\"productivity-ring-body\">\n                <div\n                  className=\"productivity-ring-graphic\"\n                  role=\"img\"\n                  aria-label={`Productivity ring ${formatHoursMinutesFromSeconds(productiveTodaySeconds)} of ${formatGoalHours(goalHours)}`}\n                >\n                  <div className=\"productivity-ring-glow\" />\n                  <svg viewBox=\"0 0 120 120\" aria-hidden>\n                    <circle\n                      className=\"productivity-ring-track\"\n                      cx=\"60\"\n                      cy=\"60\"\n                      r={ringRadius}\n                      strokeWidth=\"10\"\n                    />\n                    <circle\n                      className=\"productivity-ring-progress\"\n                      cx=\"60\"\n                      cy=\"60\"\n                      r={ringRadius}\n                      strokeWidth=\"10\"\n                      strokeDasharray={ringCircumference}\n                      strokeDashoffset={ringOffset}\n                    />\n                  </svg>\n                  <div className=\"productivity-ring-center\">\n                    <strong>{formatHoursMinutesFromSeconds(productiveTodaySeconds)}</strong>\n                    <span>productive</span>\n                  </div>\n                </div>\n                <div className=\"productivity-ring-meta\">\n                  <strong>{loadingSummary ? '--' : `${ringPercent}%`}</strong>\n                  <span className=\"subtle\">\n                    {loadingSummary\n                      ? 'Collecting signal...'\n                      : ringComplete\n                        ? \"You've closed your circle.\"\n                        : `${formatHoursMinutesFromSeconds(remainingSeconds)} to go`}\n                  </span>\n                  <span className=\"subtle\">Today - {formatHoursMinutesFromSeconds(goalSeconds)} target</span>\n                </div>\n              </div>\n            </div>\n\n            <div\n              className={`card dashboard-streak ${streakProgress >= 1 ? 'streak-max' : ''}`}\n              style={{\n                ['--streak-color' as string]: streakColor,\n                ['--streak-progress' as string]: `${Math.round(streakProgress * 100)}%`\n              }}\n            >\n              <div className=\"streak-header\">\n                <span className=\"eyebrow\">Recovery timer</span>\n                <span className={`pill inline ${activeCategory}`}>{activeCategory}</span>\n              </div>\n              <h2>Time since last frivolity</h2>\n              <div className=\"streak-time\">\n                {lastFrivolityLoaded ? (lastFrivolityAgeMs ? formatDuration(lastFrivolityAgeMs) : 'No frivolity logged') : 'Loading...'}\n              </div>\n              <div className=\"streak-meta\">\n                <span className=\"subtle\">\n                  {lastFrivolityAt ? `Last spend ${new Date(lastFrivolityAt).toLocaleString()}` : 'No paid sessions recorded yet.'}\n                </span>\n                <div className=\"streak-meta-row\">\n                  <span className=\"pill ghost\">Goal: 3 days</span>\n                  <span className=\"pill ghost\">{frivolityCount24h ?? 0} frivolity uses (24h)</span>\n                </div>\n              </div>\n              <div className=\"streak-bar\" aria-hidden>\n                <span />\n              </div>\n            </div>\n\n            <div className=\"card dashboard-focus-metrics\">\n              <div className=\"card-header-row\">\n                <div>\n                  <p className=\"eyebrow\">Focus deck</p>\n                  <h2>Session highlights</h2>\n                </div>\n                <span className=\"pill ghost\">{summary ? `${summary.windowHours}h window` : 'Rolling day'}</span>\n              </div>\n              <div className=\"overview-grid\">\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Active time</span>\n                  <strong>{totalHours.toFixed(1)}h</strong>\n                  <span className=\"subtle\">last {summary?.windowHours ?? 24}h</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Productivity</span>\n                  <strong>{overview?.productivityScore ?? '--'}%</strong>\n                  <span className=\"subtle\">last {overview?.periodDays ?? 7}d</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Deep work</span>\n                  <strong>{deepWorkMinutes == null ? '--' : `${deepWorkMinutes}m`}</strong>\n                  <span className=\"subtle\">today</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Frivolity</span>\n                  <strong>{frivolityCount24h == null ? '--' : frivolityCount24h}</strong>\n                  <span className=\"subtle\">last 24h</span>\n                </div>\n              </div>\n              <div className=\"dashboard-focus-meta\">\n                <div>\n                  <span className=\"metric-label\">Active context</span>\n                  <strong>{activeLabel}</strong>\n                </div>\n                <span className={`pill inline ${activeCategory}`}>{activeCategory}</span>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {dashboardScene === 'signals' && (\n          <div className=\"dashboard-signals-grid\">\n            <div className=\"dashboard-signals-main\">\n              <div className=\"card flow-card dashboard-flow\">\n                <div className=\"card-header-row\">\n                  <div>\n                    <p className=\"eyebrow\">Attention stability</p>\n                    <h2>Flow signals</h2>\n                  </div>\n                  <span className=\"pill ghost\">Last 24h</span>\n                </div>\n                <div className=\"flow-metrics\">\n                  <div>\n                    <span className=\"label\">Context switches</span>\n                    <strong>{switchesPerHour == null ? '--' : `${switchesPerHour.toFixed(1)}/h`}</strong>\n                    <span className=\"subtle\">avg across window</span>\n                  </div>\n                  <div>\n                    <span className=\"label\">Thrash rate</span>\n                    <strong>{thrashPerHour == null ? '--' : `${thrashPerHour.toFixed(1)}/h`}</strong>\n                    <span className=\"subtle\">rapid hops</span>\n                  </div>\n                  <div>\n                    <span className=\"label\">Idle ratio</span>\n                    <strong>{idleRatio == null ? '--' : `${Math.round(idleRatio * 100)}%`}</strong>\n                    <span className=\"subtle\">passive time</span>\n                  </div>\n                  <div>\n                    <span className=\"label\">Longest run</span>\n                    <strong>{longestProductiveRunHours}h</strong>\n                    <span className=\"subtle\">productive streak</span>\n                  </div>\n                </div>\n                <div className=\"flow-toggle\">\n                  <button\n                    type=\"button\"\n                    className={`pill ghost ${flowMetric === 'productivity' ? 'active' : ''}`}\n                    onClick={() => setFlowMetric('productivity')}\n                  >\n                    Productivity\n                  </button>\n                  <button\n                    type=\"button\"\n                    className={`pill ghost ${flowMetric === 'switches' ? 'active' : ''}`}\n                    onClick={() => setFlowMetric('switches')}\n                  >\n                    Switches\n                  </button>\n                  <button\n                    type=\"button\"\n                    className={`pill ghost ${flowMetric === 'thrash' ? 'active' : ''}`}\n                    onClick={() => setFlowMetric('thrash')}\n                  >\n                    Thrash\n                  </button>\n                  <button\n                    type=\"button\"\n                    className={`pill ghost ${flowMetric === 'idle' ? 'active' : ''}`}\n                    onClick={() => setFlowMetric('idle')}\n                  >\n                    Idle\n                  </button>\n                </div>\n                <div className=\"flow-sparkline\">\n                  <span className=\"label\">\n                    {flowMetric === 'switches'\n                      ? 'Switches trend'\n                      : flowMetric === 'thrash'\n                        ? 'Thrash trend'\n                        : flowMetric === 'idle'\n                          ? 'Idle trend'\n                          : 'Productive trend'}\n                  </span>\n                  <div className=\"flow-sparkline-track\">\n                    {flowTrend.length > 1 ? (\n                      <svg viewBox=\"0 0 100 40\" preserveAspectRatio=\"none\" aria-hidden>\n                        <path\n                          d={buildSparklinePath(flowTrend)}\n                          fill=\"none\"\n                          stroke=\"currentColor\"\n                          strokeWidth=\"2\"\n                        />\n                      </svg>\n                    ) : (\n                      <span className=\"subtle\">Collecting signal‚Ä¶</span>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"dashboard-insights\">\n                <Insights api={api} overview={overview} loading={loadingOverview} onRefresh={refreshOverview} />\n              </div>\n            </div>\n\n            <div className=\"card dashboard-overview\">\n              <div className=\"card-header-row\">\n                <div>\n                  <p className=\"eyebrow\">Signal deck</p>\n                  <h2>Focus telemetry</h2>\n                </div>\n                <span className=\"pill ghost\">{summary ? `${summary.windowHours}h window` : 'Rolling day'}</span>\n              </div>\n              <div className=\"overview-grid\">\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Active time</span>\n                  <strong>{totalHours.toFixed(1)}h</strong>\n                  <span className=\"subtle\">last {summary?.windowHours ?? 24}h</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Productivity</span>\n                  <strong>{overview?.productivityScore ?? '--'}%</strong>\n                  <span className=\"subtle\">last {overview?.periodDays ?? 7}d</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Avg session</span>\n                  <strong>{overview ? formatDuration(overview.avgSessionLength * 1000) : '--'}</strong>\n                  <span className=\"subtle\">{overview?.totalSessions ?? '--'} sessions</span>\n                </div>\n                <div className=\"overview-metric\">\n                  <span className=\"label\">Peak hour</span>\n                  <strong>{overview ? formatHour(overview.peakProductiveHour) : '--'}</strong>\n                  <span className=\"subtle\">risk {overview ? formatHour(overview.riskHour) : '--'}</span>\n                </div>\n              </div>\n              <div className=\"overview-breakdown\">\n                <span className=\"label\">Category mix</span>\n                <div className=\"overview-bars\">\n                  {renderCategoryBar('Productive', 'productive', overview)}\n                  {renderCategoryBar('Neutral', 'neutral', overview)}\n                  {renderCategoryBar('Frivolity', 'frivolity', overview)}\n                  {renderCategoryBar('Draining', 'draining', overview)}\n                  {renderCategoryBar('Idle', 'idle', overview)}\n                </div>\n              </div>\n              <div className=\"overview-top\">\n                <span className=\"label\">Top contexts</span>\n                <ul className=\"overview-list\">\n                  {topContexts.slice(0, 3).map((ctx) => (\n                    <li key={ctx.label}>\n                      <strong>{ctx.label}</strong>\n                      <span className=\"subtle\">{Math.round(ctx.seconds / 60)}m ‚Ä¢ {ctx.source === 'url' ? 'Browser' : 'App'}</span>\n                    </li>\n                  ))}\n                  {topContexts.length === 0 && <li className=\"subtle\">No streams yet.</li>}\n                </ul>\n                {overview?.topEngagementDomain && !isExcludedLabel(overview.topEngagementDomain) && (\n                  <div className=\"overview-highlight\">\n                    <span className=\"label\">Most engaging</span>\n                    <strong>{overview.topEngagementDomain}</strong>\n                    <span className=\"subtle\">highest attention hold this week</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {dashboardScene === 'journey' && (\n          <div className=\"dashboard-journey-grid\">\n            <div className=\"dashboard-orbit\">\n              <DayCompass summary={summary} economy={economy} />\n            </div>\n            <div className=\"dashboard-timeline\">\n              <DayJourney journey={journey} loading={loadingSummary} isRemote={isRemoteView} />\n              <AttentionMap journey={journey} loading={loadingSummary} isRemote={isRemoteView} />\n            </div>\n          </div>\n        )}\n\n        {dashboardScene === 'social' && (\n          <div className=\"dashboard-social-grid\">\n            <div className=\"card friends-strip\">\n              <div className=\"friends-strip-header\">\n                <div>\n                  <p className=\"eyebrow\">Friends</p>\n                  <h2>In the zone</h2>\n                </div>\n                <span className=\"pill ghost\">Last 24h</span>\n              </div>\n              {!friendsReady ? (\n                <div className=\"friends-empty\">\n                  <strong>Syncing friends‚Ä¶</strong>\n                  <span className=\"subtle\">Connect the desktop app to pull stats.</span>\n                </div>\n              ) : friends.length === 0 ? (\n                <div className=\"friends-empty\">\n                  <strong>No friends yet</strong>\n                  <span className=\"subtle\">Add a handle in the Friends tab.</span>\n                </div>\n              ) : (\n                <div className=\"friends-strip-row\">\n                  {friends.map((friend) => {\n                    const summary = friendSummaries[friend.userId];\n                    const totals = summary?.categoryBreakdown ?? null;\n                    const active = summary?.totalActiveSeconds ?? 0;\n                    const productivePct = active > 0 ? (totals!.productive / active) * 100 : 0;\n                    const neutralPct = active > 0 ? (totals!.neutral / active) * 100 : 0;\n                    const frivolityPct = active > 0 ? (totals!.frivolity / active) * 100 : 0;\n                    const friendTrophies = (friend.pinnedTrophies ?? [])\n                      .map((id) => trophyById.get(id))\n                      .filter((trophy): trophy is TrophyStatus => Boolean(trophy));\n                    return (\n                      <button key={friend.id} type=\"button\" className=\"friends-chip\" onClick={() => openFriendDetail(friend)}>\n                        <div className=\"friends-chip-header\">\n                          <div>\n                            <strong>{friend.displayName ?? friend.handle ?? 'Friend'}</strong>\n                            <span className=\"subtle\">@{friend.handle ?? 'no-handle'}</span>\n                          </div>\n                          <span className=\"pill ghost\">{summary ? `${summary.productivityScore}%` : '--'}</span>\n                        </div>\n                        <div className=\"friends-chip-activity\">\n                          <span>{summary ? formatHoursFromSeconds(summary.totalActiveSeconds) : '--'} active</span>\n                          <span className=\"subtle\">{summary ? `Updated ${new Date(summary.updatedAt).toLocaleTimeString()}` : 'No data yet'}</span>\n                        </div>\n                        <div className=\"friends-chip-bar\">\n                          <span className=\"cat-productive\" style={{ width: `${productivePct}%` }} />\n                          <span className=\"cat-neutral\" style={{ width: `${neutralPct}%` }} />\n                          <span className=\"cat-frivolity\" style={{ width: `${frivolityPct}%` }} />\n                        </div>\n                        {competitiveOptIn ? (\n                          <div className=\"head-to-head\">\n                            {friendSummaries[friend.userId] ? (\n                              <>\n                                <div className=\"head-to-head-row\">\n                                  <span>You</span>\n                                  <span>{friend.displayName ?? friend.handle ?? 'Friend'}</span>\n                                </div>\n                                <div className=\"head-to-head-bar fancy\">\n                                  <span\n                                    className=\"head-to-head-left\"\n                                    style={{ width: `${headToHeadPercentFromSummary(myHeadToHeadSummary, friendSummaries[friend.userId])}%`, background: myProfile?.color ?? 'var(--accent)' }}\n                                  />\n                                  <span\n                                    className=\"head-to-head-right\"\n                                    style={{ width: `${100 - headToHeadPercentFromSummary(myHeadToHeadSummary, friendSummaries[friend.userId])}%`, background: friend.color ?? 'rgba(255, 255, 255, 0.3)' }}\n                                  />\n                                  <div className=\"head-to-head-glow\" />\n                                </div>\n                                <div className=\"head-to-head-row subtle\">\n                                  <span>{formatMinutes(myHeadToHeadSummary?.categoryBreakdown.productive ?? 0)} productive</span>\n                                  <span>{formatMinutes(friendSummaries[friend.userId]?.categoryBreakdown.productive ?? 0)} productive</span>\n                                </div>\n                                <div className=\"head-to-head-row subtle\">\n                                  <span>{formatCount(myHeadToHeadSummary?.emergencySessions)} emergency</span>\n                                  <span>{formatCount(friendSummaries[friend.userId]?.emergencySessions)} emergency</span>\n                                </div>\n                              </>\n                            ) : (\n                              <p className=\"subtle\" style={{ marginTop: 6 }}>\n                                Waiting for shared activity data.\n                              </p>\n                            )}\n                          </div>\n                        ) : (\n                          <p className=\"subtle\" style={{ marginTop: 10 }}>Competitive view is off.</p>\n                        )}\n                        {friendTrophies.length > 0 && (\n                          <div className=\"friends-trophies\">\n                            {friendTrophies.slice(0, 3).map((trophy) => (\n                              <span key={trophy.id} className=\"trophy-badge\">\n                                <span className=\"emoji\">{trophy.emoji}</span>\n                                {trophy.name}\n                              </span>\n                            ))}\n                          </div>\n                        )}\n                      </button>\n                    );\n                  })}\n                </div>\n              )}\n            </div>\n\n            {trophies.length > 0 && (\n              <div className=\"card trophy-strip\">\n                <div className=\"trophy-strip-header\">\n                  <div>\n                    <p className=\"eyebrow\">Trophies</p>\n                    <h2>Case highlights</h2>\n                  </div>\n                  <span className=\"pill ghost\">Profile view</span>\n                </div>\n                <div className=\"trophy-strip-row\">\n                  {pinnedTrophies.length === 0 ? (\n                    <div className=\"friends-empty\">\n                      <strong>No pinned trophies</strong>\n                      <span className=\"subtle\">Pin trophies in your Profile page.</span>\n                    </div>\n                  ) : (\n                    pinnedTrophies.map((trophy) => (\n                      <div key={trophy.id} className=\"trophy-badge\">\n                        <span className=\"emoji\">{trophy.emoji}</span>\n                        <span>{trophy.name}</span>\n                      </div>\n                    ))\n                  )}\n                </div>\n                {nextTrophy && (\n                  <div className=\"trophy-next\">\n                    <span className=\"label\">Next up</span>\n                    <div className=\"trophy-next-body\">\n                      <span className=\"emoji\">{nextTrophy.emoji}</span>\n                      <div>\n                        <strong>{nextTrophy.name}</strong>\n                        <span className=\"subtle\">{nextTrophy.progress.label ?? `${nextTrophy.progress.current}/${nextTrophy.progress.target}`}</span>\n                      </div>\n                    </div>\n                    <div className=\"progress-bar\">\n                      <span style={{ width: `${Math.round(nextTrophy.progress.ratio * 100)}%` }} />\n                    </div>\n                  </div>\n                )}\n                {trophyToast && (\n                  <div className=\"trophy-toast\">\n                    <span className=\"emoji\">{trophyToast.emoji}</span>\n                    <div>\n                      <strong>{trophyToast.name}</strong>\n                      <span className=\"subtle\">New trophy earned</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      <FriendDetailModal\n        open={friendDetailOpen}\n        friend={selectedFriend}\n        summary={selectedFriend ? friendSummaries[selectedFriend.userId] ?? null : null}\n        timeline={friendTimeline}\n        publicLibraryItems={friendPublicLibrary}\n        trophies={trophies}\n        onClose={() => setFriendDetailOpen(false)}\n      />\n    </section>\n  );\n}\n\nfunction formatDuration(ms: number) {\n  const totalMinutes = Math.max(0, Math.floor(ms / 60000));\n  const days = Math.floor(totalMinutes / (60 * 24));\n  const hours = Math.floor((totalMinutes % (60 * 24)) / 60);\n  const minutes = totalMinutes % 60;\n  if (days > 0) return `${days}d ${hours}h ${minutes}m`;\n  return `${hours}h ${minutes}m`;\n}\n\nfunction formatHour(h: number) {\n  const ampm = h >= 12 ? 'PM' : 'AM';\n  const hour = h % 12 || 12;\n  return `${hour}${ampm}`;\n}\n\nfunction formatHoursFromSeconds(seconds: number) {\n  const hours = seconds / 3600;\n  return hours >= 10 ? `${hours.toFixed(0)}h` : `${hours.toFixed(1)}h`;\n}\n\nfunction formatHoursMinutesFromSeconds(seconds: number) {\n  const totalMinutes = Math.max(0, Math.round(seconds / 60));\n  const hours = Math.floor(totalMinutes / 60);\n  const minutes = totalMinutes % 60;\n  return `${hours}h ${minutes}m`;\n}\n\nfunction formatGoalHours(hours: number) {\n  if (!Number.isFinite(hours)) return '0h';\n  return hours % 1 === 0 ? `${hours.toFixed(0)}h` : `${hours.toFixed(1)}h`;\n}\n\nfunction formatMinutes(seconds: number) {\n  return `${Math.round(seconds / 60)}m`;\n}\n\nfunction formatCount(value?: number | null) {\n  if (typeof value !== 'number') return '‚Äî';\n  return String(value);\n}\n\nfunction toHourStart(value: string) {\n  const date = new Date(value);\n  date.setMinutes(0, 0, 0);\n  return date.toISOString();\n}\n\nfunction buildSparklinePath(values: number[]) {\n  if (values.length < 2) return '';\n  const max = Math.max(...values);\n  const min = Math.min(...values);\n  const range = Math.max(0.001, max - min);\n  return values\n    .map((value, idx) => {\n      const x = (idx / (values.length - 1)) * 100;\n      const y = 36 - ((value - min) / range) * 32;\n      return `${idx === 0 ? 'M' : 'L'}${x.toFixed(2)} ${y.toFixed(2)}`;\n    })\n    .join(' ');\n}\n\nfunction activityToFriendSummary(activity: ActivitySummary): FriendSummary {\n  return {\n    userId: 'me',\n    updatedAt: new Date().toISOString(),\n    periodHours: activity.windowHours,\n    totalActiveSeconds: activity.totalSeconds,\n    deepWorkSeconds: activity.deepWorkSeconds,\n    categoryBreakdown: {\n      productive: activity.totalsByCategory.productive ?? 0,\n      neutral: activity.totalsByCategory.neutral ?? 0,\n      frivolity: activity.totalsByCategory.frivolity ?? 0,\n      draining: (activity.totalsByCategory as any).draining ?? 0,\n      idle: activity.totalsByCategory.idle ?? 0\n    },\n    productivityScore: activity.totalSeconds > 0\n      ? Math.round((activity.totalsByCategory.productive / activity.totalSeconds) * 100)\n      : 0\n  };\n}\n\nfunction headToHeadPercentFromSummary(me: FriendSummary | null, friend: FriendSummary | null) {\n  const myProductive = me?.categoryBreakdown.productive ?? 0;\n  const friendProductive = friend?.categoryBreakdown.productive ?? 0;\n  const total = myProductive + friendProductive;\n  if (total === 0) return 50;\n  return Math.round((myProductive / total) * 100);\n}\n\nfunction renderCategoryBar(label: string, key: 'productive' | 'neutral' | 'frivolity' | 'draining' | 'idle', overview: AnalyticsOverview | null) {\n  const totals = overview?.categoryBreakdown ?? { productive: 0, neutral: 0, frivolity: 0, draining: 0, idle: 0 };\n  const total = totals.productive + totals.neutral + totals.frivolity + (totals as any).draining + totals.idle;\n  const value = totals[key] ?? 0;\n  const pct = total > 0 ? Math.round((value / total) * 100) : 0;\n  return (\n    <div className=\"overview-bar\" key={key}>\n      <div className=\"overview-bar-label\">\n        <span>{label}</span>\n        <span className=\"subtle\">{pct}%</span>\n      </div>\n      <div className=\"overview-bar-track\">\n        <span className={`overview-bar-fill cat-${key}`} style={{ width: `${pct}%` }} />\n      </div>\n    </div>\n  );\n}\n\nfunction formatDayInput(date: Date) {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport type { CategorisationConfig, RendererApi } from '@shared/types';\n\ntype Props = {\n  api: RendererApi;\n  variant?: 'page' | 'settings';\n};\n\ntype DomainCategory = 'productive' | 'neutral' | 'frivolous' | 'draining';\n\nfunction normaliseDomain(raw: string) {\n  const trimmed = raw.trim().toLowerCase();\n  if (!trimmed) return null;\n  if (trimmed.startsWith('http://') || trimmed.startsWith('https://')) {\n    try {\n      return new URL(trimmed).hostname.replace(/^www\\./, '');\n    } catch {\n      return null;\n    }\n  }\n  return trimmed.split('/')[0].replace(/^www\\./, '');\n}\n\nfunction uniq(list: string[]) {\n  const seen = new Set<string>();\n  const result: string[] = [];\n  for (const raw of list) {\n    const d = normaliseDomain(raw);\n    if (!d || seen.has(d)) continue;\n    seen.add(d);\n    result.push(d);\n  }\n  return result;\n}\n\nexport default function Domains({ api, variant = 'page' }: Props) {\n  const [config, setConfig] = useState<CategorisationConfig | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [saved, setSaved] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const [newDomain, setNewDomain] = useState('');\n  const [newCategory, setNewCategory] = useState<DomainCategory>('frivolous');\n\n  const load = useCallback(async () => {\n    try {\n      const next = await api.settings.categorisation();\n      setConfig(next);\n    } catch (err) {\n      console.error('Failed to load categorisation', err);\n      setError('Could not load domain lists.');\n    } finally {\n      setLoading(false);\n    }\n  }, [api.settings]);\n\n  useEffect(() => {\n    load();\n  }, [load]);\n\n  const totals = useMemo(() => {\n    if (!config) return { productive: 0, neutral: 0, frivolity: 0, draining: 0 };\n    return {\n      productive: config.productive.length,\n      neutral: config.neutral.length,\n      frivolity: config.frivolity.length,\n      draining: (config as any).draining?.length ?? 0\n    };\n  }, [config]);\n\n  const saveConfig = async (next: CategorisationConfig) => {\n    setSaving(true);\n    setError(null);\n    try {\n      await api.settings.updateCategorisation(next);\n      setConfig(next);\n      setSaved(true);\n      window.setTimeout(() => setSaved(false), 1500);\n    } catch (err) {\n      setError((err as Error).message || 'Failed to save');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const setDomainCategory = async (domain: string, category: DomainCategory) => {\n    if (!config) return;\n\n    const d = normaliseDomain(domain);\n    if (!d) {\n      setError('Please enter a valid domain.');\n      return;\n    }\n\n    const productive = uniq(config.productive.filter((x) => normaliseDomain(x) !== d));\n    const neutral = uniq(config.neutral.filter((x) => normaliseDomain(x) !== d));\n    const frivolity = uniq(config.frivolity.filter((x) => normaliseDomain(x) !== d));\n    const draining = uniq(((config as any).draining ?? []).filter((x: string) => normaliseDomain(x) !== d));\n\n    if (category === 'productive') productive.unshift(d);\n    if (category === 'neutral') neutral.unshift(d);\n    if (category === 'frivolous') frivolity.unshift(d);\n    if (category === 'draining') draining.unshift(d);\n\n    await saveConfig({ productive, neutral, frivolity, draining });\n  };\n\n  const removeDomain = async (domain: string) => {\n    if (!config) return;\n    const d = normaliseDomain(domain);\n    if (!d) return;\n    await saveConfig({\n      productive: config.productive.filter((x) => normaliseDomain(x) !== d),\n      neutral: config.neutral.filter((x) => normaliseDomain(x) !== d),\n      frivolity: config.frivolity.filter((x) => normaliseDomain(x) !== d),\n      draining: (config as any).draining?.filter((x: string) => normaliseDomain(x) !== d) ?? []\n    });\n  };\n\n  const handleQuickAdd = async () => {\n    setError(null);\n    const domain = normaliseDomain(newDomain);\n    if (!domain) {\n      setError('Enter a domain like twitter.com');\n      return;\n    }\n    setNewDomain('');\n    await setDomainCategory(domain, newCategory);\n  };\n\n  if (loading) return <div className=\"panel\">Loading domains‚Ä¶</div>;\n  if (!config) return <div className=\"panel\">Could not load domains.</div>;\n\n  const wrapperClass = variant === 'settings' ? 'store-page settings-domains' : 'page store-page';\n\n  return (\n    <section className={wrapperClass}>\n      {variant === 'page' ? (\n        <header className=\"page-header\">\n          <div>\n            <h1>Domains</h1>\n            <p className=\"subtle\">\n              Keep this simple: <strong>productive</strong>, <strong>neutral</strong>, <strong>draining</strong>, or <strong>frivolous</strong>.\n              Idle is inferred automatically.\n            </p>\n          </div>\n          <div className=\"pill-row\">\n            <span className=\"pill ghost\">{totals.productive} productive</span>\n            <span className=\"pill ghost\">{totals.neutral} neutral</span>\n            <span className=\"pill ghost\">{totals.frivolity} frivolous</span>\n            <span className=\"pill ghost\">{totals.draining} draining</span>\n          </div>\n        </header>\n      ) : (\n        <div className=\"settings-section-header\">\n          <div>\n            <h2>Domains</h2>\n            <p className=\"subtle\">\n              Keep this simple: <strong>productive</strong>, <strong>neutral</strong>, <strong>draining</strong>, or <strong>frivolous</strong>.\n              Idle is inferred automatically.\n            </p>\n          </div>\n          <div className=\"pill-row\">\n            <span className=\"pill ghost\">{totals.productive} productive</span>\n            <span className=\"pill ghost\">{totals.neutral} neutral</span>\n            <span className=\"pill ghost\">{totals.frivolity} frivolous</span>\n            <span className=\"pill ghost\">{totals.draining} draining</span>\n          </div>\n        </div>\n      )}\n\n      {error && <p className=\"error-text\">{error}</p>}\n      {saved && <p className=\"subtle\">Saved.</p>}\n\n      <div className=\"card\">\n        <h3>Quick classify</h3>\n        <div className=\"settings-grid\" style={{ gridTemplateColumns: '1.2fr 1fr auto', alignItems: 'end' }}>\n          <label>\n            Domain\n            <input\n              value={newDomain}\n              onChange={(e) => setNewDomain(e.target.value)}\n              placeholder=\"twitter.com\"\n              disabled={saving}\n            />\n          </label>\n          <label>\n            Category\n            <select\n              value={newCategory}\n              onChange={(e) => setNewCategory(e.target.value as DomainCategory)}\n              disabled={saving}\n            >\n              <option value=\"productive\">productive</option>\n              <option value=\"neutral\">neutral</option>\n              <option value=\"frivolous\">frivolous</option>\n              <option value=\"draining\">draining</option>\n            </select>\n          </label>\n          <button className=\"primary\" type=\"button\" disabled={saving} onClick={handleQuickAdd}>\n            Add\n          </button>\n        </div>\n        <p className=\"subtle\" style={{ marginTop: 10 }}>\n          Tip: you can also label domains from the browser extension popup.\n        </p>\n      </div>\n\n      <div className=\"store-grid\" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(260px, 1fr))' }}>\n        <DomainList\n          title=\"Productive\"\n          subtitle=\"Earns f-coins.\"\n          items={config.productive}\n          onRemove={removeDomain}\n          onMove={(domain) => setDomainCategory(domain, 'productive')}\n          disabled={saving}\n        />\n        <DomainList\n          title=\"Neutral\"\n          subtitle=\"Safe by default (earning depends on your clock-in settings).\"\n          items={config.neutral}\n          onRemove={removeDomain}\n          onMove={(domain) => setDomainCategory(domain, 'neutral')}\n          disabled={saving}\n        />\n        <DomainList\n          title=\"Frivolous\"\n          subtitle=\"Paywall applies here.\"\n          items={config.frivolity}\n          onRemove={removeDomain}\n          onMove={(domain) => setDomainCategory(domain, 'frivolous')}\n          disabled={saving}\n        />\n        <DomainList\n          title=\"Draining\"\n          subtitle=\"Passively costs coins (no paywall).\"\n          items={(config as any).draining ?? []}\n          onRemove={removeDomain}\n          onMove={(domain) => setDomainCategory(domain, 'draining')}\n          disabled={saving}\n        />\n      </div>\n    </section>\n  );\n}\n\nfunction DomainList(props: {\n  title: string;\n  subtitle: string;\n  items: string[];\n  disabled: boolean;\n  onRemove(domain: string): void;\n  onMove(domain: string): void;\n}) {\n  const { title, subtitle, items, disabled, onRemove } = props;\n  return (\n    <div className=\"card store-item\">\n      <div className=\"store-item-headline\">\n        <div>\n          <p className=\"store-item-domain\">{title}</p>\n          <h3 className=\"store-item-title\">{items.length} domains</h3>\n        </div>\n        <div className=\"store-item-price-pill\">\n          <strong>{items.length}</strong>\n          <span>items</span>\n        </div>\n      </div>\n      <p className=\"subtle\" style={{ marginTop: 6 }}>{subtitle}</p>\n      {items.length === 0 ? (\n        <div className=\"empty-state\" style={{ padding: 0 }}>\n          <p className=\"subtle\">None yet.</p>\n        </div>\n      ) : (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 8, marginTop: 8 }}>\n          {items.slice(0, 12).map((domain) => (\n            <div key={domain} style={{ display: 'flex', gap: 10, justifyContent: 'space-between', alignItems: 'center' }}>\n              <code style={{ fontSize: 12, color: 'var(--fg-muted)' }}>{domain}</code>\n              <button className=\"ghost danger\" disabled={disabled} onClick={() => onRemove(domain)}>\n                Remove\n              </button>\n            </div>\n          ))}\n          {items.length > 12 && (\n            <p className=\"subtle\" style={{ margin: 0 }}>\n              Showing 12 of {items.length}. Use search/edit tools in a future iteration.\n            </p>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useRef, useState } from 'react';\n\ntype CurveEditorProps = {\n    values: number[]; // Array of 24 numbers\n    onChange: (values: number[]) => void;\n    color: string;\n    disabled?: boolean;\n};\n\nexport default function CurveEditor({ values, onChange, color, disabled = false }: CurveEditorProps) {\n    const [isDragging, setIsDragging] = useState(false);\n    const svgRef = useRef<SVGSVGElement>(null);\n\n    const handleInteraction = (event: React.MouseEvent | React.TouchEvent) => {\n        if (disabled) return;\n        if (!svgRef.current) return;\n        const rect = svgRef.current.getBoundingClientRect();\n        const clientX = 'touches' in event ? event.touches[0].clientX : (event as React.MouseEvent).clientX;\n        const clientY = 'touches' in event ? event.touches[0].clientY : (event as React.MouseEvent).clientY;\n\n        const x = clientX - rect.left;\n        const y = clientY - rect.top;\n\n        const width = rect.width;\n        const height = rect.height;\n\n        // Determine which hour (bar) we are interacting with\n        const barWidth = width / 24;\n        const hour = Math.floor(x / barWidth);\n\n        if (hour >= 0 && hour < 24) {\n            // Determine value based on Y position (0 at bottom, 2 at top?)\n            // Let's say max multiplier is 3x, min is 0x.\n            const maxVal = 3;\n            const normalizedY = 1 - (y / height); // 0 to 1\n            const newValue = Math.max(0, Math.min(maxVal, normalizedY * maxVal));\n\n            const newValues = [...values];\n            newValues[hour] = Number(newValue.toFixed(1));\n            onChange(newValues);\n        }\n    };\n\n    return (\n        <div className=\"curve-editor\" style={{ userSelect: 'none', opacity: disabled ? 0.5 : 1 }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px', fontSize: '12px', color: 'var(--text-subtle)' }}>\n                <span>00:00</span>\n                <span>06:00</span>\n                <span>12:00</span>\n                <span>18:00</span>\n                <span>23:59</span>\n            </div>\n            <svg\n                ref={svgRef}\n                width=\"100%\"\n                height=\"200\"\n                style={{ background: 'rgba(0,0,0,0.05)', borderRadius: '8px', cursor: disabled ? 'not-allowed' : 'crosshair' }}\n                onMouseDown={(e) => { if (disabled) return; setIsDragging(true); handleInteraction(e); }}\n                onMouseMove={(e) => { if (!disabled && isDragging) handleInteraction(e); }}\n                onMouseUp={() => setIsDragging(false)}\n                onMouseLeave={() => setIsDragging(false)}\n                onTouchStart={(e) => { if (disabled) return; setIsDragging(true); handleInteraction(e); }}\n                onTouchMove={(e) => { if (!disabled && isDragging) handleInteraction(e); }}\n                onTouchEnd={() => setIsDragging(false)}\n            >\n                {/* Grid lines */}\n                {[0.5, 1, 1.5, 2, 2.5].map(val => (\n                    <line\n                        key={val}\n                        x1=\"0\"\n                        y1={200 - (val / 3) * 200}\n                        x2=\"100%\"\n                        y2={200 - (val / 3) * 200}\n                        stroke=\"rgba(0,0,0,0.1)\"\n                        strokeDasharray=\"4 4\"\n                    />\n                ))}\n\n                {/* Bars */}\n                {values.map((val, i) => {\n                    const barHeight = (val / 3) * 200;\n                    return (\n                        <rect\n                            key={i}\n                            x={`${(i / 24) * 100}%`}\n                            y={200 - barHeight}\n                            width={`${100 / 24}%`}\n                            height={barHeight}\n                            fill={color}\n                            stroke=\"#fff\"\n                            strokeWidth=\"1\"\n                            opacity=\"0.8\"\n                        />\n                    );\n                })}\n            </svg>\n            <div style={{ textAlign: 'center', marginTop: '8px', fontSize: '12px' }}>\n                {disabled ? 'Active session detected ‚Äî edits locked until it ends.' : 'Click and drag to adjust hourly multipliers (0x - 3x)'}\n            </div>\n        </div>\n    );\n}\n","import React, { useState, useEffect, useMemo } from 'react';\nimport type { RendererApi, MarketRate, CategorisationConfig, PaywallSession } from '@shared/types';\nimport CurveEditor from './CurveEditor';\n\ntype EconomyTunerProps = {\n    api: RendererApi;\n};\n\ntype TunerItem = {\n    id: string;\n    type: 'productive' | 'frivolity' | 'neutral';\n    rate: MarketRate;\n};\n\nexport default function EconomyTuner({ api }: EconomyTunerProps) {\n    const [items, setItems] = useState<TunerItem[]>([]);\n    const [selectedId, setSelectedId] = useState<string | null>(null);\n    const [activeTab, setActiveTab] = useState<'productive' | 'frivolity'>('productive');\n    const [saving, setSaving] = useState(false);\n    const [activeSessions, setActiveSessions] = useState<Record<string, PaywallSession>>({});\n    const [error, setError] = useState<string | null>(null);\n    const [saveMessage, setSaveMessage] = useState<string | null>(null);\n    const [exchangeTarget, setExchangeTarget] = useState<number | null>(null);\n    const [exchangeApplying, setExchangeApplying] = useState(false);\n    const [exchangeMessage, setExchangeMessage] = useState<string | null>(null);\n    const [dailyResetEnabled, setDailyResetEnabled] = useState(true);\n    const [dailyResetSaving, setDailyResetSaving] = useState(false);\n\n    const [isAdding, setIsAdding] = useState(false);\n    const [newDomain, setNewDomain] = useState('');\n    const [newPackMinutes, setNewPackMinutes] = useState(10);\n    const [newPackPrice, setNewPackPrice] = useState(8);\n    const [isAddingPack, setIsAddingPack] = useState(false);\n\n    useEffect(() => {\n        loadData();\n        api.settings.economyExchangeRate().then((value) => {\n            if (typeof value === 'number' && Number.isFinite(value)) setExchangeTarget(value);\n        }).catch(() => { });\n        api.settings.dailyWalletResetEnabled().then(setDailyResetEnabled).catch(() => { });\n    }, []);\n\n    useEffect(() => {\n        const refreshSessions = () => api.paywall.sessions().then((list) => {\n            const map: Record<string, PaywallSession> = {};\n            list.forEach((session) => { map[session.domain] = session; });\n            setActiveSessions(map);\n        }).catch(() => { /* ignore */ });\n\n        refreshSessions();\n        const unsubStart = api.events.on('paywall:session-started', refreshSessions);\n        const unsubEnd = api.events.on('paywall:session-ended', refreshSessions);\n        const unsubPause = api.events.on('paywall:session-paused', refreshSessions);\n        const unsubResume = api.events.on('paywall:session-resumed', refreshSessions);\n\n        return () => {\n            unsubStart();\n            unsubEnd();\n            unsubPause();\n            unsubResume();\n        };\n    }, [api]);\n\n    async function loadData() {\n        const [rates, config, sessionsList] = await Promise.all([\n            api.market.list(),\n            api.settings.categorisation(),\n            api.paywall.sessions()\n        ]);\n\n        const merged: TunerItem[] = [];\n        const rateMap = new Map(rates.map(r => [r.domain, r]));\n\n        // Helper to create or get rate\n        const getRate = (domain: string, defaultRate: number): MarketRate => {\n            return rateMap.get(domain) || {\n                domain,\n                ratePerMin: defaultRate,\n                packs: [],\n                hourlyModifiers: Array(24).fill(1)\n            };\n        };\n\n        config.productive.forEach(domain => {\n            merged.push({ id: domain, type: 'productive', rate: getRate(domain, 5) });\n        });\n        config.frivolity.forEach(domain => {\n            merged.push({ id: domain, type: 'frivolity', rate: getRate(domain, 3) });\n        });\n        // Add any market rates that aren't in config (custom ones)\n        rates.forEach(rate => {\n            if (!merged.find(m => m.id === rate.domain)) {\n                // Default to frivolity if unknown, or maybe neutral? \n                // For now let's assume neutral items are frivolity for tuning purposes unless specified\n                merged.push({ id: rate.domain, type: 'neutral', rate });\n            }\n        });\n\n        setItems(merged);\n        const sessionMap: Record<string, PaywallSession> = {};\n        sessionsList.forEach((session) => {\n            sessionMap[session.domain] = session;\n        });\n        setActiveSessions(sessionMap);\n    }\n\n    const filteredItems = items.filter(item => {\n        if (activeTab === 'productive') return item.type === 'productive';\n        return item.type === 'frivolity' || item.type === 'neutral';\n    });\n\n    // Auto-select first item when tab changes or data loads\n    useEffect(() => {\n        if (!isAdding && filteredItems.length > 0 && (!selectedId || !filteredItems.find(i => i.id === selectedId))) {\n            setSelectedId(filteredItems[0].id);\n        } else if (filteredItems.length === 0 && !isAdding) {\n            setSelectedId(null);\n        }\n    }, [activeTab, items, isAdding]);\n\n    useEffect(() => {\n        setError(null);\n    }, [selectedId]);\n\n    useEffect(() => {\n        if (!exchangeMessage) return;\n        const timer = setTimeout(() => setExchangeMessage(null), 2400);\n        return () => clearTimeout(timer);\n    }, [exchangeMessage]);\n\n    const selectedItem = items.find(i => i.id === selectedId);\n    const lockedSession = selectedItem ? activeSessions[selectedItem.id] : undefined;\n    const locked = !!lockedSession;\n\n    useEffect(() => {\n        if (!saveMessage) return;\n        const timer = setTimeout(() => setSaveMessage(null), 2000);\n        return () => clearTimeout(timer);\n    }, [saveMessage]);\n\n    const handleRateChange = (newRate: number) => {\n        if (!selectedItem || locked) return;\n        updateItemRate(selectedItem.id, { ...selectedItem.rate, ratePerMin: newRate });\n    };\n\n    const handleCurveChange = (newModifiers: number[]) => {\n        if (!selectedItem || locked) return;\n        updateItemRate(selectedItem.id, { ...selectedItem.rate, hourlyModifiers: newModifiers });\n    };\n\n    const toggleDailyReset = async (next: boolean) => {\n        if (dailyResetSaving) return;\n        setDailyResetSaving(true);\n        try {\n            await api.settings.updateDailyWalletResetEnabled(next);\n            setDailyResetEnabled(next);\n            setExchangeMessage(next ? 'Daily coin reset enabled ‚Äî wallet starts at 0 each day.' : 'Daily coin reset disabled.');\n        } catch (err) {\n            setError((err as Error).message);\n        } finally {\n            setDailyResetSaving(false);\n        }\n    };\n\n    const updateItemRate = (id: string, newRate: MarketRate) => {\n        setItems(prev => prev.map(item => item.id === id ? { ...item, rate: newRate } : item));\n    };\n\n    const save = async () => {\n        if (!selectedItem) return;\n        if (locked) {\n            setError('Active session detected ‚Äî end it before changing this rate.');\n            return;\n        }\n        setSaving(true);\n        setError(null);\n        setSaveMessage(null);\n        try {\n            await api.market.upsert(selectedItem.rate);\n            setSaveMessage('Saved to market');\n            await loadData();\n            setSelectedId(selectedItem.id);\n        } catch (err) {\n            setError((err as Error).message);\n        } finally {\n            setSaving(false);\n        }\n    };\n\n    const handleAddProfile = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newDomain.trim()) return;\n\n        const domain = newDomain.trim();\n        // Check if already exists\n        if (items.find(i => i.id === domain)) {\n            setError('Profile already exists');\n            return;\n        }\n\n        const newRate: MarketRate = {\n            domain,\n            ratePerMin: 3,\n            packs: [],\n            hourlyModifiers: Array(24).fill(1)\n        };\n\n        await api.market.upsert(newRate);\n        await loadData();\n        setNewDomain('');\n        setIsAdding(false);\n        setSelectedId(domain);\n        setActiveTab('frivolity'); // Switch to frivolity as that's where new items go\n    };\n\n    const title = useMemo(() => activeTab === 'productive' ? 'Earn profiles' : 'Spend profiles', [activeTab]);\n    const subtitle = useMemo(() => activeTab === 'productive'\n        ? 'Tune how productive apps reward you over the day.'\n        : 'Shape how costly domains evolve over the day.', [activeTab]);\n\n    const metrics = useMemo(() => {\n        if (!selectedItem) return [];\n        const modifiers = selectedItem.rate.hourlyModifiers;\n        const maxMod = Math.max(...modifiers);\n        const minMod = Math.min(...modifiers);\n        return [\n            { label: 'Base rate', value: `${selectedItem.rate.ratePerMin} f-coins/min` },\n            { label: 'Peak multiplier', value: `${maxMod.toFixed(1)}x` },\n            { label: 'Off-peak', value: `${minMod.toFixed(1)}x` }\n        ];\n    }, [selectedItem]);\n\n    const isEarnProfile = selectedItem?.type === 'productive';\n\n    function median(values: number[]) {\n        const nums = values.filter((n) => typeof n === 'number' && Number.isFinite(n));\n        if (!nums.length) return null;\n        const sorted = [...nums].sort((a, b) => a - b);\n        const mid = Math.floor(sorted.length / 2);\n        if (sorted.length % 2 === 0) {\n            return (sorted[mid - 1] + sorted[mid]) / 2;\n        }\n        return sorted[mid];\n    }\n\n    function roundRate(value: number) {\n        const n = Number(value);\n        if (!Number.isFinite(n)) return 0;\n        return Math.round(n * 100) / 100;\n    }\n\n    const typicalEarn = useMemo(() => {\n        return median(items.filter((it) => it.type === 'productive').map((it) => it.rate.ratePerMin)) ?? 5;\n    }, [items]);\n\n    const typicalSpend = useMemo(() => {\n        return median(items.filter((it) => it.type === 'frivolity').map((it) => it.rate.ratePerMin)) ?? 3;\n    }, [items]);\n\n    const currentExchange = useMemo(() => {\n        if (!typicalSpend || typicalSpend <= 0) return 0;\n        return typicalEarn / typicalSpend;\n    }, [typicalEarn, typicalSpend]);\n\n    const effectiveTarget = exchangeTarget ?? currentExchange;\n    const spendMultiplier = useMemo(() => {\n        const target = typeof effectiveTarget === 'number' && Number.isFinite(effectiveTarget) ? effectiveTarget : 1;\n        if (!typicalSpend || typicalSpend <= 0) return 1;\n        if (!typicalEarn || typicalEarn <= 0) return 1;\n        if (target <= 0) return 1;\n        return typicalEarn / (typicalSpend * target);\n    }, [effectiveTarget, typicalEarn, typicalSpend]);\n\n    const applyExchangeToSpendProfiles = async () => {\n        if (exchangeApplying) return;\n        const target = typeof effectiveTarget === 'number' && Number.isFinite(effectiveTarget) ? effectiveTarget : null;\n        if (!target || target <= 0) return;\n\n        setExchangeApplying(true);\n        setError(null);\n        try {\n            const spendProfiles = items.filter((it) => it.type === 'frivolity');\n            const lockedDomains = spendProfiles.filter((it) => Boolean(activeSessions[it.id])).map((it) => it.id);\n            const editable = spendProfiles.filter((it) => !activeSessions[it.id]);\n\n            if (!editable.length) {\n                setExchangeMessage('All spend profiles are locked by active sessions.');\n                return;\n            }\n\n            await api.settings.updateEconomyExchangeRate(target);\n            let updated = 0;\n            for (const item of editable) {\n                const next: MarketRate = {\n                    ...item.rate,\n                    ratePerMin: roundRate(item.rate.ratePerMin * spendMultiplier),\n                    packs: item.rate.packs.map((pack) => ({\n                        ...pack,\n                        price: Math.max(1, Math.round(pack.price * spendMultiplier))\n                    }))\n                };\n                await api.market.upsert(next);\n                updated += 1;\n            }\n\n            await loadData();\n            setExchangeMessage(\n                lockedDomains.length\n                    ? `Scaled ${updated} spend profiles. Skipped ${lockedDomains.length} locked by active sessions.`\n                    : `Scaled ${updated} spend profiles.`\n            );\n        } catch (err) {\n            setError((err as Error).message);\n        } finally {\n            setExchangeApplying(false);\n        }\n    };\n\n    return (\n        <section className=\"panel tuner-panel\">\n            <header className=\"panel-header tuner-header-row\">\n                <div>\n                    <p className=\"eyebrow\">Economy</p>\n                    <h1>{title}</h1>\n                    <p className=\"subtle\">{subtitle}</p>\n                </div>\n                <div className=\"toggle-wrap\">\n                    <span className=\"subtle\">Productive</span>\n                    <label className=\"ios-switch\">\n                        <input\n                            type=\"checkbox\"\n                            checked={activeTab === 'frivolity'}\n                            onChange={(e) => setActiveTab(e.target.checked ? 'frivolity' : 'productive')}\n                        />\n                        <span className=\"slider\" />\n                    </label>\n                    <span className=\"subtle\">Frivolous</span>\n                </div>\n            </header>\n\n            {saveMessage && (\n                <div className=\"inline-note\" style={{ maxWidth: '420px' }}>\n                    {saveMessage}\n                </div>\n            )}\n\n            {exchangeMessage && (\n                <div className=\"inline-note\" style={{ maxWidth: '520px' }}>\n                    {exchangeMessage}\n                </div>\n            )}\n\n            <section className=\"card\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: 16, flexWrap: 'wrap' }}>\n                <div>\n                    <h2 style={{ margin: 0 }}>Daily coin reset</h2>\n                    <p className=\"subtle\" style={{ margin: 0 }}>\n                        Start each day at 0 f-coins so frivolity must be re-earned today.\n                    </p>\n                </div>\n                <label className=\"settings-inline\" style={{ margin: 0 }}>\n                    <input\n                        type=\"checkbox\"\n                        checked={dailyResetEnabled}\n                        onChange={(e) => toggleDailyReset(e.target.checked)}\n                        disabled={dailyResetSaving}\n                    />\n                    <span className=\"subtle\">{dailyResetEnabled ? 'Enabled' : 'Disabled'}</span>\n                </label>\n            </section>\n\n            <section className=\"card economy-exchange-card\">\n                <div className=\"economy-exchange-header\">\n                    <div>\n                        <h2 style={{ margin: 0 }}>Exchange rate</h2>\n                        <p className=\"subtle\" style={{ marginBottom: 0 }}>\n                            Make the system feel intuitive: how much ‚Äúfrivolity time‚Äù 1 minute of productive time buys.\n                        </p>\n                    </div>\n                    <button className=\"primary\" onClick={applyExchangeToSpendProfiles} disabled={exchangeApplying || !effectiveTarget || effectiveTarget <= 0}>\n                        {exchangeApplying ? 'Applying‚Ä¶' : 'Apply to spend profiles'}\n                    </button>\n                </div>\n\n                <div className=\"economy-exchange-grid\">\n                    <div className=\"economy-exchange-metric\">\n                        <span className=\"subtle\">Current (typical)</span>\n                        <strong>1 min work ‚Üí {currentExchange ? currentExchange.toFixed(2) : '‚Äî'} min frivolity</strong>\n                    </div>\n                    <div className=\"economy-exchange-metric\">\n                        <span className=\"subtle\">Target</span>\n                        <strong>1 min work ‚Üí {effectiveTarget ? effectiveTarget.toFixed(2) : '‚Äî'} min frivolity</strong>\n                    </div>\n                    <div className=\"economy-exchange-metric\">\n                        <span className=\"subtle\">Effect</span>\n                        <strong>{spendMultiplier ? `${spendMultiplier.toFixed(2)}√ó` : '‚Äî'} spend costs</strong>\n                    </div>\n                </div>\n\n                <div className=\"economy-exchange-controls\">\n                    <div className=\"economy-exchange-presets\">\n                        <button type=\"button\" className=\"ghost\" onClick={() => setExchangeTarget(0.5)} disabled={exchangeApplying}>\n                            0.5√ó\n                        </button>\n                        <button type=\"button\" className=\"ghost\" onClick={() => setExchangeTarget(1)} disabled={exchangeApplying}>\n                            1√ó (1:1)\n                        </button>\n                        <button type=\"button\" className=\"ghost\" onClick={() => setExchangeTarget(2)} disabled={exchangeApplying}>\n                            2√ó\n                        </button>\n                        <button type=\"button\" className=\"ghost\" onClick={() => setExchangeTarget(currentExchange)} disabled={exchangeApplying || !currentExchange}>\n                            Reset\n                        </button>\n                    </div>\n                    <label style={{ display: 'grid', gap: 8, margin: 0 }}>\n                        <span className=\"subtle\">Minutes of frivolity per minute of work</span>\n                        <input\n                            type=\"range\"\n                            min={0.25}\n                            max={4}\n                            step={0.05}\n                            value={effectiveTarget ? effectiveTarget : 1}\n                            onChange={(e) => setExchangeTarget(Number(e.target.value))}\n                            disabled={exchangeApplying}\n                        />\n                    </label>\n                </div>\n\n                <p className=\"subtle\" style={{ marginBottom: 0 }}>\n                    This scales all <strong>spend</strong> profiles (frivolity domains) while keeping your individual profile shapes and pack options.\n                    Use ‚ÄúAdvanced‚Äù below if you want domain-specific tuning.\n                </p>\n            </section>\n\n            <details className=\"card economy-advanced\" open={false}>\n                <summary className=\"economy-advanced-summary\">\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n                        <strong>Advanced: per-domain tuning</strong>\n                        <span className=\"subtle\">Power-user controls for rates, curves, and packs.</span>\n                    </div>\n                    <span className=\"economy-advanced-toggle\" aria-hidden=\"true\" />\n                </summary>\n                <div className=\"economy-advanced-body\">\n                    <div className=\"tuner-layout\">\n                <aside className=\"tuner-list\">\n                    <div style={{ padding: '0 4px 8px 4px', borderBottom: '1px solid rgba(255,255,255,0.05)', marginBottom: '8px' }}>\n                        {!isAdding ? (\n                            <button className=\"ghost\" style={{ width: '100%', textAlign: 'center', fontSize: '13px' }} onClick={() => setIsAdding(true)}>\n                                + Add Profile\n                            </button>\n                        ) : (\n                            <form onSubmit={handleAddProfile} style={{ display: 'flex', gap: '6px' }}>\n                                <input\n                                    autoFocus\n                                    placeholder=\"domain.com\"\n                                    value={newDomain}\n                                    onChange={e => setNewDomain(e.target.value)}\n                                    style={{ flex: 1, minWidth: 0, padding: '6px 8px', fontSize: '13px', background: 'rgba(0,0,0,0.2)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '6px', color: 'white' }}\n                                />\n                                <button type=\"submit\" className=\"primary\" style={{ padding: '6px 10px', fontSize: '13px' }}>Add</button>\n                                <button type=\"button\" className=\"ghost\" style={{ padding: '6px', fontSize: '13px' }} onClick={() => setIsAdding(false)}>‚úï</button>\n                            </form>\n                        )}\n                    </div>\n\n                    {filteredItems.map(item => (\n                        <button\n                            key={item.id}\n                            className={`tuner-list-item ${selectedId === item.id ? 'active' : ''}`}\n                            onClick={() => setSelectedId(item.id)}\n                        >\n                            <div className=\"tuner-list-title\">{item.id}</div>\n                            <div className=\"tuner-list-sub\">{item.rate.ratePerMin} f-coins/min ‚Ä¢ {item.type}</div>\n                        </button>\n                    ))}\n                    {filteredItems.length === 0 && (\n                        <div className=\"subtle\" style={{ padding: '12px' }}>No items in this category.</div>\n                    )}\n                </aside>\n\n                <div className=\"tuner-editor\">\n                    {selectedItem ? (\n                        <div className=\"tuner-grid\">\n                            <div className=\"card tuner-primary\">\n                                <div className=\"tuner-header\">\n                                    <div>\n                                        <h2>{selectedItem.id}</h2>\n                                        <p className=\"subtle\">{selectedItem.type === 'productive' ? 'Earn profile' : 'Spend profile'}</p>\n                                    </div>\n                                    <button className=\"primary\" onClick={save} disabled={saving || locked}>\n                                        {locked ? 'Locked by active session' : saving ? 'Saving...' : 'Save changes'}\n                                    </button>\n                                    <button\n                                        className=\"ghost danger\"\n                                        disabled={locked}\n                                        onClick={async () => {\n                                            if (!selectedItem) return;\n                                            if (!confirm(`Delete profile for ${selectedItem.id}?`)) return;\n                                            await api.market.delete(selectedItem.id);\n                                            await loadData();\n                                            setSelectedId(null);\n                                        }}\n                                    >\n                                        Delete\n                                    </button>\n                                </div>\n                                {locked && (\n                                    <div className=\"inline-note danger\" style={{ marginBottom: '8px' }}>\n                                        Active session running for this domain ‚Äî end it to adjust the exchange rate.\n                                    </div>\n                                )}\n                                {error && (\n                                    <div className=\"inline-note warning\" style={{ marginBottom: '8px' }}>\n                                        {error}\n                                    </div>\n                                )}\n\n                                {metrics.length > 0 && (\n                                    <div className=\"tuner-metrics\">\n                                        {metrics.map((metric) => (\n                                            <div key={metric.label} className=\"metric-card\">\n                                                <span className=\"metric-label\">{metric.label}</span>\n                                                <strong className=\"metric-value\">{metric.value}</strong>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n\n                                <div className=\"form-group\">\n                                    <label>Base rate (per minute)</label>\n                                    <input\n                                        type=\"number\"\n                                        value={selectedItem.rate.ratePerMin}\n                                        onChange={(e) => handleRateChange(Number(e.target.value))}\n                                        step=\"0.1\"\n                                        min=\"0.1\"\n                                        max=\"100\"\n                                        disabled={locked}\n                                    />\n                                    <p className=\"subtle\">\n                                        {selectedItem.type === 'productive' ? 'f-coins earned per minute.' : 'f-coins spent per minute when metered.'}\n                                    </p>\n                                </div>\n\n                                <div className=\"form-group\">\n                                    <label>Time multiplier curve</label>\n                                    <p className=\"subtle\">\n                                        Adjust how the value changes throughout the day. 1x is standard.\n                                    </p>\n                                    <CurveEditor\n                                        values={selectedItem.rate.hourlyModifiers}\n                                        onChange={handleCurveChange}\n                                        color={selectedItem.type === 'productive' ? 'var(--cat-productive)' : 'var(--cat-frivolity)'}\n                                        disabled={locked}\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"card tuner-secondary\">\n                                <div className=\"tuner-header\">\n                                    <div>\n                                        <h3>{isEarnProfile ? 'Earnings preview' : 'Packs preview'}</h3>\n                                        <p className=\"subtle\">\n                                            {isEarnProfile\n                                                ? 'How this profile‚Äôs rate and curve would surface in payout views.'\n                                                : 'Show what users see when buying time.'}\n                                        </p>\n                                    </div>\n                                </div>\n                                <div className=\"packs-preview\">\n                                    {selectedItem.rate.packs.length === 0 && (\n                                        <p className=\"subtle\">\n                                            {isEarnProfile\n                                                ? 'No packs defined ‚Äî optional for earn profiles.'\n                                                : 'No packs defined ‚Äî consider adding 10/30/60 minute options.'}\n                                        </p>\n                                    )}\n                                    {selectedItem.rate.packs.map((pack, idx) => (\n                                        <div key={pack.minutes} className=\"pack-card\">\n                                            <div>\n                                                <strong>{pack.minutes} minute session</strong>\n                                                <p className=\"subtle\">{pack.price} f-coins ‚Ä¢ {((pack.price / pack.minutes) * 60).toFixed(1)} f-coins/hour</p>\n                                            </div>\n                                            <button\n                                                className=\"ghost danger\"\n                                                disabled={locked}\n                                                onClick={() => {\n                                                    const newPacks = [...selectedItem.rate.packs];\n                                                    newPacks.splice(idx, 1);\n                                                    updateItemRate(selectedItem.id, { ...selectedItem.rate, packs: newPacks });\n                                                }}\n                                            >\n                                                Remove\n                                            </button>\n                                        </div>\n                                    ))}\n                                    {!isEarnProfile && (\n                                        <div style={{ marginTop: '8px' }}>\n                                            {isAddingPack ? (\n                                                <div style={{ display: 'flex', gap: '8px', alignItems: 'center', flexWrap: 'wrap' }}>\n                                                    <input\n                                                        type=\"number\"\n                                                        placeholder=\"Minutes\"\n                                                        value={newPackMinutes}\n                                                        onChange={(e) => setNewPackMinutes(Number(e.target.value))}\n                                                        min=\"5\"\n                                                        max=\"120\"\n                                                        style={{ width: '80px' }}\n                                                    />\n                                                    <input\n                                                        type=\"number\"\n                                                        placeholder=\"Price\"\n                                                        value={newPackPrice}\n                                                        onChange={(e) => setNewPackPrice(Number(e.target.value))}\n                                                        min=\"1\"\n                                                        max=\"500\"\n                                                        style={{ width: '80px' }}\n                                                    />\n                                                    <button\n                                                        className=\"primary\"\n                                                        disabled={locked}\n                                                        onClick={() => {\n                                                            const newPacks = [...selectedItem.rate.packs, { minutes: newPackMinutes, price: newPackPrice }];\n                                                            updateItemRate(selectedItem.id, { ...selectedItem.rate, packs: newPacks });\n                                                            setIsAddingPack(false);\n                                                            setNewPackMinutes(10);\n                                                            setNewPackPrice(8);\n                                                        }}\n                                                    >\n                                                        Add\n                                                    </button>\n                                                    <button className=\"ghost\" onClick={() => setIsAddingPack(false)}>Cancel</button>\n                                                </div>\n                                            ) : (\n                                                <button className=\"ghost\" disabled={locked} onClick={() => setIsAddingPack(true)}>\n                                                    + Add pack\n                                                </button>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    ) : (\n                        <div className=\"empty-state\">Select an item to tune</div>\n                    )}\n                </div>\n            </div>\n                </div>\n            </details>\n        </section>\n    );\n}\n","import { useEffect, useMemo, useState, type FormEvent } from 'react';\nimport type {\n  CameraPhoto,\n  EmergencyPolicyId,\n  GuardrailColorFilter,\n  JournalConfig,\n  PeekConfig,\n  RendererApi,\n  SyncDevice,\n  SyncStatus,\n  ZoteroCollection,\n  ZoteroIntegrationConfig,\n  ZoteroIntegrationMode\n} from '@shared/types';\nimport Domains from './Domains';\nimport EconomyTuner from './EconomyTuner';\n\ninterface SettingsProps {\n  api: RendererApi;\n  theme: 'lavender' | 'olive';\n  onThemeChange(theme: 'lavender' | 'olive'): void;\n}\n\nconst SETTINGS_PANES = [\n  {\n    id: 'sync',\n    label: 'Sync & Profile',\n    description: 'Devices, cloud sync, and identity.'\n  },\n  {\n    id: 'activity',\n    label: 'Activity',\n    description: 'Idle thresholds and continuity rules.'\n  },\n  {\n    id: 'paywall',\n    label: 'Paywall & Rituals',\n    description: 'Emergency access, peek, and journaling.'\n  },\n  {\n    id: 'integrations',\n    label: 'Integrations',\n    description: 'Bring in external libraries.'\n  },\n  {\n    id: 'domains',\n    label: 'Domains',\n    description: 'Productive vs neutral vs frivolous.'\n  },\n  {\n    id: 'economy',\n    label: 'Economy',\n    description: 'Tune earn + spend profiles.'\n  },\n  {\n    id: 'system',\n    label: 'System',\n    description: 'Reset data and permissions.'\n  }\n] as const;\n\ntype SettingsPaneId = typeof SETTINGS_PANES[number]['id'];\n\nexport default function Settings({ api, theme, onThemeChange }: SettingsProps) {\n  const [saving, setSaving] = useState(false);\n  const [saved, setSaved] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [activePane, setActivePane] = useState<SettingsPaneId>('sync');\n\n  const [idleThreshold, setIdleThreshold] = useState(15);\n  const [frivolousIdleThreshold, setFrivolousIdleThreshold] = useState(15);\n  const [emergencyPolicy, setEmergencyPolicy] = useState<EmergencyPolicyId>('balanced');\n  const [emergencyReminderInterval, setEmergencyReminderInterval] = useState(300);\n  const [journalUrl, setJournalUrl] = useState('');\n  const [journalMinutes, setJournalMinutes] = useState(10);\n  const [peekEnabled, setPeekEnabled] = useState(true);\n  const [peekAllowNewPages, setPeekAllowNewPages] = useState(false);\n  const [continuityWindowSeconds, setContinuityWindowSeconds] = useState(120);\n  const [excludedKeywordsText, setExcludedKeywordsText] = useState('');\n  const [productivityGoalHours, setProductivityGoalHours] = useState(2);\n  const [syncStatus, setSyncStatus] = useState<SyncStatus | null>(null);\n  const [syncDevices, setSyncDevices] = useState<SyncDevice[]>([]);\n  const [deviceName, setDeviceName] = useState('');\n  const [handle, setHandle] = useState('');\n  const [profileColor, setProfileColor] = useState('#7cf4d4');\n  const [syncBusy, setSyncBusy] = useState(false);\n\n  const [zoteroConfig, setZoteroConfig] = useState<ZoteroIntegrationConfig>({\n    mode: 'recent',\n    collectionId: null,\n    includeSubcollections: true\n  });\n  const [zoteroCollections, setZoteroCollections] = useState<ZoteroCollection[]>([]);\n  const [zoteroCollectionsLoading, setZoteroCollectionsLoading] = useState(false);\n  const [resetScope, setResetScope] = useState<'trophies' | 'wallet' | 'all'>('trophies');\n  const [resetBusy, setResetBusy] = useState(false);\n  const [resetMessage, setResetMessage] = useState<string | null>(null);\n  const [cameraModeEnabled, setCameraModeEnabled] = useState(false);\n  const [guardrailColorFilter, setGuardrailColorFilter] = useState<GuardrailColorFilter>('full-color');\n  const [alwaysGreyscale, setAlwaysGreyscale] = useState(false);\n  const [cameraPhotos, setCameraPhotos] = useState<CameraPhoto[]>([]);\n  const [cameraLoading, setCameraLoading] = useState(false);\n  const [cameraError, setCameraError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!resetMessage) return;\n    const timer = window.setTimeout(() => setResetMessage(null), 5000);\n    return () => window.clearTimeout(timer);\n  }, [resetMessage]);\n\n  useEffect(() => {\n    api.settings.idleThreshold().then(setIdleThreshold);\n    api.settings.frivolousIdleThreshold().then(setFrivolousIdleThreshold);\n    api.settings.emergencyPolicy().then(setEmergencyPolicy);\n    api.settings.emergencyReminderInterval().then(setEmergencyReminderInterval);\n    api.settings.journalConfig().then((cfg: JournalConfig) => {\n      setJournalUrl(cfg.url ?? '');\n      setJournalMinutes(cfg.minutes ?? 10);\n    }).catch(() => { });\n    api.settings.peekConfig().then((cfg: PeekConfig) => {\n      setPeekEnabled(cfg.enabled);\n      setPeekAllowNewPages(cfg.allowOnNewPages);\n    }).catch(() => { });\n    api.settings.continuityWindowSeconds().then(setContinuityWindowSeconds).catch(() => { });\n    api.settings.productivityGoalHours().then(setProductivityGoalHours).catch(() => { });\n    api.settings.excludedKeywords().then((keywords) => {\n      setExcludedKeywordsText((keywords ?? []).join('\\n'));\n    }).catch(() => { });\n    api.settings.cameraModeEnabled().then(setCameraModeEnabled).catch(() => { });\n    api.settings.guardrailColorFilter().then(setGuardrailColorFilter).catch(() => { });\n    api.settings.alwaysGreyscale().then(setAlwaysGreyscale).catch(() => { });\n    api.integrations.zotero.config().then(setZoteroConfig).catch(() => { });\n  }, [api.settings, api.integrations.zotero]);\n\n  const refreshCameraPhotos = async () => {\n    setCameraLoading(true);\n    setCameraError(null);\n    try {\n      const photos = await api.camera.listPhotos(120);\n      setCameraPhotos(photos);\n    } catch (err) {\n      console.error('Failed to load camera photos', err);\n      setCameraError('Failed to load camera photos.');\n    } finally {\n      setCameraLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    refreshCameraPhotos();\n  }, []);\n\n  const requestCameraPermission = async () => {\n    if (!navigator.mediaDevices?.getUserMedia) {\n      throw new Error('Camera capture is not supported in this environment.');\n    }\n    let stream: MediaStream | null = null;\n    try {\n      stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });\n    } finally {\n      stream?.getTracks().forEach((track) => track.stop());\n    }\n  };\n\n  const handleCameraModeToggle = async (enabled: boolean) => {\n    setCameraError(null);\n    if (enabled) {\n      try {\n        await requestCameraPermission();\n      } catch (err) {\n        console.error('Camera permission request failed', err);\n        setCameraError('Camera access is blocked. Enable TimeWellSpent in macOS System Settings ‚Üí Privacy & Security ‚Üí Camera, then try again.');\n        setCameraModeEnabled(false);\n        return;\n      }\n    }\n    setCameraModeEnabled(enabled);\n  };\n\n  const refreshSync = async () => {\n    try {\n      const status = await api.sync.status();\n      setSyncStatus(status);\n      setDeviceName(status.device?.name ?? '');\n      if (status.configured && status.authenticated) {\n        const profile = await api.friends.profile();\n        setHandle(profile?.handle ?? '');\n        setProfileColor(profile?.color ?? '#7cf4d4');\n        const devices = await api.sync.listDevices();\n        setSyncDevices(devices);\n      } else {\n        setSyncDevices([]);\n      }\n    } catch (err) {\n      console.error('Failed to load sync status', err);\n    }\n  };\n\n  useEffect(() => {\n    refreshSync();\n  }, []);\n\n  const selectedZoteroCollection = useMemo(() => {\n    if (zoteroConfig.collectionId == null) return null;\n    return zoteroCollections.find((c) => c.id === zoteroConfig.collectionId) ?? null;\n  }, [zoteroCollections, zoteroConfig.collectionId]);\n\n  async function refreshZoteroCollections() {\n    setZoteroCollectionsLoading(true);\n    try {\n      const cols = await api.integrations.zotero.collections();\n      setZoteroCollections(cols);\n    } catch (err) {\n      console.error('Failed to load Zotero collections', err);\n      setError('Failed to load Zotero collections. Is Zotero installed and opened at least once?');\n    } finally {\n      setZoteroCollectionsLoading(false);\n    }\n  }\n\n  async function save(event?: FormEvent) {\n    event?.preventDefault();\n    setSaving(true);\n    setSaved(false);\n    setError(null);\n    try {\n      await api.settings.updateIdleThreshold(idleThreshold);\n      await api.settings.updateFrivolousIdleThreshold(frivolousIdleThreshold);\n      const keywords = excludedKeywordsText\n        .split(/[\\n,]+/)\n        .map((entry) => entry.trim().toLowerCase())\n        .filter(Boolean);\n      await api.settings.updateExcludedKeywords(keywords);\n      setExcludedKeywordsText(keywords.join('\\n'));\n      await api.settings.updateEmergencyPolicy(emergencyPolicy);\n      await api.settings.updateEmergencyReminderInterval(emergencyReminderInterval);\n      await api.settings.updateJournalConfig({ url: journalUrl.trim() ? journalUrl.trim() : null, minutes: journalMinutes });\n      await api.settings.updatePeekConfig({ enabled: peekEnabled, allowOnNewPages: peekAllowNewPages });\n      await api.settings.updateContinuityWindowSeconds(continuityWindowSeconds);\n      await api.settings.updateProductivityGoalHours(productivityGoalHours);\n      await api.settings.updateCameraModeEnabled(cameraModeEnabled);\n      await api.settings.updateGuardrailColorFilter(guardrailColorFilter);\n      await api.settings.updateAlwaysGreyscale(alwaysGreyscale);\n      await api.integrations.zotero.updateConfig(zoteroConfig);\n      setSaved(true);\n      window.setTimeout(() => setSaved(false), 2000);\n    } catch (err) {\n      setError((err as Error).message || 'Failed to save settings');\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  async function handleReset() {\n    if (resetBusy) return;\n    setResetMessage(null);\n    const warnings: Record<'trophies' | 'wallet' | 'all', string> = {\n      trophies: 'This will clear all earned trophies, pinned trophies, and personal bests.',\n      wallet: 'This will zero your bank balance and erase wallet transactions.',\n      all: 'This will clear trophies, activity history, wallet, library, and sync state. This cannot be undone.'\n    };\n    if (!window.confirm(`${warnings[resetScope]}\\n\\nContinue?`)) return;\n    if (resetScope === 'all' && !window.confirm('Final check: erase all local/cloud stats now?')) return;\n\n    setResetBusy(true);\n    setError(null);\n    try {\n      await api.system.reset(resetScope);\n      const messages: Record<'trophies' | 'wallet' | 'all', string> = {\n        trophies: 'Trophy case reset locally and in sync.',\n        wallet: 'Bank reset locally and in sync.',\n        all: 'All stats reset locally and in sync.'\n      };\n      setResetMessage(messages[resetScope]);\n      await refreshSync();\n    } catch (err) {\n      setError((err as Error).message || 'Failed to reset');\n    } finally {\n      setResetBusy(false);\n    }\n  }\n\n  const handleCameraReveal = async (id: string) => {\n    try {\n      await api.camera.revealPhoto(id);\n    } catch (err) {\n      console.error('Failed to reveal camera photo', err);\n      setCameraError('Failed to reveal camera photo.');\n    }\n  };\n\n  const handleCameraDelete = async (id: string) => {\n    if (!window.confirm('Delete this photo?')) return;\n    try {\n      await api.camera.deletePhoto(id);\n      setCameraPhotos((prev) => prev.filter((photo) => photo.id !== id));\n    } catch (err) {\n      console.error('Failed to delete camera photo', err);\n      setCameraError('Failed to delete camera photo.');\n    }\n  };\n\n  const activePaneConfig = SETTINGS_PANES.find((pane) => pane.id === activePane) ?? SETTINGS_PANES[0];\n  const activePaneIndex = Math.max(0, SETTINGS_PANES.findIndex((pane) => pane.id === activePane)) + 1;\n  const showPaneHeader = activePane !== 'domains' && activePane !== 'economy';\n\n  return (\n    <section className=\"panel\">\n      <header className=\"panel-header\">\n        <div>\n          <h1>Settings</h1>\n          <p className=\"subtle\">Tune policies, domains, economy, and sync.</p>\n        </div>\n      </header>\n\n      {error && <p className=\"error-text\">{error}</p>}\n\n      <div className=\"settings-layout\">\n        <nav className=\"settings-nav\" aria-label=\"Settings sections\">\n          {SETTINGS_PANES.map((pane) => (\n            <button\n              key={pane.id}\n              type=\"button\"\n              className={activePane === pane.id ? 'active' : ''}\n              onClick={() => setActivePane(pane.id)}\n              aria-current={activePane === pane.id ? 'page' : undefined}\n            >\n              <span className=\"settings-nav-label\">{pane.label}</span>\n              <span className=\"settings-nav-desc\">{pane.description}</span>\n            </button>\n          ))}\n        </nav>\n\n        <div className=\"settings-pane\">\n          {showPaneHeader && (\n            <div className=\"settings-pane-header\">\n              <div>\n                <h2>{activePaneConfig.label}</h2>\n                <p className=\"subtle\">{activePaneConfig.description}</p>\n              </div>\n              <span className=\"pill ghost\">Section {activePaneIndex} of {SETTINGS_PANES.length}</span>\n            </div>\n          )}\n\n          {activePane === 'sync' && (\n            <div className=\"settings-pane-body\">\n              <div className=\"card settings-section\">\n                <div className=\"card-header-row\">\n                  <div>\n                    <h2>Cloud sync</h2>\n                    <p className=\"subtle\" style={{ margin: 0 }}>Keep wallet, library, and summaries aligned across devices.</p>\n                  </div>\n                  <button type=\"button\" className=\"ghost\" onClick={refreshSync} disabled={syncBusy}>\n                    Refresh\n                  </button>\n                </div>\n\n                {!syncStatus?.configured && (\n                  <p className=\"subtle\">\n                    Supabase not configured. Add `SUPABASE_URL` and `SUPABASE_ANON_KEY`, then restart the app.\n                  </p>\n                )}\n\n                {syncStatus?.configured && !syncStatus.authenticated && (\n                  <div className=\"settings-actions\">\n                    <button\n                      type=\"button\"\n                      className=\"primary\"\n                      onClick={async () => {\n                        setSyncBusy(true);\n                        await api.sync.signIn('google');\n                        setSyncBusy(false);\n                      }}\n                      disabled={syncBusy}\n                    >\n                      Connect with Google\n                    </button>\n                    <button\n                      type=\"button\"\n                      className=\"secondary\"\n                      onClick={async () => {\n                        setSyncBusy(true);\n                        await api.sync.signIn('github');\n                        setSyncBusy(false);\n                      }}\n                      disabled={syncBusy}\n                    >\n                      Connect with GitHub\n                    </button>\n                  </div>\n                )}\n\n                {syncStatus?.configured && syncStatus.authenticated && (\n                  <div className=\"settings-stack\">\n                    <div className=\"settings-pills\">\n                      <span className=\"pill ghost\">{syncStatus.user?.email ?? syncStatus.user?.id}</span>\n                      <span className=\"pill ghost\">Device {syncStatus.device?.id?.slice(0, 8)}</span>\n                      {syncStatus.lastSyncAt && <span className=\"pill ghost\">Last sync {new Date(syncStatus.lastSyncAt).toLocaleString()}</span>}\n                    </div>\n                    <div className=\"settings-row\">\n                      <label>\n                        Device name\n                        <input\n                          type=\"text\"\n                          value={deviceName}\n                          onChange={(e) => setDeviceName(e.target.value)}\n                          placeholder=\"My MacBook\"\n                        />\n                      </label>\n                      <label>\n                        Handle\n                        <input\n                          type=\"text\"\n                          value={handle}\n                          onChange={(e) => setHandle(e.target.value)}\n                          placeholder=\"your_handle\"\n                        />\n                      </label>\n                      <label>\n                        Accent color\n                        <input\n                          type=\"color\"\n                          value={profileColor}\n                          onChange={(e) => setProfileColor(e.target.value)}\n                        />\n                      </label>\n                    </div>\n                    <div className=\"settings-actions\">\n                      <button\n                        type=\"button\"\n                        className=\"primary\"\n                        onClick={async () => {\n                          setSyncBusy(true);\n                          setError(null);\n                          try {\n                            await api.sync.setDeviceName(deviceName);\n                            await api.friends.updateProfile({ handle: handle.trim() || undefined, color: profileColor });\n                            await api.sync.syncNow();\n                            await refreshSync();\n                          } catch (err) {\n                            setError((err as Error).message || 'Failed to sync now');\n                          } finally {\n                            setSyncBusy(false);\n                          }\n                        }}\n                        disabled={syncBusy}\n                      >\n                        Sync now\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"secondary\"\n                        onClick={async () => {\n                          setSyncBusy(true);\n                          await api.sync.signOut();\n                          await refreshSync();\n                          setSyncBusy(false);\n                        }}\n                        disabled={syncBusy}\n                      >\n                        Sign out\n                      </button>\n                    </div>\n\n                    {syncDevices.length > 0 && (\n                      <div className=\"devices-list\">\n                        {syncDevices.map((device) => (\n                          <div key={device.id} className={`device-row ${device.isCurrent ? 'current' : ''}`}>\n                            <div>\n                              <strong>{device.name}</strong>\n                              <span className=\"subtle\">{device.platform}</span>\n                            </div>\n                            <span className=\"subtle\">\n                              {device.lastSeenAt ? `Seen ${new Date(device.lastSeenAt).toLocaleString()}` : 'Pending'}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {activePane === 'activity' && (\n            <form className=\"settings-pane-form\" onSubmit={save}>\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Activity detection</h3>\n                  <p className=\"subtle\">Tune idle detection.</p>\n                </div>\n                <div className=\"settings-row\">\n                  <label>\n                    Idle threshold (seconds)\n                    <input\n                      type=\"number\"\n                      min=\"5\"\n                      max=\"300\"\n                      value={idleThreshold}\n                      onChange={(e) => setIdleThreshold(Number(e.target.value))}\n                    />\n                  </label>\n                  <label>\n                    Frivolous idle (seconds)\n                    <input\n                      type=\"number\"\n                      min=\"5\"\n                      max=\"300\"\n                      value={frivolousIdleThreshold}\n                      onChange={(e) => setFrivolousIdleThreshold(Number(e.target.value))}\n                    />\n                  </label>\n                  <label>\n                    Continuity window (seconds)\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      max=\"900\"\n                      value={continuityWindowSeconds}\n                      onChange={(e) => setContinuityWindowSeconds(Number(e.target.value))}\n                    />\n                  </label>\n                </div>\n                <div className=\"settings-row\">\n                  <label>\n                    Daily productivity goal (hours)\n                    <input\n                      type=\"number\"\n                      min=\"0.5\"\n                      max=\"12\"\n                      step=\"0.1\"\n                      value={productivityGoalHours}\n                      onChange={(e) => setProductivityGoalHours(Number(e.target.value))}\n                    />\n                  </label>\n                </div>\n                <label>\n                  Keywords to exclude\n                  <textarea\n                    rows={3}\n                    value={excludedKeywordsText}\n                    onChange={(e) => setExcludedKeywordsText(e.target.value)}\n                    placeholder=\"One keyword per line\"\n                  />\n                </label>\n                <p className=\"subtle\" style={{ margin: 0 }}>Lower values mark passive browsing as idle sooner.</p>\n                <p className=\"subtle\" style={{ margin: 0 }}>Excluded keywords stay neutral and are hidden from stream trackers.</p>\n                <p className=\"subtle\" style={{ margin: 0 }}>Continuity keeps short research hops in the same productive run.</p>\n                <p className=\"subtle\" style={{ margin: 0 }}>Daily productivity goal powers the dashboard ring.</p>\n              </div>\n              <div className=\"settings-actions\">\n                <button className=\"primary\" type=\"submit\" disabled={saving}>\n                  {saving ? 'Saving‚Ä¶' : saved ? 'Saved!' : 'Save changes'}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activePane === 'paywall' && (\n            <form className=\"settings-pane-form\" onSubmit={save}>\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Paywall controls</h3>\n                  <p className=\"subtle\">Emergency + peek behavior.</p>\n                </div>\n                <div className=\"settings-row\">\n                  <label>\n                    Emergency policy\n                    <select value={emergencyPolicy} onChange={(e) => setEmergencyPolicy(e.target.value as EmergencyPolicyId)}>\n                      <option value=\"off\">Off</option>\n                      <option value=\"gentle\">Gentle</option>\n                      <option value=\"balanced\">Balanced</option>\n                      <option value=\"strict\">Strict</option>\n                    </select>\n                  </label>\n                  <label>\n                    Reminder interval (seconds)\n                    <input\n                      type=\"number\"\n                      min=\"30\"\n                      max=\"3600\"\n                      value={emergencyReminderInterval}\n                      onChange={(e) => setEmergencyReminderInterval(Number(e.target.value))}\n                    />\n                  </label>\n                </div>\n                <details className=\"settings-details\">\n                  <summary>Policy details</summary>\n                  <div className=\"subtle\">\n                    <div><strong>Off</strong>: no emergency access.</div>\n                    <div><strong>Gentle</strong>: 5m, URL-locked, unlimited/day.</div>\n                    <div><strong>Balanced</strong>: 3m, 2/day, 30m cooldown.</div>\n                    <div><strong>Strict</strong>: 2m, 1/day, 60m cooldown.</div>\n                  </div>\n                </details>\n                <div className=\"settings-inline\">\n                  <label>\n                    <input\n                      type=\"checkbox\"\n                      checked={peekEnabled}\n                      onChange={(e) => setPeekEnabled(e.target.checked)}\n                    />\n                    <span className=\"subtle\">Enable peek</span>\n                  </label>\n                  <label style={{ opacity: peekEnabled ? 1 : 0.6 }}>\n                    <input\n                      type=\"checkbox\"\n                      checked={peekAllowNewPages}\n                      onChange={(e) => setPeekAllowNewPages(e.target.checked)}\n                      disabled={!peekEnabled}\n                    />\n                    <span className=\"subtle\">Allow peek on new pages</span>\n                  </label>\n                </div>\n              </div>\n\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Guardrails: color filters</h3>\n                  <p className=\"subtle\">Make frivolity visually and economically cheaper when filtered.</p>\n                </div>\n                <div className=\"settings-row\">\n                  <label>\n                    Frivolity color filter\n                    <select\n                      value={guardrailColorFilter}\n                      onChange={(e) => setGuardrailColorFilter(e.target.value as GuardrailColorFilter)}\n                    >\n                      <option value=\"full-color\">Full color (standard cost)</option>\n                      <option value=\"greyscale\">Greyscale (cheaper)</option>\n                      <option value=\"redscale\">Redscale (cheaper)</option>\n                    </select>\n                  </label>\n                </div>\n                <div className=\"settings-inline\">\n                  <label>\n                    <input\n                      type=\"checkbox\"\n                      checked={alwaysGreyscale}\n                      onChange={(e) => setAlwaysGreyscale(e.target.checked)}\n                    />\n                    <span className=\"subtle\">Always greyscale (global override)</span>\n                  </label>\n                </div>\n                <p className=\"subtle\" style={{ margin: 0 }}>\n                  Pricing applies when starting new frivolity sessions.\n                </p>\n              </div>\n\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Camera mode</h3>\n                  <p className=\"subtle\">Captures a still every minute during frivolity. Stored locally on this Mac. macOS will prompt for camera access when enabling.</p>\n                </div>\n                <div className=\"settings-inline\">\n                  <label>\n                    <input\n                      type=\"checkbox\"\n                      checked={cameraModeEnabled}\n                      onChange={(e) => {\n                        void handleCameraModeToggle(e.target.checked);\n                      }}\n                    />\n                    <span className=\"subtle\">Enable camera mode</span>\n                  </label>\n                  <button\n                    type=\"button\"\n                    className=\"ghost\"\n                    onClick={refreshCameraPhotos}\n                    disabled={cameraLoading}\n                  >\n                    {cameraLoading ? 'Refreshing‚Ä¶' : 'Refresh gallery'}\n                  </button>\n                  <span className=\"subtle\">{cameraPhotos.length} photos</span>\n                </div>\n                {cameraError && <p className=\"error-text\">{cameraError}</p>}\n                {cameraPhotos.length === 0 ? (\n                  <p className=\"subtle\" style={{ marginTop: 12 }}>No photos yet.</p>\n                ) : (\n                  <div className=\"camera-gallery-grid\">\n                    {cameraPhotos.map((photo) => (\n                      <div key={photo.id} className=\"camera-card\">\n                        <img className=\"camera-photo\" src={photo.fileUrl} alt=\"Camera capture\" loading=\"lazy\" />\n                        <div className=\"camera-meta\">\n                          <strong>{photo.subject ?? 'Frivolity'}</strong>\n                          <span className=\"subtle\">{new Date(photo.capturedAt).toLocaleString()}</span>\n                        </div>\n                        <div className=\"camera-actions\">\n                          <button type=\"button\" className=\"ghost\" onClick={() => handleCameraReveal(photo.id)}>\n                            Reveal\n                          </button>\n                          <button type=\"button\" className=\"danger\" onClick={() => handleCameraDelete(photo.id)}>\n                            Delete\n                          </button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Journaling</h3>\n                  <p className=\"subtle\">Quick launch for reset prompts.</p>\n                </div>\n                <label>\n                  Journal URL\n                  <input\n                    type=\"text\"\n                    placeholder=\"https://app.tana.inc/‚Ä¶\"\n                    value={journalUrl}\n                    onChange={(e) => setJournalUrl(e.target.value)}\n                  />\n                </label>\n                <label style={{ maxWidth: 260 }}>\n                  Duration (minutes)\n                  <input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"180\"\n                    value={journalMinutes}\n                    onChange={(e) => setJournalMinutes(Number(e.target.value))}\n                  />\n                </label>\n              </div>\n\n              <div className=\"settings-actions\">\n                <button className=\"primary\" type=\"submit\" disabled={saving}>\n                  {saving ? 'Saving‚Ä¶' : saved ? 'Saved!' : 'Save changes'}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activePane === 'integrations' && (\n            <form className=\"settings-pane-form\" onSubmit={save}>\n              <div className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Integrations</h3>\n                  <p className=\"subtle\">Curate ‚ÄúTry this instead‚Äù.</p>\n                </div>\n                <label>\n                  Zotero source\n                  <select\n                    value={zoteroConfig.mode}\n                    onChange={(e) => {\n                      const mode = e.target.value as ZoteroIntegrationMode;\n                      setZoteroConfig((cur) => ({\n                        ...cur,\n                        mode: mode === 'collection' ? 'collection' : 'recent'\n                      }));\n                    }}\n                  >\n                    <option value=\"recent\">Recent items</option>\n                    <option value=\"collection\">Specific collection</option>\n                  </select>\n                </label>\n                {zoteroConfig.mode === 'collection' && (\n                  <div className=\"settings-stack\">\n                    <div className=\"settings-actions\">\n                      <button\n                        type=\"button\"\n                        className=\"ghost\"\n                        onClick={refreshZoteroCollections}\n                        disabled={zoteroCollectionsLoading}\n                      >\n                        {zoteroCollectionsLoading ? 'Loading‚Ä¶' : 'Refresh collections'}\n                      </button>\n                      <label className=\"settings-inline\">\n                        <input\n                          type=\"checkbox\"\n                          checked={zoteroConfig.includeSubcollections}\n                          onChange={(e) => setZoteroConfig((cur) => ({ ...cur, includeSubcollections: e.target.checked }))}\n                        />\n                        <span className=\"subtle\">Include subcollections</span>\n                      </label>\n                    </div>\n                    <select\n                      value={zoteroConfig.collectionId ?? ''}\n                      onChange={(e) => {\n                        const raw = e.target.value;\n                        const id = raw ? Number(raw) : null;\n                        setZoteroConfig((cur) => ({ ...cur, collectionId: id && Number.isFinite(id) ? id : null }));\n                      }}\n                    >\n                      <option value=\"\">Select a collection‚Ä¶</option>\n                      {zoteroCollections.map((c) => (\n                        <option key={c.id} value={c.id}>\n                          {c.path}\n                        </option>\n                      ))}\n                    </select>\n                    <p className=\"subtle\" style={{ margin: 0 }}>\n                      {selectedZoteroCollection ? `Selected: ${selectedZoteroCollection.path}` : 'No collection selected.'}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"settings-actions\">\n                <button className=\"primary\" type=\"submit\" disabled={saving}>\n                  {saving ? 'Saving‚Ä¶' : saved ? 'Saved!' : 'Save changes'}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activePane === 'domains' && (\n            <Domains api={api} variant=\"settings\" />\n          )}\n\n          {activePane === 'economy' && (\n            <EconomyTuner api={api} />\n          )}\n\n          {activePane === 'system' && (\n            <div className=\"settings-pane-body\">\n              <section className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Theme</h3>\n                  <p className=\"subtle\">Choose your vibe.</p>\n                </div>\n                <div className=\"settings-stack\">\n                  <label className=\"settings-inline\">\n                    <input\n                      type=\"radio\"\n                      name=\"theme\"\n                      value=\"lavender\"\n                      checked={theme === 'lavender'}\n                      onChange={() => onThemeChange('lavender')}\n                    />\n                    <span>Lavender (default)</span>\n                  </label>\n                  <label className=\"settings-inline\">\n                    <input\n                      type=\"radio\"\n                      name=\"theme\"\n                      value=\"olive\"\n                      checked={theme === 'olive'}\n                      onChange={() => onThemeChange('olive')}\n                    />\n                    <span>Olive Garden Feast</span>\n                  </label>\n                </div>\n              </section>\n\n              {resetMessage && (\n                <div className={`settings-banner ${resetScope === 'all' ? 'danger' : 'success'}`}>\n                  <div>\n                    <strong>{resetMessage}</strong>\n                    <div className=\"subtle\">You may need to refresh to see empty states.</div>\n                  </div>\n                </div>\n              )}\n              <section className=\"card settings-section\">\n                <div className=\"settings-section-header\">\n                  <h3>Reset data</h3>\n                  <p className=\"subtle\">Start fresh. Choose what to clear.</p>\n                </div>\n                <div className=\"settings-stack\">\n                  <label className=\"settings-inline\">\n                    <input\n                      type=\"radio\"\n                      name=\"reset-scope\"\n                      value=\"trophies\"\n                      checked={resetScope === 'trophies'}\n                      onChange={() => setResetScope('trophies')}\n                    />\n                    <span className=\"subtle\">Reset trophy case only</span>\n                  </label>\n                  <label className=\"settings-inline\">\n                    <input\n                      type=\"radio\"\n                      name=\"reset-scope\"\n                      value=\"wallet\"\n                      checked={resetScope === 'wallet'}\n                      onChange={() => setResetScope('wallet')}\n                    />\n                    <span className=\"subtle\">Reset bank only (wallet balance and transactions)</span>\n                  </label>\n                  <label className=\"settings-inline\">\n                    <input\n                      type=\"radio\"\n                      name=\"reset-scope\"\n                      value=\"all\"\n                      checked={resetScope === 'all'}\n                      onChange={() => setResetScope('all')}\n                    />\n                    <span className=\"subtle\">Reset everything (wallet, history, trophies, library)</span>\n                  </label>\n                  <p className=\"subtle\" style={{ margin: 0 }}>\n                    This also removes the selected data from cloud sync if you are signed in.\n                  </p>\n                  <button type=\"button\" className=\"secondary\" onClick={handleReset} disabled={resetBusy}>\n                    {resetBusy ? 'Resetting‚Ä¶' : 'Reset now'}\n                  </button>\n                </div>\n              </section>\n\n              <section className=\"card\">\n                <h2>Accessibility permissions</h2>\n                <ol className=\"instructions\">\n                  <li>Open System Settings ‚Üí Privacy &amp; Security ‚Üí Accessibility.</li>\n                  <li>Click the lock to make changes and authenticate.</li>\n                  <li>Find ‚ÄúTimeWellSpent‚Äù in the list and toggle it on.</li>\n                  <li>Repeat under ‚ÄúAutomation‚Äù to allow browser control.</li>\n                </ol>\n                <p className=\"subtle\">You can paste <code>x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility</code> into Spotlight to jump there quickly.</p>\n              </section>\n            </div>\n          )}\n        </div>\n      </div>\n    </section>\n  );\n}\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport type {\n    AnalyticsOverview,\n    BehavioralPattern,\n    RendererApi,\n    TimeOfDayStats,\n    TrendPoint,\n} from '@shared/types';\nimport { DAY_START_HOUR, shiftHourToDayStart } from '@shared/time';\n\ninterface AnalyticsProps {\n    api: RendererApi;\n}\n\ntype TimeRange = '24h' | '7d' | '30d';\n\nexport default function Analytics({ api }: AnalyticsProps) {\n    const [timeRange, setTimeRange] = useState<TimeRange>('7d');\n    const [overview, setOverview] = useState<AnalyticsOverview | null>(null);\n    const [timeOfDay, setTimeOfDay] = useState<TimeOfDayStats[]>([]);\n    const [patterns, setPatterns] = useState<BehavioralPattern[]>([]);\n    const [trends, setTrends] = useState<TrendPoint[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [excludedKeywords, setExcludedKeywords] = useState<string[]>([]);\n\n    const days = useMemo(() => {\n        switch (timeRange) {\n            case '24h': return 1;\n            case '7d': return 7;\n            case '30d': return 30;\n        }\n    }, [timeRange]);\n\n    const refresh = useCallback(async () => {\n        setLoading(true);\n        const [o, t, p, tr] = await Promise.all([\n            api.analytics.overview(days),\n            api.analytics.timeOfDay(days),\n            api.analytics.patterns(days),\n            api.analytics.trends(days <= 1 ? 'hour' : 'day'),\n        ]);\n        setOverview(o);\n        setTimeOfDay(t);\n        setPatterns(p);\n        setTrends(tr);\n        setLoading(false);\n    }, [api, days]);\n\n    useEffect(() => {\n        refresh();\n    }, [refresh]);\n\n    useEffect(() => {\n        api.settings.excludedKeywords().then(setExcludedKeywords).catch(() => { });\n    }, [api]);\n\n    const formatHour = (h: number) => {\n        const ampm = h >= 12 ? 'PM' : 'AM';\n        const hour = h % 12 || 12;\n        return `${hour}${ampm}`;\n    };\n\n    const maxHourValue = useMemo(() => {\n        return Math.max(...timeOfDay.map(h => h.productive + h.neutral + h.frivolity + h.draining + h.idle), 1);\n    }, [timeOfDay]);\n\n    // Find patterns leading to frivolity\n    const frivolityPatterns = useMemo(() => {\n        return patterns\n            .filter(p => p.toContext.category === 'frivolity')\n            .slice(0, 6);\n    }, [patterns]);\n\n    const isExcludedLabel = useCallback((value: string) => {\n        if (!excludedKeywords.length) return false;\n        const haystack = value.toLowerCase();\n        return excludedKeywords.some((keyword) => keyword && haystack.includes(keyword));\n    }, [excludedKeywords]);\n\n    const scrubLabel = useCallback((value: string | null) => {\n        if (!value) return null;\n        return isExcludedLabel(value) ? 'Hidden' : value;\n    }, [isExcludedLabel]);\n\n    const scrubText = useCallback((value: string) => {\n        if (!excludedKeywords.length) return value;\n        let next = value;\n        for (const keyword of excludedKeywords) {\n            if (!keyword) continue;\n            const escaped = keyword.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n            next = next.replace(new RegExp(escaped, 'gi'), '[hidden]');\n        }\n        return next;\n    }, [excludedKeywords]);\n\n    return (\n        <section className=\"panel analytics-panel\">\n            <header className=\"panel-header\">\n                <div>\n                    <p className=\"eyebrow\">Behavioral intelligence</p>\n                    <h1>Analytics</h1>\n                </div>\n                <div className=\"time-range-selector\">\n                    <button\n                        className={timeRange === '24h' ? 'active' : ''}\n                        onClick={() => setTimeRange('24h')}\n                    >\n                        24h\n                    </button>\n                    <button\n                        className={timeRange === '7d' ? 'active' : ''}\n                        onClick={() => setTimeRange('7d')}\n                    >\n                        7d\n                    </button>\n                    <button\n                        className={timeRange === '30d' ? 'active' : ''}\n                        onClick={() => setTimeRange('30d')}\n                    >\n                        30d\n                    </button>\n                </div>\n            </header>\n\n            {loading ? (\n                <div className=\"panel-body analytics-loading\">\n                    <div className=\"loader-spinner\" />\n                    <p>Analyzing behavioral data...</p>\n                </div>\n            ) : (\n                <div className=\"panel-body analytics-grid\">\n                    {/* Overview Cards */}\n                    <div className=\"analytics-overview\">\n                        <div className=\"overview-card primary\">\n                            <div className=\"overview-value\">{overview?.productivityScore ?? 0}%</div>\n                            <div className=\"overview-label\">Productivity Score</div>\n                            <div className={`overview-trend trend-${overview?.focusTrend ?? 'stable'}`}>\n                                {overview?.focusTrend === 'improving' && '‚Üë Improving'}\n                                {overview?.focusTrend === 'declining' && '‚Üì Declining'}\n                                {overview?.focusTrend === 'stable' && '‚Üí Stable'}\n                            </div>\n                        </div>\n                        <div className=\"overview-card glow\">\n                            <div className=\"overview-value\">{overview ? Math.round((overview.deepWorkSeconds / 3600) * 10) / 10 : 0}h</div>\n                            <div className=\"overview-label\">Deep Work</div>\n                        </div>\n                        <div className=\"overview-card\">\n                            <div className=\"overview-value\">{overview?.totalActiveHours ?? 0}h</div>\n                            <div className=\"overview-label\">Active Time</div>\n                        </div>\n                        <div className=\"overview-card\">\n                            <div className=\"overview-value\">{overview?.totalSessions ?? 0}</div>\n                            <div className=\"overview-label\">Sessions</div>\n                        </div>\n                        <div className=\"overview-card accent\">\n                            <div className=\"overview-value\">{formatHour(overview?.peakProductiveHour ?? 9)}</div>\n                            <div className=\"overview-label\">Peak Focus Hour</div>\n                        </div>\n                        <div className=\"overview-card danger\">\n                            <div className=\"overview-value\">{formatHour(overview?.riskHour ?? 15)}</div>\n                            <div className=\"overview-label\">Risk Hour</div>\n                        </div>\n                    </div>\n\n                    {/* Insights Panel */}\n                    <div className=\"card insights-card\">\n                        <h2>üß† AI Insights</h2>\n                        <ul className=\"insights-list\">\n                            {(overview?.insights ?? []).map((insight, idx) => (\n                                <li key={idx}>{scrubText(insight)}</li>\n                            ))}\n                            {(overview?.insights ?? []).length === 0 && (\n                                <li className=\"subtle\">Keep using the app to generate insights...</li>\n                            )}\n                        </ul>\n                    </div>\n\n                    {/* Time of Day Heatmap */}\n                    <div className=\"card heatmap-card\">\n                        <div className=\"card-header-row\">\n                            <h2>Time of Day Activity</h2>\n                            <span className=\"subtle\">24-hour pattern</span>\n                        </div>\n                        <div className=\"time-heatmap\">\n                            {timeOfDay.map((hour) => {\n                                const total = hour.productive + hour.neutral + hour.frivolity + hour.draining + hour.idle;\n                                const height = total > 0 ? Math.max(8, Math.round((total / maxHourValue) * 100)) : 4;\n                                const prodPct = total > 0 ? (hour.productive / total) * 100 : 0;\n                                const neutPct = total > 0 ? (hour.neutral / total) * 100 : 0;\n                                const frivPct = total > 0 ? (hour.frivolity / total) * 100 : 0;\n                                const drainPct = total > 0 ? (hour.draining / total) * 100 : 0;\n                                const dominantClass = hour.dominantCategory;\n\n                                return (\n                                    <div\n                                        key={hour.hour}\n                                        className={`heatmap-col ${dominantClass}`}\n                                        title={`${formatHour(hour.hour)}: ${Math.round(total / 60)}m total`}\n                                    >\n                                        <div className=\"heatmap-bar\" style={{ height: `${height}%` }}>\n                                            <span className=\"bar-segment productive\" style={{ height: `${prodPct}%` }} />\n                                            <span className=\"bar-segment neutral\" style={{ height: `${neutPct}%` }} />\n                                            <span className=\"bar-segment frivolity\" style={{ height: `${frivPct}%` }} />\n                                            <span className=\"bar-segment draining\" style={{ height: `${drainPct}%` }} />\n                                        </div>\n                                        <span className=\"heatmap-label\">\n                                            {shiftHourToDayStart(hour.hour, DAY_START_HOUR) % 6 === 0 ? formatHour(hour.hour) : ''}\n                                        </span>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                        <div className=\"heatmap-legend\">\n                            <span><span className=\"dot productive\" /> Productive</span>\n                            <span><span className=\"dot neutral\" /> Neutral</span>\n                            <span><span className=\"dot frivolity\" /> Frivolity</span>\n                            <span><span className=\"dot draining\" /> Draining</span>\n                            <span><span className=\"dot deepwork\" /> Deep work</span>\n                        </div>\n                    </div>\n\n                    {/* Category Breakdown */}\n                    <div className=\"card breakdown-card\">\n                        <h2>Category Breakdown</h2>\n                        <div className=\"breakdown-bars\">\n                            {overview && (['productive', 'deepWork', 'neutral', 'frivolity', 'draining', 'idle'] as const).map((cat) => {\n                                const baseTotal = Object.values(overview.categoryBreakdown).reduce((a, b) => a + b, 0);\n                                const value = cat === 'deepWork'\n                                    ? overview.deepWorkSeconds\n                                    : (overview.categoryBreakdown[cat as keyof typeof overview.categoryBreakdown] ?? 0);\n                                const percent = baseTotal > 0 ? Math.round((value / baseTotal) * 100) : 0;\n                                const hours = Math.round((value / 3600) * 10) / 10;\n\n                                return (\n                                    <div key={cat} className=\"breakdown-row\">\n                                        <span className=\"breakdown-label\">{cat === 'deepWork' ? 'deep work' : cat}</span>\n                                        <div className=\"breakdown-bar-track\">\n                                            <div\n                                                className={`breakdown-bar-fill ${cat}`}\n                                                style={{ width: `${percent}%` }}\n                                            />\n                                        </div>\n                                        <span className=\"breakdown-value\">{hours}h</span>\n                                        <span className=\"breakdown-percent\">{percent}%</span>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\n                    {/* Trends Chart */}\n                    <div className=\"card trends-card\">\n                        <div className=\"card-header-row\">\n                            <h2>Activity Trends</h2>\n                            <span className=\"subtle\">Quality over time</span>\n                        </div>\n                        <div className=\"trends-chart\">\n                            {trends.map((point, idx) => {\n                                const draining = (point as any).draining ?? 0;\n                                const total = point.productive + point.neutral + point.frivolity + draining;\n                                const maxTotal = Math.max(...trends.map(t => t.productive + t.neutral + t.frivolity + ((t as any).draining ?? 0)), 1);\n                                const height = Math.max(4, Math.round((total / maxTotal) * 100));\n                                const deepPct = total > 0 ? (point.deepWork / total) * 100 : 0;\n                                const drainPct = total > 0 ? (draining / total) * 100 : 0;\n                                const frivPct = total > 0 ? (point.frivolity / total) * 100 : 0;\n                                const neutralPct = total > 0 ? (point.neutral / total) * 100 : 0;\n                                const drainStop = drainPct;\n                                const frivStop = drainPct + frivPct;\n                                const neutralStop = drainPct + frivPct + neutralPct;\n\n                                return (\n                                    <div\n                                        key={idx}\n                                        className=\"trend-bar\"\n                                        title={`${point.label}: ${Math.round(total / 60)}m active, ${point.qualityScore}% quality`}\n                                    >\n                                        <div\n                                            className=\"trend-bar-fill\"\n                                            style={{\n                                                height: `${height}%`,\n                                                background: `linear-gradient(to top, \n                          var(--cat-draining) ${drainStop || 0}%, \n                          var(--cat-frivolity) ${frivStop || 0}%, \n                          var(--cat-neutral) ${neutralStop || 50}%, \n                          var(--cat-productive) 100%)`\n                                            }}\n                                        >\n                                            {deepPct > 0 && (\n                                                <span\n                                                    className=\"trend-deepwork-overlay\"\n                                                    style={{ height: `${deepPct}%` }}\n                                                />\n                                            )}\n                                        </div>\n                                        <span className=\"trend-label\">{point.label}</span>\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n\n                    {/* Behavioral Patterns */}\n                    <div className=\"card patterns-card\">\n                        <div className=\"card-header-row\">\n                            <h2>üîÄ What Leads to Frivolity</h2>\n                            <span className=\"subtle\">Transition patterns</span>\n                        </div>\n                        <ul className=\"patterns-list\">\n                            {frivolityPatterns.map((pattern, idx) => (\n                                <li key={idx} className=\"pattern-row\">\n                                    <div className=\"pattern-from\">\n                                        <span className={`category-chip category-${pattern.fromContext.category ?? 'neutral'}`}>\n                                            {pattern.fromContext.category ?? 'neutral'}\n                                        </span>\n                                        <span className=\"pattern-domain\">{scrubLabel(pattern.fromContext.domain) ?? 'Any'}</span>\n                                    </div>\n                                    <span className=\"pattern-arrow\">‚Üí</span>\n                                    <div className=\"pattern-to\">\n                                        <span className=\"category-chip category-frivolity\">frivolity</span>\n                                        <span className=\"pattern-domain\">{scrubLabel(pattern.toContext.domain) ?? 'Any'}</span>\n                                    </div>\n                                    <div className=\"pattern-stats\">\n                                        <span className=\"pattern-frequency\">{pattern.frequency}√ó</span>\n                                        <span className=\"pattern-time\">{Math.round(pattern.avgTimeBefore / 60)}m avg</span>\n                                    </div>\n                                </li>\n                            ))}\n                            {frivolityPatterns.length === 0 && (\n                                <li className=\"subtle\">No significant patterns detected yet</li>\n                            )}\n                        </ul>\n                    </div>\n\n                    {/* Top Domain */}\n                    {overview?.topEngagementDomain && (\n                        <div className=\"card top-domain-card\">\n                            <h2>üéØ Top Engagement</h2>\n                            <div className=\"top-domain-name\">{scrubLabel(overview.topEngagementDomain)}</div>\n                            <p className=\"subtle\">Most time spent domain this period</p>\n                        </div>\n                    )}\n                </div>\n            )}\n        </section>\n    );\n}\n","import { useEffect, useMemo, useState } from 'react';\n\ntype SudokuUnlockPayload = {\n  correctSquares: number;\n  requiredSquares: number;\n  elapsedSeconds: number;\n};\n\ninterface SudokuChallengeProps {\n  title: string;\n  subtitle?: string;\n  requiredCorrect?: number;\n  unlockLabel?: string;\n  onUnlock?: (payload: SudokuUnlockPayload) => Promise<void> | void;\n  disabled?: boolean;\n  puzzleKey?: string;\n}\n\nconst HARD_PUZZLE = [\n  [8, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 3, 6, 0, 0, 0, 0, 0],\n  [0, 7, 0, 0, 9, 0, 2, 0, 0],\n  [0, 5, 0, 0, 0, 7, 0, 0, 0],\n  [0, 0, 0, 0, 4, 5, 7, 0, 0],\n  [0, 0, 0, 1, 0, 0, 0, 3, 0],\n  [0, 0, 1, 0, 0, 0, 0, 6, 8],\n  [0, 0, 8, 5, 0, 0, 0, 1, 0],\n  [0, 9, 0, 0, 0, 0, 4, 0, 0]\n] as const;\n\nconst HARD_SOLUTION = [\n  [8, 1, 2, 7, 5, 3, 6, 4, 9],\n  [9, 4, 3, 6, 8, 2, 1, 7, 5],\n  [6, 7, 5, 4, 9, 1, 2, 8, 3],\n  [1, 5, 4, 2, 3, 7, 8, 9, 6],\n  [3, 6, 9, 8, 4, 5, 7, 2, 1],\n  [2, 8, 7, 1, 6, 9, 5, 3, 4],\n  [5, 2, 1, 9, 7, 4, 3, 6, 8],\n  [4, 3, 8, 5, 2, 6, 9, 1, 7],\n  [7, 9, 6, 3, 1, 8, 4, 5, 2]\n] as const;\n\nconst BLANK_CELLS = HARD_PUZZLE.flatMap((row, rowIndex) =>\n  row.flatMap((value, colIndex) => (value === 0 ? [{ row: rowIndex, col: colIndex }] : []))\n);\n\nfunction createEmptyEntries() {\n  return HARD_PUZZLE.map((row) => row.map((value) => (value === 0 ? '' : String(value))));\n}\n\nexport default function SudokuChallenge({\n  title,\n  subtitle,\n  requiredCorrect = 12,\n  unlockLabel = 'Unlock',\n  onUnlock,\n  disabled = false,\n  puzzleKey\n}: SudokuChallengeProps) {\n  const [entries, setEntries] = useState<string[][]>(() => createEmptyEntries());\n  const [startedAt, setStartedAt] = useState(() => Date.now());\n  const [unlocking, setUnlocking] = useState(false);\n  const [unlockError, setUnlockError] = useState<string | null>(null);\n\n  const requiredSquares = useMemo(\n    () => Math.max(1, Math.min(BLANK_CELLS.length, Math.round(requiredCorrect))),\n    [requiredCorrect]\n  );\n\n  const correctSquares = useMemo(() => {\n    return BLANK_CELLS.reduce((count, cell) => {\n      const value = entries[cell.row]?.[cell.col];\n      if (!value) return count;\n      return Number(value) === HARD_SOLUTION[cell.row][cell.col] ? count + 1 : count;\n    }, 0);\n  }, [entries]);\n\n  const solvedEnough = correctSquares >= requiredSquares;\n  const progressPercent = Math.min(100, (correctSquares / requiredSquares) * 100);\n\n  useEffect(() => {\n    setEntries(createEmptyEntries());\n    setStartedAt(Date.now());\n    setUnlockError(null);\n    setUnlocking(false);\n  }, [puzzleKey]);\n\n  const updateEntry = (rowIndex: number, colIndex: number, rawValue: string) => {\n    if (HARD_PUZZLE[rowIndex][colIndex] !== 0 || disabled) return;\n    const value = rawValue.replace(/[^1-9]/g, '').slice(-1);\n    setEntries((prev) => {\n      const next = prev.map((row) => [...row]);\n      next[rowIndex][colIndex] = value;\n      return next;\n    });\n  };\n\n  const clearPuzzle = () => {\n    setEntries(createEmptyEntries());\n    setStartedAt(Date.now());\n    setUnlockError(null);\n  };\n\n  const handleUnlock = async () => {\n    if (!onUnlock || !solvedEnough || unlocking || disabled) return;\n    setUnlocking(true);\n    setUnlockError(null);\n    try {\n      await onUnlock({\n        correctSquares,\n        requiredSquares,\n        elapsedSeconds: Math.max(1, Math.round((Date.now() - startedAt) / 1000))\n      });\n    } catch (error) {\n      setUnlockError((error as Error).message);\n    } finally {\n      setUnlocking(false);\n    }\n  };\n\n  return (\n    <section className=\"sudoku-challenge\">\n      <div className=\"sudoku-header\">\n        <strong>{title}</strong>\n        {subtitle && <p className=\"subtle\">{subtitle}</p>}\n      </div>\n      <div className=\"sudoku-progress-row\">\n        <span>\n          Correct squares: {correctSquares}/{requiredSquares}\n        </span>\n        <span>{progressPercent.toFixed(0)}%</span>\n      </div>\n      <div className=\"sudoku-progress-track\" aria-hidden>\n        <span style={{ width: `${progressPercent}%` }} />\n      </div>\n      <div className=\"sudoku-grid\" role=\"group\" aria-label=\"Sudoku puzzle\">\n        {HARD_PUZZLE.map((row, rowIndex) =>\n          row.map((value, colIndex) => {\n            const isFixed = value !== 0;\n            const currentValue = isFixed ? String(value) : entries[rowIndex][colIndex];\n            const hasValue = currentValue.length > 0;\n            const isCorrect = !isFixed && hasValue && Number(currentValue) === HARD_SOLUTION[rowIndex][colIndex];\n            const isIncorrect = !isFixed && hasValue && !isCorrect;\n            const classNames = [\n              'sudoku-cell',\n              isFixed ? 'is-fixed' : '',\n              isCorrect ? 'is-correct' : '',\n              isIncorrect ? 'is-incorrect' : ''\n            ]\n              .filter(Boolean)\n              .join(' ');\n\n            return (\n              <input\n                key={`${rowIndex}-${colIndex}`}\n                className={classNames}\n                type=\"text\"\n                inputMode=\"numeric\"\n                pattern=\"[1-9]\"\n                maxLength={1}\n                value={currentValue}\n                disabled={isFixed || disabled || unlocking}\n                onChange={(event) => updateEntry(rowIndex, colIndex, event.target.value)}\n                style={{\n                  borderTopWidth: rowIndex % 3 === 0 ? 2 : 1,\n                  borderLeftWidth: colIndex % 3 === 0 ? 2 : 1,\n                  borderRightWidth: colIndex === 8 ? 2 : 1,\n                  borderBottomWidth: rowIndex === 8 ? 2 : 1\n                }}\n                aria-label={`Row ${rowIndex + 1} column ${colIndex + 1}`}\n              />\n            );\n          })\n        )}\n      </div>\n      <div className=\"sudoku-actions\">\n        <button type=\"button\" className=\"ghost\" onClick={clearPuzzle} disabled={unlocking}>\n          Reset puzzle\n        </button>\n        {onUnlock ? (\n          <button type=\"button\" className=\"primary\" onClick={handleUnlock} disabled={!solvedEnough || unlocking || disabled}>\n            {unlocking ? 'Unlocking...' : unlockLabel}\n          </button>\n        ) : (\n          <span className=\"subtle\">{solvedEnough ? 'Challenge complete.' : 'Practice mode'}</span>\n        )}\n      </div>\n      {unlockError && <p className=\"warning subtle\">{unlockError}</p>}\n    </section>\n  );\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport type { MarketRate, RendererApi, WalletSnapshot } from '@shared/types';\nimport SudokuChallenge from './SudokuChallenge';\n\ninterface PaywallOverlayProps {\n  open: boolean;\n  state: {\n    domain: string;\n    mode: 'metered' | 'pack';\n    ratePerMin?: number;\n    remainingSeconds?: number;\n    reason?: string;\n  } | null;\n  wallet: WalletSnapshot;\n  api: RendererApi;\n  marketRates: MarketRate[];\n  onWallet(snapshot: WalletSnapshot): void;\n  onClose(): void;\n}\n\nconst clamp = (value: number, min: number, max: number) => Math.min(Math.max(value, min), max);\nconst SUDOKU_REQUIRED_SQUARES = 12;\nconst SUDOKU_PASS_MINUTES = 12;\n\nexport default function PaywallOverlay({ open, state, wallet, api, marketRates, onWallet, onClose }: PaywallOverlayProps) {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedMinutes, setSelectedMinutes] = useState(15);\n  const rate = useMemo(() => {\n    if (!state) return undefined;\n    return marketRates.find((item) => item.domain === state.domain);\n  }, [marketRates, state?.domain]);\n\n  const sliderBounds = useMemo(() => {\n    const minutes = rate?.packs.map((pack) => pack.minutes) ?? [];\n    const min = minutes.length ? Math.min(...minutes) : 10;\n    const maxFromPacks = minutes.length ? Math.max(...minutes) : 30;\n    const max = Math.max(maxFromPacks, min + 15, 45);\n    return { min: Math.max(5, min), max, step: 5 };\n  }, [rate]);\n\n  useEffect(() => {\n    if (!open || !state) return;\n    const defaultMinutes = rate?.packs?.[0]?.minutes ?? sliderBounds.min;\n    setSelectedMinutes(clamp(defaultMinutes, sliderBounds.min, sliderBounds.max));\n  }, [open, rate, sliderBounds.max, sliderBounds.min, state?.domain]);\n\n  useEffect(() => {\n    if (!open) return;\n    setError(null);\n  }, [open, state?.domain]);\n\n  if (!open || !state) {\n    return null;\n  }\n\n  async function startMetered() {\n    if (!state) return;\n    setLoading(true);\n    setError(null);\n    try {\n      await api.paywall.startMetered(state.domain);\n      const snapshot = await api.wallet.get();\n      onWallet(snapshot);\n      onClose();\n    } catch (error) {\n      console.error(error);\n      setError((error as Error).message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function buyPack(minutes: number) {\n    if (!state) return;\n    setLoading(true);\n    setError(null);\n    try {\n      await api.paywall.buyPack(state.domain, minutes);\n      const snapshot = await api.wallet.get();\n      onWallet(snapshot);\n      onClose();\n    } catch (error) {\n      console.error(error);\n      setError((error as Error).message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function unlockViaSudoku(correctSquares: number) {\n    if (!state) return;\n    setLoading(true);\n    setError(null);\n    try {\n      await api.paywall.startChallengePass(state.domain, {\n        durationSeconds: SUDOKU_PASS_MINUTES * 60,\n        solvedSquares: correctSquares\n      });\n      const snapshot = await api.wallet.get();\n      onWallet(snapshot);\n      onClose();\n    } catch (error) {\n      console.error(error);\n      setError((error as Error).message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const blocked = state.reason === 'blocked';\n  const insufficient = state.reason === 'insufficient-funds';\n  const baseRate = rate?.ratePerMin ?? state.ratePerMin ?? 0;\n  const matchedPack = rate?.packs.find((pack) => pack.minutes === selectedMinutes);\n  const sliderPrice = matchedPack ? matchedPack.price : Math.max(1, Math.round(selectedMinutes * baseRate));\n  const walletPercent = wallet.balance > 0 ? Math.min(1, sliderPrice / wallet.balance) : 1;\n  const coinsLeft = Math.max(0, wallet.balance - sliderPrice);\n  const gaugeRadius = 72;\n  const circumference = 2 * Math.PI * gaugeRadius;\n  const dashOffset = circumference * (1 - walletPercent);\n  const sliderAffordable = wallet.balance >= sliderPrice;\n  const sliderMidLabel = Math.round((sliderBounds.min + sliderBounds.max) / 2);\n  const meteredPreviewPercent = wallet.balance > 0 ? Math.min(1, (baseRate * 15) / wallet.balance) : 1;\n  const dayShare = Math.min(1, selectedMinutes / (24 * 60));\n  const walletSharePct = walletPercent * 100;\n  const daySharePct = Math.round(dayShare * 100);\n  const projections = [\n    { label: 'Quick peek', minutes: Math.max(5, Math.round(selectedMinutes * 0.4)) },\n    { label: 'This choice', minutes: selectedMinutes },\n    { label: 'Deep dive', minutes: Math.min(120, Math.round(selectedMinutes * 1.6)) }\n  ].map((p) => ({ ...p, cost: Math.max(1, Math.round(p.minutes * baseRate)) }));\n\n  return (\n    <div className=\"paywall-overlay\">\n      <div className=\"paywall-modal\">\n        <header className=\"paywall-modal-header\">\n          <div>\n            <h2>{state.domain}</h2>\n            <p className=\"subtle\">\n              {blocked\n                ? 'Access blocked ‚Äî unlock by spending f-coins.'\n                : 'Spend f-coins to access this site.'}\n            </p>\n          </div>\n          <button className=\"close-button\" onClick={onClose} aria-label=\"Close paywall\">\n            ‚úï\n          </button>\n        </header>\n        <div className=\"wallet-inline\">\n          <span>Balance</span>\n          <strong>{wallet.balance} f-coins</strong>\n        </div>\n        {blocked && !error && <p className=\"warning\">Start a metered session or buy a time pack to access this site.</p>}\n        {insufficient && !error && (\n          <p className=\"warning\">Session paused ‚Äî add more coins or choose a smaller pack.</p>\n        )}\n        <section className=\"spend-lab\">\n          <div className=\"budget-visual\">\n            <div className=\"budget-circle\" role=\"img\" aria-label={`Spending ${sliderPrice} coins for ${selectedMinutes} minutes`}>\n              <svg viewBox=\"0 0 200 200\" width=\"200\" height=\"200\">\n                <circle className=\"budget-track\" cx=\"100\" cy=\"100\" r={gaugeRadius} strokeWidth=\"14\" />\n                <circle\n                  className=\"budget-fill\"\n                  cx=\"100\"\n                  cy=\"100\"\n                  r={gaugeRadius}\n                  strokeWidth=\"14\"\n                  strokeDasharray={circumference}\n                  strokeDashoffset={dashOffset}\n                />\n              </svg>\n              <div className=\"budget-figures\">\n                <strong>{sliderPrice} f-coins</strong>\n                <span>{selectedMinutes} minute session</span>\n                <small className=\"subtle\">{walletSharePct.toFixed(0)}% of balance</small>\n              </div>\n            </div>\n            <div className=\"impact-bars\">\n              <div>\n                <div className=\"impact-label\">Wallet impact</div>\n                <div className=\"impact-meter\">\n                  <span style={{ width: `${walletSharePct}%` }} />\n                </div>\n                <small className=\"subtle\">Leaves {coinsLeft} f-coins</small>\n              </div>\n              <div>\n                <div className=\"impact-label\">Day share</div>\n                <div className=\"impact-meter day\">\n                  <span style={{ width: `${daySharePct}%` }} />\n                </div>\n                <small className=\"subtle\">{daySharePct}% of your day if you stay that long</small>\n              </div>\n            </div>\n          </div>\n          <div className=\"budget-controls\">\n            <div className=\"eyebrow\">Session length</div>\n            <p className=\"subtle\">Choose how long you want to access this site.</p>\n            <input\n              id=\"focus-budget\"\n              type=\"range\"\n              min={sliderBounds.min}\n              max={sliderBounds.max}\n              step={sliderBounds.step}\n              value={selectedMinutes}\n              onChange={(event) => setSelectedMinutes(Number(event.target.value))}\n            />\n            <div className=\"budget-scale\">\n              <span>{sliderBounds.min} min</span>\n              <span>{sliderMidLabel} min</span>\n              <span>{sliderBounds.max}+ min</span>\n            </div>\n            <div className=\"projection-grid\">\n              {projections.map((proj) => (\n                <div key={proj.label} className=\"projection-card\">\n                  <div className=\"projection-minutes\">{proj.minutes}m</div>\n                  <div className=\"projection-label\">{proj.label}</div>\n                  <div className=\"projection-cost\">{proj.cost} coins</div>\n                  <div className=\"projection-bar\">\n                    <span style={{ width: `${Math.min(100, (proj.cost / Math.max(wallet.balance, proj.cost)) * 100)}%` }} />\n                  </div>\n                </div>\n              ))}\n            </div>\n            <button className=\"primary\" disabled={loading || !sliderAffordable} onClick={() => buyPack(selectedMinutes)}>\n              Unlock for {sliderPrice} f-coins\n            </button>\n            {!sliderAffordable && (\n              <p className=\"warning subtle\">Need {sliderPrice - wallet.balance} more f-coins.</p>\n            )}\n          </div>\n        </section>\n        <section className=\"paywall-section\">\n          <div className=\"eyebrow\">Other unlocks</div>\n          <div className=\"option-grid\">\n            <button className=\"option-card\" disabled={loading} onClick={startMetered}>\n              <div>\n                <strong>Pay as you go</strong>\n                <p className=\"subtle\">Only pay while the tab is active.</p>\n              </div>\n              <div className=\"option-meter\">\n                <span style={{ width: `${meteredPreviewPercent * 100}%` }} />\n              </div>\n              <small className=\"chip\">{baseRate} f-coins/min</small>\n            </button>\n            {rate?.packs.map((pack) => {\n              const percent = wallet.balance > 0 ? Math.min(1, pack.price / wallet.balance) : 1;\n              return (\n                <button\n                  key={pack.minutes}\n                  className=\"option-card\"\n                  disabled={loading || wallet.balance < pack.price}\n                  onClick={() => buyPack(pack.minutes)}\n                >\n                  <div>\n                    <strong>{pack.minutes} minute session</strong>\n                    <p className=\"subtle\">Fixed time ‚Äî pause anytime.</p>\n                  </div>\n                  <div className=\"option-meter\">\n                    <span style={{ width: `${percent * 100}%` }} />\n                  </div>\n                  <small className=\"chip\">{pack.price} f-coins</small>\n                </button>\n              );\n            })}\n          </div>\n        </section>\n        <section className=\"paywall-section challenge-section\">\n          <div className=\"eyebrow\">Free unlock (game gate)</div>\n          <SudokuChallenge\n            puzzleKey={state.domain}\n            title=\"Hard Sudoku checkpoint\"\n            subtitle={`Solve ${SUDOKU_REQUIRED_SQUARES} correct squares to earn a ${SUDOKU_PASS_MINUTES}-minute free pass.`}\n            requiredCorrect={SUDOKU_REQUIRED_SQUARES}\n            unlockLabel={`Claim ${SUDOKU_PASS_MINUTES}-minute free pass`}\n            onUnlock={({ correctSquares }) => unlockViaSudoku(correctSquares)}\n            disabled={loading}\n          />\n        </section>\n        {typeof state.remainingSeconds === 'number' && state.remainingSeconds > 0 && (\n          <p className=\"subtle\">Remaining: {Math.round(state.remainingSeconds / 60)} min</p>\n        )}\n      </div>\n    </div>\n  );\n}\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport type { ConsumptionDaySummary, ConsumptionLogEntry, LibraryItem, LibraryPurpose, RendererApi } from '@shared/types';\n\ntype Props = {\n  api: RendererApi;\n};\n\nconst PURPOSES: Array<{ value: LibraryPurpose; label: string; hint: string }> = [\n  { value: 'replace', label: 'Replace', hint: 'Shown in ‚ÄúTry this instead‚Äù when you hit a paywall.' },\n  { value: 'productive', label: 'Productive', hint: 'Counts as productive time and appears in your productive shelf.' },\n  { value: 'allow', label: 'Allow', hint: 'Good stuff you want nearby. Optional one-time unlock pricing.' },\n  { value: 'temptation', label: 'Temptation', hint: 'Things you enjoy, but want contained and intentional.' }\n];\n\nfunction purposeLabel(purpose: LibraryPurpose) {\n  return PURPOSES.find((p) => p.value === purpose)?.label ?? purpose;\n}\n\nfunction purposeTone(purpose: LibraryPurpose) {\n  if (purpose === 'replace' || purpose === 'productive') return 'productive';\n  if (purpose === 'temptation') return 'frivolity';\n  return 'neutral';\n}\n\nfunction normaliseUrl(raw: string) {\n  let url = raw.trim();\n  if (!url) return null;\n  if (!url.startsWith('http://') && !url.startsWith('https://')) url = `https://${url}`;\n  try {\n    new URL(url);\n    return url;\n  } catch {\n    return null;\n  }\n}\n\nfunction normalisePrice(value: unknown) {\n  const n = Number(value);\n  if (!Number.isFinite(n) || !Number.isInteger(n) || n < 1) return null;\n  return n;\n}\n\nfunction formatDate(dateStr: string) {\n  const date = new Date(dateStr);\n  return date.toLocaleDateString();\n}\n\nfunction formatTime(dateStr: string) {\n  const date = new Date(dateStr);\n  return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n}\n\nfunction formatDayLabel(day: string) {\n  const date = new Date(`${day}T00:00:00`);\n  return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\n}\n\nfunction formatDayInput(date: Date) {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\nfunction capitalize(value: string) {\n  if (!value) return value;\n  return value.charAt(0).toUpperCase() + value.slice(1);\n}\n\nfunction hashString(input: string) {\n  let hash = 0;\n  for (let i = 0; i < input.length; i += 1) {\n    hash = (hash << 5) - hash + input.charCodeAt(i);\n    hash |= 0;\n  }\n  return Math.abs(hash);\n}\n\nfunction shortenUrl(url: string) {\n  try {\n    const parsed = new URL(url);\n    return parsed.hostname.replace(/^www\\./, '');\n  } catch {\n    return url;\n  }\n}\n\nfunction faviconUrl(url: string) {\n  const domain = shortenUrl(url);\n  return `https://www.google.com/s2/favicons?domain=${encodeURIComponent(domain)}&sz=64`;\n}\n\nfunction thumbUrl(url: string) {\n  return `https://image.thum.io/get/width/640/${encodeURIComponent(url)}`;\n}\n\nexport default function Library({ api }: Props) {\n  const [items, setItems] = useState<LibraryItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState<LibraryPurpose | 'all'>('replace');\n  const [pricedOnly, setPricedOnly] = useState(false);\n  const [viewMode, setViewMode] = useState<'library' | 'history'>('library');\n  const [historyDay, setHistoryDay] = useState(() => formatDayInput(new Date()));\n  const [historyEntries, setHistoryEntries] = useState<ConsumptionLogEntry[]>([]);\n  const [historyDays, setHistoryDays] = useState<ConsumptionDaySummary[]>([]);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  const [historyError, setHistoryError] = useState<string | null>(null);\n\n  const [isAdding, setIsAdding] = useState(false);\n  const [newUrl, setNewUrl] = useState('');\n  const [newPurpose, setNewPurpose] = useState<LibraryPurpose>('replace');\n  const [newPriceEnabled, setNewPriceEnabled] = useState(false);\n  const [newPrice, setNewPrice] = useState(12);\n  const [newTitle, setNewTitle] = useState('');\n  const [newNote, setNewNote] = useState('');\n  const [newPublic, setNewPublic] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const [editingId, setEditingId] = useState<number | null>(null);\n  const [editPurpose, setEditPurpose] = useState<LibraryPurpose>('replace');\n  const [editPriceEnabled, setEditPriceEnabled] = useState(false);\n  const [editPrice, setEditPrice] = useState(12);\n  const [editTitle, setEditTitle] = useState('');\n  const [editNote, setEditNote] = useState('');\n  const [editPublic, setEditPublic] = useState(false);\n  const [editError, setEditError] = useState<string | null>(null);\n\n  const [isSaving, setIsSaving] = useState(false);\n\n  const loadItems = useCallback(async () => {\n    try {\n      const data = await api.library.list();\n      setItems(data);\n      if (editingId && !data.some((item) => item.id === editingId)) {\n        setEditingId(null);\n      }\n    } catch (err) {\n      console.error('Failed to load library items:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [api.library, editingId]);\n\n  const loadHistory = useCallback(async (day: string) => {\n    setHistoryLoading(true);\n    setHistoryError(null);\n    try {\n      const [entries, days] = await Promise.all([\n        api.history.list(day),\n        api.history.days(30)\n      ]);\n      setHistoryEntries(entries);\n      setHistoryDays(days);\n    } catch (err) {\n      console.error('Failed to load consumption history:', err);\n      setHistoryError((err as Error).message || 'Failed to load history');\n    } finally {\n      setHistoryLoading(false);\n    }\n  }, [api.history]);\n\n  useEffect(() => {\n    loadItems();\n  }, [loadItems]);\n\n  useEffect(() => {\n    if (viewMode !== 'history') return;\n    loadHistory(historyDay);\n  }, [historyDay, loadHistory, viewMode]);\n\n  useEffect(() => {\n    const unsub = api.events.on('library:changed', () => loadItems());\n    return () => unsub();\n  }, [api, loadItems]);\n\n  useEffect(() => {\n    if (viewMode === 'history') {\n      setIsAdding(false);\n    }\n  }, [viewMode]);\n\n  const visible = useMemo(() => {\n    let next = filter === 'all' ? items : items.filter((item) => item.purpose === filter);\n    if (pricedOnly) next = next.filter((item) => typeof item.price === 'number');\n    return next;\n  }, [filter, items, pricedOnly]);\n\n  const resetAddForm = () => {\n    setNewUrl('');\n    setNewPurpose('replace');\n    setNewPriceEnabled(false);\n    setNewPrice(12);\n    setNewTitle('');\n    setNewNote('');\n    setNewPublic(false);\n    setError(null);\n  };\n\n  const handleAdd = async (event: React.FormEvent) => {\n    event.preventDefault();\n    setError(null);\n\n    const url = normaliseUrl(newUrl);\n    if (!url) return setError('Enter a valid URL (e.g. https://example.com).');\n\n    let price: number | null | undefined = null;\n    if (newPurpose === 'allow' && newPriceEnabled) {\n      const n = normalisePrice(newPrice);\n      if (!n) return setError('Unlock price must be a whole number of at least 1.');\n      price = n;\n    }\n\n    setIsSaving(true);\n    try {\n      await api.library.add({\n        kind: 'url',\n        url,\n        title: newTitle.trim() || undefined,\n        note: newNote.trim() || undefined,\n        purpose: newPurpose,\n        price,\n        isPublic: newPublic\n      });\n      setIsAdding(false);\n      resetAddForm();\n      await loadItems();\n    } catch (err) {\n      setError((err as Error).message || 'Failed to add item');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const startEdit = (item: LibraryItem) => {\n    setEditingId(item.id);\n    setEditPurpose(item.purpose);\n    setEditPriceEnabled(typeof item.price === 'number');\n    setEditPrice(typeof item.price === 'number' ? item.price : 12);\n    setEditTitle(item.title ?? '');\n    setEditNote(item.note ?? '');\n    setEditPublic(Boolean(item.isPublic));\n    setEditError(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditError(null);\n  };\n\n  const handleUpdate = async (event: React.FormEvent) => {\n    event.preventDefault();\n    if (!editingId) return;\n    setEditError(null);\n\n    let price: number | null | undefined = null;\n    if (editPurpose === 'allow' && editPriceEnabled) {\n      const n = normalisePrice(editPrice);\n      if (!n) return setEditError('Unlock price must be a whole number of at least 1.');\n      price = n;\n    }\n\n    setIsSaving(true);\n    try {\n      const title = editTitle.trim();\n      const note = editNote.trim();\n      await api.library.update(editingId, {\n        title: title ? title : null,\n        note: note ? note : null,\n        purpose: editPurpose,\n        price,\n        isPublic: editPublic\n      });\n      setEditingId(null);\n      await loadItems();\n    } catch (err) {\n      setEditError((err as Error).message || 'Failed to update item');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleRemove = async (id: number) => {\n    if (!confirm('Remove this item from your library?')) return;\n    try {\n      await api.library.remove(id);\n      await loadItems();\n    } catch (err) {\n      console.error('Failed to remove library item:', err);\n    }\n  };\n\n  const handleToggleConsumed = async (item: LibraryItem) => {\n    setIsSaving(true);\n    try {\n      const next = item.consumedAt ? null : new Date().toISOString();\n      await api.library.update(item.id, { consumedAt: next });\n      await loadItems();\n    } catch (err) {\n      console.error('Failed to update consumed status:', err);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  if (loading) {\n    return <div className=\"panel\">Loading library...</div>;\n  }\n\n  return (\n    <section className=\"page store-page\">\n      <header className=\"page-header\">\n        <div>\n          <h1>Library</h1>\n          <p className=\"subtle\">\n            {viewMode === 'history'\n              ? 'Review what you consumed by day ‚Äî productive items and frivolous sessions.'\n              : 'A calm, curated pool of ‚Äúwhat I meant to do‚Äù. Replace is what the paywall offers you first.'}\n          </p>\n          <div className=\"library-tabs\">\n            <button\n              type=\"button\"\n              className={`library-tab ${viewMode === 'library' ? 'active' : ''}`}\n              onClick={() => setViewMode('library')}\n            >\n              Library\n            </button>\n            <button\n              type=\"button\"\n              className={`library-tab ${viewMode === 'history' ? 'active' : ''}`}\n              onClick={() => setViewMode('history')}\n            >\n              History\n            </button>\n          </div>\n        </div>\n        {viewMode === 'library' && (\n          <button className=\"primary\" onClick={() => setIsAdding(true)}>\n            + Add Link\n          </button>\n        )}\n      </header>\n\n      {viewMode === 'library' && (\n        <>\n          <div className=\"card\">\n            <div className=\"settings-grid\" style={{ gridTemplateColumns: '1fr auto', gap: 14 }}>\n              <label>\n                View\n                <select value={filter} onChange={(e) => setFilter(e.target.value as any)} disabled={isSaving}>\n                  <option value=\"replace\">Replace</option>\n                  <option value=\"productive\">Productive</option>\n                  <option value=\"allow\">Allow</option>\n                  <option value=\"temptation\">Temptation</option>\n                  <option value=\"all\">All</option>\n                </select>\n              </label>\n              <label style={{ display: 'flex', gap: 10, alignItems: 'center', marginTop: 22 }}>\n                <input type=\"checkbox\" checked={pricedOnly} onChange={(e) => setPricedOnly(e.target.checked)} disabled={isSaving} />\n                <span className=\"subtle\">Priced only</span>\n              </label>\n            </div>\n            <p className=\"subtle\" style={{ marginTop: 8 }}>\n              {filter === 'all' ? 'All library items.' : PURPOSES.find((p) => p.value === filter)?.hint}\n            </p>\n          </div>\n\n          {isAdding && (\n            <div className=\"card add-item-form\">\n              <h3>Add to Library</h3>\n              <form onSubmit={handleAdd}>\n                {error && <p className=\"error-text\">{error}</p>}\n                <div className=\"form-group\">\n                  <label>URL</label>\n                  <input type=\"text\" placeholder=\"https://‚Ä¶\" value={newUrl} onChange={(e) => setNewUrl(e.target.value)} disabled={isSaving} />\n                </div>\n                <div className=\"form-group\">\n                  <label>Purpose</label>\n                  <select\n                    value={newPurpose}\n                    onChange={(e) => {\n                      const purpose = e.target.value as LibraryPurpose;\n                      setNewPurpose(purpose);\n                      if (purpose !== 'allow') setNewPriceEnabled(false);\n                    }}\n                    disabled={isSaving}\n                  >\n                    {PURPOSES.map((p) => (\n                      <option key={p.value} value={p.value}>\n                        {p.label}\n                      </option>\n                    ))}\n                  </select>\n                  <p className=\"subtle\" style={{ marginTop: 8 }}>{PURPOSES.find((p) => p.value === newPurpose)?.hint}</p>\n                </div>\n                <div className=\"form-group\">\n                  <label style={{ display: 'flex', gap: 10, alignItems: 'center' }}>\n                    <input\n                      type=\"checkbox\"\n                      checked={newPriceEnabled}\n                      disabled={isSaving || newPurpose !== 'allow'}\n                      onChange={(e) => setNewPriceEnabled(e.target.checked)}\n                    />\n                    One-time unlock price (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    min={1}\n                    max={500}\n                    step={1}\n                    value={newPrice}\n                    disabled={isSaving || newPurpose !== 'allow' || !newPriceEnabled}\n                    onChange={(e) => {\n                      const next = Number.parseInt(e.target.value, 10);\n                      setNewPrice(Number.isNaN(next) ? 1 : next);\n                    }}\n                  />\n                  <p className=\"subtle\" style={{ marginTop: 8 }}>\n                    Pricing only applies to <strong>Allow</strong> items. It appears under ‚ÄúProceed anyway‚Äù when you land on that exact URL.\n                  </p>\n                </div>\n                <div className=\"form-group\">\n                  <label>Title (optional)</label>\n                  <input type=\"text\" value={newTitle} onChange={(e) => setNewTitle(e.target.value)} disabled={isSaving} />\n                </div>\n                <div className=\"form-group\">\n                  <label>Note (optional)</label>\n                  <textarea value={newNote} onChange={(e) => setNewNote(e.target.value)} disabled={isSaving} />\n                </div>\n                <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                  <label style={{ display: 'flex', gap: 10, alignItems: 'center' }}>\n                    <input\n                      type=\"checkbox\"\n                      checked={newPublic}\n                      disabled={isSaving}\n                      onChange={(e) => setNewPublic(e.target.checked)}\n                    />\n                    Share with friends (public)\n                  </label>\n                  <p className=\"subtle\" style={{ margin: 0 }}>Only friends will see this in their feeds.</p>\n                </div>\n                <div className=\"form-actions\">\n                  <button\n                    type=\"button\"\n                    className=\"ghost\"\n                    onClick={() => {\n                      setIsAdding(false);\n                      resetAddForm();\n                    }}\n                    disabled={isSaving}\n                  >\n                    Cancel\n                  </button>\n                  <button type=\"submit\" className=\"primary\" disabled={isSaving}>\n                    Add\n                  </button>\n                </div>\n              </form>\n            </div>\n          )}\n\n          {visible.length === 0 ? (\n            <div className=\"empty-state\">\n              <p>No items here yet.</p>\n              <p className=\"subtle\">Tip: right-click a page or link and ‚ÄúSave to TimeWellSpent‚Äù.</p>\n            </div>\n          ) : (\n            <div className=\"library-grid\">\n              {visible.map((item) => {\n                const title = item.title || item.domain || item.app || 'Saved item';\n                const subtitle = item.note || (item.url ? shortenUrl(item.url) : item.app || item.domain || '');\n                const urlLabel = item.url ? shortenUrl(item.url) : '';\n                const icon = item.url ? faviconUrl(item.url) : null;\n                const cover = item.url ? thumbUrl(item.url) : null;\n                const coverSeed = item.domain ?? item.app ?? title;\n                const coverHue = hashString(coverSeed) % 360;\n                const coverStyle = { '--cover-hue': `${coverHue}` } as React.CSSProperties;\n                const coverInitial = title.trim().charAt(0).toUpperCase() || 'T';\n                const isEditing = editingId === item.id;\n                const doneLabel = item.consumedAt ? 'Unmark done' : 'Mark done';\n\n                return (\n                  <article key={item.id} className={`card library-card ${item.consumedAt ? 'is-done' : ''}`}>\n                    <div className={`library-thumb ${item.kind === 'app' ? 'app' : ''}`} style={coverStyle}>\n                      {cover && item.kind === 'url' && (\n                        <img\n                          src={cover}\n                          alt=\"\"\n                          loading=\"lazy\"\n                          onError={(event) => {\n                            event.currentTarget.style.display = 'none';\n                          }}\n                        />\n                      )}\n                      <div className=\"library-thumb-fallback\">\n                        <span>{coverInitial}</span>\n                        {item.kind === 'app' && <small>App</small>}\n                      </div>\n                      {icon ? (\n                        <img className=\"library-favicon\" src={icon} alt=\"\" loading=\"lazy\" />\n                      ) : (\n                        <div className=\"library-favicon library-favicon-placeholder\" aria-hidden=\"true\" />\n                      )}\n                      {item.consumedAt && (\n                        <div className=\"library-done-badge\" title=\"Completed\">\n                          ‚úì\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"library-body\">\n                      <div className=\"library-title-row\">\n                        <div>\n                          <h3>{title}</h3>\n                          <p className=\"subtle\">{subtitle}</p>\n                        </div>\n                        <span className={`pill ${purposeTone(item.purpose)}`}>{purposeLabel(item.purpose)}</span>\n                      </div>\n\n                      <div className=\"library-meta\">\n                        <span>{urlLabel || item.app || 'Saved item'}</span>\n                        {typeof item.price === 'number' && <span>{item.price} f-coins unlock</span>}\n                        {item.isPublic && <span>Public to friends</span>}\n                        {item.kind === 'app' && <span>Desktop app</span>}\n                      </div>\n\n                      <div className=\"library-dates\">\n                        <span>Added {formatDate(item.createdAt)}</span>\n                        {item.consumedAt\n                          ? <span>Done {formatDate(item.consumedAt)}</span>\n                          : item.lastUsedAt\n                            ? <span>Last used {formatDate(item.lastUsedAt)}</span>\n                            : <span>Not used yet</span>}\n                      </div>\n\n                      <div className=\"library-actions\">\n                        {item.url ? (\n                          <a\n                            href={item.url}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"icon-button\"\n                            title=\"Open link\"\n                            aria-label=\"Open link\"\n                          >\n                            <IconOpen />\n                          </a>\n                        ) : (\n                          <button className=\"icon-button\" type=\"button\" disabled title=\"Open link\" aria-label=\"Open link\">\n                            <IconOpen />\n                          </button>\n                        )}\n                        <button\n                          className=\"icon-button\"\n                          type=\"button\"\n                          onClick={() => handleToggleConsumed(item)}\n                          disabled={isSaving}\n                          title={doneLabel}\n                          aria-label={doneLabel}\n                        >\n                          <IconCheck />\n                        </button>\n                        {isEditing ? (\n                          <button className=\"icon-button\" onClick={cancelEdit} disabled={isSaving} title=\"Cancel edit\" aria-label=\"Cancel edit\">\n                            X\n                          </button>\n                        ) : (\n                          <button className=\"icon-button\" onClick={() => startEdit(item)} disabled={isSaving} title=\"Edit\" aria-label=\"Edit\">\n                            <IconEdit />\n                          </button>\n                        )}\n                        <button\n                          className=\"icon-button danger\"\n                          onClick={() => handleRemove(item.id)}\n                          disabled={isSaving}\n                          title=\"Remove\"\n                          aria-label=\"Remove\"\n                        >\n                          <IconTrash />\n                        </button>\n                      </div>\n\n                      {isEditing && (\n                        <form className=\"library-edit\" onSubmit={handleUpdate}>\n                          {editError && <p className=\"error-text\">{editError}</p>}\n                          <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                            <label>Purpose</label>\n                            <select\n                              value={editPurpose}\n                              onChange={(e) => {\n                                const purpose = e.target.value as LibraryPurpose;\n                                setEditPurpose(purpose);\n                                if (purpose !== 'allow') setEditPriceEnabled(false);\n                              }}\n                              disabled={isSaving}\n                            >\n                              {PURPOSES.map((p) => (\n                                <option key={p.value} value={p.value}>\n                                  {p.label}\n                                </option>\n                              ))}\n                            </select>\n                            <p className=\"subtle\" style={{ margin: 0 }}>{PURPOSES.find((p) => p.value === editPurpose)?.hint}</p>\n                          </div>\n\n                          <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                            <label style={{ display: 'flex', gap: 10, alignItems: 'center' }}>\n                              <input\n                                type=\"checkbox\"\n                                checked={editPriceEnabled}\n                                disabled={isSaving || editPurpose !== 'allow'}\n                                onChange={(e) => setEditPriceEnabled(e.target.checked)}\n                              />\n                              One-time unlock price (optional)\n                            </label>\n                            <input\n                              type=\"number\"\n                              min={1}\n                              max={500}\n                              step={1}\n                              value={editPrice}\n                              disabled={isSaving || editPurpose !== 'allow' || !editPriceEnabled}\n                              onChange={(e) => {\n                                const next = Number.parseInt(e.target.value, 10);\n                                setEditPrice(Number.isNaN(next) ? 1 : next);\n                              }}\n                            />\n                          </div>\n\n                          <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                            <label>Title</label>\n                            <input type=\"text\" value={editTitle} onChange={(e) => setEditTitle(e.target.value)} disabled={isSaving} />\n                          </div>\n\n                          <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                            <label>Note</label>\n                            <textarea value={editNote} onChange={(e) => setEditNote(e.target.value)} disabled={isSaving} />\n                          </div>\n                          <div className=\"form-group\" style={{ marginBottom: 0 }}>\n                            <label style={{ display: 'flex', gap: 10, alignItems: 'center' }}>\n                              <input\n                                type=\"checkbox\"\n                                checked={editPublic}\n                                disabled={isSaving || item.kind === 'app'}\n                                onChange={(e) => setEditPublic(e.target.checked)}\n                              />\n                              Share with friends (public)\n                            </label>\n                            <p className=\"subtle\" style={{ margin: 0 }}>Only friends will see this in their feeds.</p>\n                          </div>\n\n                          <div className=\"form-actions\" style={{ justifyContent: 'flex-end' }}>\n                            <button type=\"submit\" className=\"primary\" disabled={isSaving}>\n                              Save\n                            </button>\n                          </div>\n                        </form>\n                      )}\n                    </div>\n                  </article>\n                );\n              })}\n            </div>\n          )}\n        </>\n      )}\n\n      {viewMode === 'history' && (\n        <div className=\"card history-card\">\n          <div className=\"history-header\">\n            <div>\n              <h2>Consumption log</h2>\n              <p className=\"subtle\">Productive items and frivolous sessions you opened each day.</p>\n            </div>\n            <label className=\"history-picker\">\n              Day\n              <input\n                type=\"date\"\n                value={historyDay}\n                onChange={(event) => setHistoryDay(event.target.value)}\n              />\n            </label>\n          </div>\n\n          {historyDays.length > 0 && (\n            <div className=\"history-days\">\n              {historyDays.map((day) => (\n                <button\n                  key={day.day}\n                  type=\"button\"\n                  className={`history-day ${day.day === historyDay ? 'active' : ''}`}\n                  onClick={() => setHistoryDay(day.day)}\n                >\n                  <span>{formatDayLabel(day.day)}</span>\n                  <span className=\"history-day-count\">{day.count}</span>\n                </button>\n              ))}\n            </div>\n          )}\n\n          {historyLoading ? (\n            <div className=\"subtle\">Loading history‚Ä¶</div>\n          ) : historyError ? (\n            <div className=\"error-text\">{historyError}</div>\n          ) : historyEntries.length === 0 ? (\n            <div className=\"empty-state\">\n              <p>No entries for this day yet.</p>\n              <p className=\"subtle\">Mark items as consumed or open a session to see them here.</p>\n            </div>\n          ) : (\n            <ul className=\"history-list\">\n              {historyEntries.map((entry) => {\n                const isSession = entry.kind === 'frivolous-session';\n                const purpose = typeof entry.meta?.purpose === 'string' ? entry.meta.purpose : null;\n                const tone = purpose === 'temptation' ? 'frivolity' : purpose === 'productive' || purpose === 'replace' ? 'productive' : 'neutral';\n                const pillClass = isSession ? 'pill frivolity' : `pill ${tone}`;\n                const title = entry.title ?? entry.domain ?? 'Untitled';\n                const subtitle = isSession\n                  ? `Mode ${entry.meta?.mode ?? 'session'}`\n                  : entry.url ?? entry.domain ?? 'Library item';\n                const sessionMode = typeof entry.meta?.mode === 'string' ? entry.meta.mode : null;\n                const label = isSession\n                  ? sessionMode === 'store'\n                    ? 'Store unlock'\n                    : 'Frivolous session'\n                  : purpose\n                    ? `${capitalize(purpose)} item`\n                    : 'Library item';\n                return (\n                  <li key={entry.id} className=\"history-item\">\n                    <div className=\"history-time\">{formatTime(entry.occurredAt)}</div>\n                    <div className=\"history-main\">\n                      <strong>{title}</strong>\n                      <span className=\"subtle\">{subtitle}</span>\n                    </div>\n                    <div className=\"history-actions\">\n                      <span className={pillClass}>{label}</span>\n                      {entry.url && (\n                        <a className=\"ghost\" href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                          Open\n                        </a>\n                      )}\n                    </div>\n                  </li>\n                );\n              })}\n            </ul>\n          )}\n        </div>\n      )}\n    </section>\n  );\n}\n\nfunction IconOpen() {\n  return (\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M14 4h6v6M10 14l10-10M20 14v4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h4\" />\n    </svg>\n  );\n}\n\nfunction IconCheck() {\n  return (\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M5 13l4 4L19 7\" />\n    </svg>\n  );\n}\n\nfunction IconEdit() {\n  return (\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M4 20h4l10-10-4-4L4 16v4zM14 6l4 4\" />\n    </svg>\n  );\n}\n\nfunction IconTrash() {\n  return (\n    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path d=\"M6 7h12M9 7V5h6v2M8 7l1 12h6l1-12\" />\n    </svg>\n  );\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport type { FriendConnection, FriendLibraryItem, FriendProfile, FriendRequest, FriendSummary, FriendTimeline, RendererApi, TrophyStatus } from '@shared/types';\nimport FriendDetailModal from './FriendDetailModal';\n\ntype Props = {\n  api: RendererApi;\n};\n\nfunction normalizeHandle(raw: string) {\n  const trimmed = raw.trim().replace(/^@/, '');\n  return trimmed.toLowerCase();\n}\n\nfunction formatHoursFromSeconds(seconds: number) {\n  const hours = seconds / 3600;\n  return hours >= 10 ? `${hours.toFixed(0)}h` : `${hours.toFixed(1)}h`;\n}\n\nfunction formatPct(n: number) {\n  return `${Math.max(0, Math.min(100, Math.round(n)))}%`;\n}\n\nfunction formatMinutes(seconds: number) {\n  return `${Math.round(seconds / 60)}m`;\n}\n\nfunction formatCount(value?: number | null) {\n  if (typeof value !== 'number') return '‚Äî';\n  return String(value);\n}\n\nfunction headToHeadPercent(me: FriendSummary | null, friend: FriendSummary | null) {\n  const myProductive = me?.categoryBreakdown.productive ?? 0;\n  const friendProductive = friend?.categoryBreakdown.productive ?? 0;\n  const total = myProductive + friendProductive;\n  if (total === 0) return 50;\n  return Math.round((myProductive / total) * 100);\n}\n\nexport default function Friends({ api }: Props) {\n  const [profile, setProfile] = useState<FriendProfile | null>(null);\n  const [friends, setFriends] = useState<FriendConnection[]>([]);\n  const [requests, setRequests] = useState<{ incoming: FriendRequest[]; outgoing: FriendRequest[] }>({ incoming: [], outgoing: [] });\n  const [summaries, setSummaries] = useState<Record<string, FriendSummary>>({});\n  const [mySummary, setMySummary] = useState<FriendSummary | null>(null);\n  const [myProfile, setMyProfile] = useState<FriendProfile | null>(null);\n  const [selectedFriend, setSelectedFriend] = useState<FriendConnection | null>(null);\n  const [selectedTimeline, setSelectedTimeline] = useState<FriendTimeline | null>(null);\n  const [selectedPublicLibrary, setSelectedPublicLibrary] = useState<FriendLibraryItem[]>([]);\n  const [detailOpen, setDetailOpen] = useState(false);\n  const [trophies, setTrophies] = useState<TrophyStatus[]>([]);\n  const [handleInput, setHandleInput] = useState('');\n  const [addHandle, setAddHandle] = useState('');\n  const [handlePreview, setHandlePreview] = useState<FriendProfile | null>(null);\n  const [busy, setBusy] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [syncReady, setSyncReady] = useState(false);\n  const [competitiveOptIn, setCompetitiveOptIn] = useState(false);\n\n  async function refreshAll() {\n    setError(null);\n    try {\n      const status = await api.sync.status();\n      const ready = status.configured && status.authenticated;\n      setSyncReady(ready);\n      if (!ready) return;\n      const [profileResult, friendResult, requestResult, summaryResult, mySummaryResult, trophyResult, competitive] = await Promise.all([\n        api.friends.profile(),\n        api.friends.list(),\n        api.friends.requests(),\n        api.friends.summaries(24),\n        api.friends.meSummary(24),\n        api.trophies.list(),\n        api.settings.competitiveOptIn()\n      ]);\n      setProfile(profileResult);\n      setMyProfile(profileResult);\n      setHandleInput(profileResult?.handle ?? '');\n      setFriends(friendResult);\n      setRequests(requestResult);\n      setSummaries(summaryResult);\n      setMySummary(mySummaryResult);\n      setTrophies(trophyResult);\n      setCompetitiveOptIn(competitive);\n    } catch (err) {\n      console.error(err);\n      setError((err as Error).message);\n    }\n  }\n\n  useEffect(() => {\n    refreshAll();\n  }, []);\n\n  const friendCards = useMemo(() => {\n    return friends.map((friend) => {\n      const summary = summaries[friend.userId];\n      const totals = summary?.categoryBreakdown ?? null;\n      const active = summary?.totalActiveSeconds ?? 0;\n      const draining = totals?.draining ?? 0;\n      const productivePct = active > 0 ? (totals!.productive / active) * 100 : 0;\n      const neutralPct = active > 0 ? (totals!.neutral / active) * 100 : 0;\n      const frivolityPct = active > 0 ? (totals!.frivolity / active) * 100 : 0;\n      const drainingPct = active > 0 ? (draining / active) * 100 : 0;\n      return { friend, summary, totals, productivePct, neutralPct, frivolityPct, drainingPct };\n    });\n  }, [friends, summaries]);\n\n  const trophyById = useMemo(() => {\n    const map = new Map<string, TrophyStatus>();\n    trophies.forEach((trophy) => map.set(trophy.id, trophy));\n    return map;\n  }, [trophies]);\n\n  async function updateHandle() {\n    setError(null);\n    setBusy(true);\n    try {\n      const updated = await api.friends.updateProfile({ handle: normalizeHandle(handleInput) });\n      setProfile(updated);\n      setHandleInput(updated.handle ?? '');\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function previewHandle() {\n    setHandlePreview(null);\n    const normalized = normalizeHandle(addHandle);\n    if (!normalized) return;\n    try {\n      const result = await api.friends.findByHandle(normalized);\n      setHandlePreview(result);\n    } catch {\n      setHandlePreview(null);\n    }\n  }\n\n  async function sendRequest() {\n    setError(null);\n    setBusy(true);\n    try {\n      await api.friends.request(normalizeHandle(addHandle));\n      setAddHandle('');\n      setHandlePreview(null);\n      await refreshAll();\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function acceptRequest(id: string) {\n    setBusy(true);\n    setError(null);\n    try {\n      await api.friends.accept(id);\n      await refreshAll();\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function declineRequest(id: string) {\n    setBusy(true);\n    setError(null);\n    try {\n      await api.friends.decline(id);\n      await refreshAll();\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function cancelRequest(id: string) {\n    setBusy(true);\n    setError(null);\n    try {\n      await api.friends.cancel(id);\n      await refreshAll();\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function removeFriend(id: string) {\n    if (!confirm('Remove this friend?')) return;\n    setBusy(true);\n    setError(null);\n    try {\n      await api.friends.remove(id);\n      await refreshAll();\n    } catch (err) {\n      setError((err as Error).message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function openFriendDetail(friend: FriendConnection) {\n    setSelectedFriend(friend);\n    setSelectedTimeline(null);\n    setSelectedPublicLibrary([]);\n    setDetailOpen(true);\n    try {\n      const [timeline, publicLibrary] = await Promise.all([\n        api.friends.timeline(friend.userId, 24),\n        api.friends.publicLibrary(friend.userId, 168)\n      ]);\n      setSelectedTimeline(timeline);\n      setSelectedPublicLibrary(publicLibrary ?? []);\n    } catch (err) {\n      console.error('Failed to load friend detail', err);\n    }\n  }\n\n  async function toggleCompetitive(next: boolean) {\n    setCompetitiveOptIn(next);\n    try {\n      await api.settings.updateCompetitiveOptIn(next);\n    } catch (err) {\n      setError((err as Error).message || 'Failed to update preference');\n      setCompetitiveOptIn(!next);\n    }\n  }\n\n  if (!syncReady) {\n    return (\n      <section className=\"page store-page\">\n        <header className=\"page-header\">\n          <div>\n            <h1>Friends</h1>\n            <p className=\"subtle\">Add a friend by handle once you are signed in.</p>\n          </div>\n        </header>\n        <div className=\"card\">\n          <h3>Connect Sync</h3>\n          <p className=\"subtle\">Friends require Supabase auth. Go to Settings ‚Üí Cloud sync and connect.</p>\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"page store-page\">\n      <header className=\"page-header\">\n        <div>\n          <h1>Friends</h1>\n          <p className=\"subtle\">A low-key feed of daily focus ‚Äî aggregates only (no URLs).</p>\n        </div>\n        <div style={{ display: 'flex', gap: 10 }}>\n          <button className=\"ghost\" disabled={busy} onClick={refreshAll}>Refresh</button>\n        </div>\n      </header>\n\n      {error && <p className=\"error-text\">{error}</p>}\n\n      <div className=\"card settings-section\" style={{ marginBottom: 16 }}>\n        <div className=\"settings-section-header\">\n          <h3>Competitive view</h3>\n          <p className=\"subtle\" style={{ margin: 0 }}>Opt in to show winners/losers and head-to-head bars.</p>\n        </div>\n        <div className=\"settings-row\">\n          <label className=\"settings-inline\" style={{ alignItems: 'center' }}>\n            <input\n              type=\"checkbox\"\n              checked={competitiveOptIn}\n              onChange={(e) => toggleCompetitive(e.target.checked)}\n            />\n            <span className=\"subtle\">{competitiveOptIn ? 'Enabled' : 'Disabled'}</span>\n          </label>\n        </div>\n      </div>\n\n      <div className=\"card\" style={{ marginBottom: 16 }}>\n        <h3>Your handle</h3>\n        <div className=\"settings-grid\" style={{ gridTemplateColumns: '1fr auto', alignItems: 'end' }}>\n          <label>\n            Handle\n            <input\n              value={handleInput}\n              onChange={(e) => setHandleInput(e.target.value)}\n              placeholder=\"e.g. timewell\"\n            />\n          </label>\n          <button className=\"primary\" disabled={busy} onClick={updateHandle}>Update</button>\n        </div>\n        <p className=\"subtle\" style={{ marginTop: 8 }}>\n          Handles are lowercase letters, numbers, and underscores (3-20).\n        </p>\n      </div>\n\n      <div className=\"card\" style={{ marginBottom: 16 }}>\n        <h3>Add friend</h3>\n        <div className=\"settings-grid\" style={{ gridTemplateColumns: '1fr auto', alignItems: 'end' }}>\n          <label>\n            Friend handle\n            <input\n              value={addHandle}\n              onChange={(e) => setAddHandle(e.target.value)}\n              onBlur={previewHandle}\n              placeholder=\"@friend\"\n            />\n          </label>\n          <button className=\"primary\" disabled={busy || !addHandle.trim()} onClick={sendRequest}>Send request</button>\n        </div>\n        {handlePreview && (\n          <p className=\"subtle\" style={{ marginTop: 8 }}>\n            Found {handlePreview.displayName ?? handlePreview.handle ?? 'friend'}.\n          </p>\n        )}\n      </div>\n\n      {(requests.incoming.length > 0 || requests.outgoing.length > 0) && (\n        <div className=\"card\" style={{ marginBottom: 16 }}>\n          <h3>Requests</h3>\n          {requests.incoming.map((request) => (\n            <div key={request.id} className=\"device-row\" style={{ marginBottom: 8 }}>\n              <div>\n                <strong>{request.displayName ?? request.handle ?? 'Friend'}</strong>\n                <span className=\"subtle\">Incoming</span>\n              </div>\n              <div className=\"settings-actions\">\n                <button className=\"primary\" disabled={busy} onClick={() => acceptRequest(request.id)}>Accept</button>\n                <button className=\"ghost\" disabled={busy} onClick={() => declineRequest(request.id)}>Decline</button>\n              </div>\n            </div>\n          ))}\n          {requests.outgoing.map((request) => (\n            <div key={request.id} className=\"device-row\" style={{ marginBottom: 8 }}>\n              <div>\n                <strong>{request.displayName ?? request.handle ?? 'Friend'}</strong>\n                <span className=\"subtle\">Pending</span>\n              </div>\n              <div className=\"settings-actions\">\n                <button className=\"ghost\" disabled={busy} onClick={() => cancelRequest(request.id)}>Cancel</button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <div className=\"store-grid\">\n        {friends.length === 0 ? (\n          <div className=\"empty-state\">\n            <p>No friends yet.</p>\n            <p className=\"subtle\">Add a handle to start a tiny, supportive feed.</p>\n          </div>\n        ) : (\n          friendCards.map(({ friend, summary, totals, productivePct, neutralPct, frivolityPct, drainingPct }) => {\n            const friendTrophies = (friend.pinnedTrophies ?? [])\n              .map((id) => trophyById.get(id))\n              .filter((trophy): trophy is TrophyStatus => Boolean(trophy));\n            return (\n            <div key={friend.id} className=\"card store-item\">\n              <div className=\"store-item-headline\">\n                <div>\n                  <p className=\"store-item-domain\">{friend.displayName ?? friend.handle ?? 'Friend'}</p>\n                  <h3 className=\"store-item-title\">{summary ? `${summary.productivityScore}% productive` : 'No data yet'}</h3>\n                </div>\n                <div className=\"store-item-price-pill\">\n                  <strong>{summary ? formatHoursFromSeconds(summary.totalActiveSeconds) : '‚Äî'}</strong>\n                  <span>active</span>\n                </div>\n                {summary && (\n                  <div className=\"pill deepwork\" style={{ marginLeft: 'auto' }}>\n                    {formatMinutes(summary.deepWorkSeconds)} deep work\n                  </div>\n                )}\n              </div>\n\n              {competitiveOptIn ? (\n                <div className=\"head-to-head\">\n                  {summary ? (\n                    <>\n                      <div className=\"head-to-head-row\">\n                        <span>You</span>\n                        <span>{summary ? friend.displayName ?? friend.handle ?? 'Friend' : 'Friend'}</span>\n                      </div>\n                      <div className=\"head-to-head-bar fancy\">\n                        <span\n                          className=\"head-to-head-left\"\n                          style={{ width: `${headToHeadPercent(mySummary, summary)}%`, background: myProfile?.color ?? 'var(--accent)' }}\n                        />\n                        <span\n                          className=\"head-to-head-right\"\n                          style={{ width: `${100 - headToHeadPercent(mySummary, summary)}%`, background: friend.color ?? 'rgba(255, 255, 255, 0.3)' }}\n                        />\n                        <div className=\"head-to-head-glow\" />\n                      </div>\n                      <div className=\"head-to-head-row subtle\">\n                        <span>{formatMinutes(mySummary?.categoryBreakdown.productive ?? 0)} productive</span>\n                        <span>{formatMinutes(summary?.categoryBreakdown.productive ?? 0)} productive</span>\n                      </div>\n                      <div className=\"head-to-head-row subtle\">\n                        <span>{formatCount(mySummary?.emergencySessions)} emergency</span>\n                        <span>{formatCount(summary?.emergencySessions)} emergency</span>\n                      </div>\n                    </>\n                  ) : (\n                    <p className=\"subtle\" style={{ marginTop: 6 }}>\n                      Waiting for shared activity data.\n                    </p>\n                  )}\n                </div>\n              ) : (\n                <p className=\"subtle\" style={{ marginTop: 10 }}>Competitive view is off.</p>\n              )}\n\n              {friendTrophies.length > 0 && (\n                <div className=\"friends-trophies\">\n                  {friendTrophies.slice(0, 3).map((trophy) => (\n                    <span key={trophy.id} className=\"trophy-badge\">\n                      <span className=\"emoji\">{trophy.emoji}</span>\n                      {trophy.name}\n                    </span>\n                  ))}\n                </div>\n              )}\n\n              {summary && totals && (\n                <div style={{ marginTop: 10 }}>\n                  <div className=\"subtle\" style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <span>Productive</span><span>{formatHoursFromSeconds(totals.productive)} ({formatPct(productivePct)})</span>\n                  </div>\n                  <div className=\"impact-meter\" style={{ marginTop: 6 }}>\n                    <span style={{ width: `${productivePct}%`, background: 'var(--cat-productive)' }} />\n                  </div>\n\n                  <div className=\"subtle\" style={{ display: 'flex', justifyContent: 'space-between', marginTop: 10 }}>\n                    <span>Neutral</span><span>{formatHoursFromSeconds(totals.neutral)} ({formatPct(neutralPct)})</span>\n                  </div>\n                  <div className=\"impact-meter day\" style={{ marginTop: 6 }}>\n                    <span style={{ width: `${neutralPct}%`, background: 'var(--cat-neutral)' }} />\n                  </div>\n\n                  <div className=\"subtle\" style={{ display: 'flex', justifyContent: 'space-between', marginTop: 10 }}>\n                    <span>Frivolity</span><span>{formatHoursFromSeconds(totals.frivolity)} ({formatPct(frivolityPct)})</span>\n                  </div>\n                  <div className=\"impact-meter\" style={{ marginTop: 6 }}>\n                    <span style={{ width: `${frivolityPct}%`, background: 'var(--cat-frivolity)' }} />\n                  </div>\n\n                  <div className=\"subtle\" style={{ display: 'flex', justifyContent: 'space-between', marginTop: 10 }}>\n                    <span>Draining</span><span>{formatHoursFromSeconds(totals.draining ?? 0)} ({formatPct(drainingPct)})</span>\n                  </div>\n                  <div className=\"impact-meter\" style={{ marginTop: 6 }}>\n                    <span style={{ width: `${drainingPct}%`, background: 'var(--cat-draining)' }} />\n                  </div>\n                </div>\n              )}\n\n              <div className=\"store-item-meta\">\n                <span>Last update {summary ? new Date(summary.updatedAt).toLocaleString() : '‚Äî'}</span>\n                <span>@{friend.handle ?? 'no-handle'}</span>\n              </div>\n\n              <div className=\"store-item-actions\">\n                <button className=\"ghost\" disabled={busy} onClick={() => openFriendDetail(friend)}>Details</button>\n                <button className=\"ghost danger\" disabled={busy} onClick={() => removeFriend(friend.id)}>Remove</button>\n              </div>\n            </div>\n          );\n        })\n        )}\n      </div>\n\n      <FriendDetailModal\n        open={detailOpen}\n        friend={selectedFriend}\n        summary={selectedFriend ? summaries[selectedFriend.userId] ?? null : null}\n        timeline={selectedTimeline}\n        publicLibraryItems={selectedPublicLibrary}\n        trophies={trophies}\n        onClose={() => setDetailOpen(false)}\n      />\n    </section>\n  );\n}\n","import type { TrophyDefinition } from './types';\n\nexport const TROPHY_CATEGORY_LABELS: Record<TrophyDefinition['category'], string> = {\n  attention: 'Attention Control',\n  recovery: 'Recovery & Resilience',\n  streaks: 'Anti-Frivolity Streaks',\n  economy: 'Economy & Discipline',\n  library: 'Library & Intentionality',\n  time: 'Time-of-Day',\n  stability: 'Stability & Dynamics',\n  fun: 'Fun Flavor',\n  social: 'Social & Friends',\n  secret: 'Secret'\n};\n\nexport const TROPHY_DEFINITIONS: TrophyDefinition[] = [\n  // Attention Control\n  {\n    id: 'first_light',\n    name: 'First Light',\n    description: 'Log your very first productive minute.',\n    emoji: 'üåÖ',\n    category: 'attention',\n    rarity: 'common'\n  },\n  {\n    id: 'kept_the_thread',\n    name: 'Kept the Thread',\n    description: 'Stay productive for 30 minutes without switching context.',\n    emoji: 'üßµ',\n    category: 'attention',\n    rarity: 'common'\n  },\n  {\n    id: 'deep_pocket',\n    name: 'Deep Pocket',\n    description: 'Hit 60 minutes in a single productive run.',\n    emoji: 'ü™ô',\n    category: 'attention',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'monk_hour',\n    name: 'Monk Hour',\n    description: 'Hit 90 minutes in a single productive run.',\n    emoji: 'üßò',\n    category: 'attention',\n    rarity: 'rare'\n  },\n  {\n    id: 'cathedral',\n    name: 'Cathedral',\n    description: 'Log 3 hours of productive time in a 24h window.',\n    emoji: 'üèõÔ∏è',\n    category: 'attention',\n    rarity: 'rare'\n  },\n  {\n    id: 'stonecutter',\n    name: 'Stonecutter',\n    description: '5 consecutive days with 2 hours of productive time.',\n    emoji: '‚õèÔ∏è',\n    category: 'attention',\n    rarity: 'epic'\n  },\n  {\n    id: 'quiet_hands',\n    name: 'Quiet Hands',\n    description: 'Keep idle time under 10% in a 24h window.',\n    emoji: 'ü§≤',\n    category: 'attention',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'low_turbulence',\n    name: 'Low Turbulence',\n    description: 'Keep context switches under 3/hour for a full day.',\n    emoji: 'üõ´',\n    category: 'attention',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'flow_engineer',\n    name: 'Flow Engineer',\n    description: 'Set a new personal best productive run.',\n    emoji: 'üõ†Ô∏è',\n    category: 'attention',\n    rarity: 'rare'\n  },\n  {\n    id: 'second_brain',\n    name: 'Second Brain',\n    description: 'Complete 10 replace items instead of frivolity.',\n    emoji: 'üß†',\n    category: 'attention',\n    rarity: 'rare'\n  },\n\n  // Recovery & Resilience\n  {\n    id: 'bounce_back',\n    name: 'Bounce Back',\n    description: 'Return to productive within 10 minutes after frivolity.',\n    emoji: 'üèÄ',\n    category: 'recovery',\n    rarity: 'common'\n  },\n  {\n    id: 'elastic_mind',\n    name: 'Elastic Mind',\n    description: 'Improve your median recovery time vs last week.',\n    emoji: 'ü™¢',\n    category: 'recovery',\n    rarity: 'rare'\n  },\n  {\n    id: 'one_slip_no_slide',\n    name: 'One Slip, No Slide',\n    description: 'Only one frivolity session in a 24h window.',\n    emoji: 'üßä',\n    category: 'recovery',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'damage_control',\n    name: 'Damage Control',\n    description: 'Keep frivolity under 15 minutes in 24h.',\n    emoji: 'üßØ',\n    category: 'recovery',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'phoenix',\n    name: 'Phoenix',\n    description: 'Your best productive run begins after frivolity.',\n    emoji: 'üî•',\n    category: 'recovery',\n    rarity: 'rare'\n  },\n  {\n    id: 'cold_start',\n    name: 'Cold Start',\n    description: 'Start your day productive within 15 minutes.',\n    emoji: 'üßä',\n    category: 'recovery',\n    rarity: 'common'\n  },\n  {\n    id: 'soft_landing',\n    name: 'Soft Landing',\n    description: 'End the day with a recovery ritual after drift.',\n    emoji: 'üåô',\n    category: 'recovery',\n    rarity: 'rare'\n  },\n\n  // Anti-Frivolity Streaks\n  {\n    id: 'clean_24',\n    name: 'Clean 24',\n    description: '24 hours without frivolity.',\n    emoji: 'üßº',\n    category: 'streaks',\n    rarity: 'common'\n  },\n  {\n    id: 'two_day_glass',\n    name: 'Two-Day Glass',\n    description: '48 hours without frivolity.',\n    emoji: 'ü™ü',\n    category: 'streaks',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'three_day_gold',\n    name: 'Three-Day Gold',\n    description: '72 hours without frivolity.',\n    emoji: 'ü•á',\n    category: 'streaks',\n    rarity: 'rare'\n  },\n  {\n    id: 'week_of_steel',\n    name: 'Week of Steel',\n    description: '7 days without frivolity.',\n    emoji: 'üõ°Ô∏è',\n    category: 'streaks',\n    rarity: 'epic'\n  },\n  {\n    id: 'weekend_shield',\n    name: 'Weekend Shield',\n    description: 'No frivolity on Saturday and Sunday.',\n    emoji: 'üóìÔ∏è',\n    category: 'streaks',\n    rarity: 'rare'\n  },\n  {\n    id: 'temptation_tamer',\n    name: 'Temptation Tamer',\n    description: 'Decline frivolity when it shows up.',\n    emoji: 'üêç',\n    category: 'streaks',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'gate_held',\n    name: 'The Gate Held',\n    description: 'Reject 10 paywall prompts.',\n    emoji: 'üö™',\n    category: 'streaks',\n    rarity: 'rare'\n  },\n\n  // Economy & Discipline\n  {\n    id: 'no_spend_day',\n    name: 'No Spend Day',\n    description: 'Go 24 hours with zero frivolity spending.',\n    emoji: 'üí∏',\n    category: 'economy',\n    rarity: 'common'\n  },\n  {\n    id: 'under_budget',\n    name: 'Under Budget',\n    description: 'Stay under your daily frivolity budget for 7 days.',\n    emoji: 'üìâ',\n    category: 'economy',\n    rarity: 'rare'\n  },\n  {\n    id: 'high_yield',\n    name: 'High Yield',\n    description: 'Grow your balance 3 days in a row.',\n    emoji: 'üìà',\n    category: 'economy',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'investor',\n    name: 'Investor',\n    description: 'Hit a new all-time-high balance.',\n    emoji: 'üè¶',\n    category: 'economy',\n    rarity: 'rare'\n  },\n  {\n    id: 'escrow_master',\n    name: 'Escrow Master',\n    description: 'Complete 5 escrow contracts.',\n    emoji: 'üßæ',\n    category: 'economy',\n    rarity: 'rare'\n  },\n  {\n    id: 'iron_contract',\n    name: 'Iron Contract',\n    description: 'Complete a hard-stakes escrow.',\n    emoji: '‚öôÔ∏è',\n    category: 'economy',\n    rarity: 'epic'\n  },\n  {\n    id: 'debt_free',\n    name: 'Debt-Free',\n    description: 'Stay positive after clearing a penalty.',\n    emoji: 'üßø',\n    category: 'economy',\n    rarity: 'uncommon'\n  },\n\n  // Library & Intentionality\n  {\n    id: 'curator',\n    name: 'Curator',\n    description: 'Add 25 replace items to your library.',\n    emoji: 'üóÇÔ∏è',\n    category: 'library',\n    rarity: 'common'\n  },\n  {\n    id: 'librarian',\n    name: 'Librarian',\n    description: 'Mark 20 library items as done.',\n    emoji: 'üìö',\n    category: 'library',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'taste_upgrade',\n    name: 'Taste Upgrade',\n    description: 'Use the replace pool more this week than last.',\n    emoji: 'üçµ',\n    category: 'library',\n    rarity: 'rare'\n  },\n  {\n    id: 'clean_desk',\n    name: 'Clean Desk',\n    description: 'Keep 10+ replace items ready.',\n    emoji: 'üßπ',\n    category: 'library',\n    rarity: 'common'\n  },\n  {\n    id: 'gentle_redirect',\n    name: 'Gentle Redirect',\n    description: 'Choose replace items 10 times.',\n    emoji: 'üß≠',\n    category: 'library',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'completionist',\n    name: 'Completionist',\n    description: 'Finish 10 reading items.',\n    emoji: '‚úÖ',\n    category: 'library',\n    rarity: 'rare'\n  },\n\n  // Time-of-Day\n  {\n    id: 'morning_anchor',\n    name: 'Morning Anchor',\n    description: '30 productive minutes before 10am.',\n    emoji: 'üåÑ',\n    category: 'time',\n    rarity: 'common'\n  },\n  {\n    id: 'noon_navigator',\n    name: 'Noon Navigator',\n    description: 'Avoid frivolity during your riskiest hour.',\n    emoji: 'üß≠',\n    category: 'time',\n    rarity: 'rare'\n  },\n  {\n    id: 'afternoon_fortress',\n    name: 'Afternoon Fortress',\n    description: '2‚Äì5pm is 60% productive or more.',\n    emoji: 'üè∞',\n    category: 'time',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'night_watch',\n    name: 'Night Watch',\n    description: 'No frivolity after 9pm for 7 days.',\n    emoji: 'üïØÔ∏è',\n    category: 'time',\n    rarity: 'rare'\n  },\n  {\n    id: 'prime_time',\n    name: 'Prime Time',\n    description: 'Hit your best hour-of-day productivity again.',\n    emoji: '‚è±Ô∏è',\n    category: 'time',\n    rarity: 'uncommon'\n  },\n\n  // Stability & Dynamics\n  {\n    id: 'stable_orbit',\n    name: 'Stable Orbit',\n    description: 'Hourly productivity variance drops vs last week.',\n    emoji: 'ü™ê',\n    category: 'stability',\n    rarity: 'rare'\n  },\n  {\n    id: 'attractor_shift',\n    name: 'Attractor Shift',\n    description: 'Dominant state shifts from neutral to productive.',\n    emoji: 'üß≤',\n    category: 'stability',\n    rarity: 'rare'\n  },\n  {\n    id: 'signal_clarity',\n    name: 'Signal Clarity',\n    description: 'Flow stability stays high for 24h.',\n    emoji: 'üì°',\n    category: 'stability',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'low_drift',\n    name: 'Low Drift',\n    description: 'Neutral time under 25% with solid activity.',\n    emoji: 'üõ∞Ô∏è',\n    category: 'stability',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'anti_chaos',\n    name: 'Anti-Chaos',\n    description: 'Low idle + low context switches in 24h.',\n    emoji: 'üßØ',\n    category: 'stability',\n    rarity: 'rare'\n  },\n\n  // Fun Flavor\n  {\n    id: 'shield',\n    name: 'The Shield',\n    description: 'Hold the line after a paywall prompt.',\n    emoji: 'üõ°Ô∏è',\n    category: 'fun',\n    rarity: 'common'\n  },\n  {\n    id: 'lantern',\n    name: 'The Lantern',\n    description: 'Peek, then walk away.',\n    emoji: 'üèÆ',\n    category: 'fun',\n    rarity: 'rare'\n  },\n  {\n    id: 'compass',\n    name: 'The Compass',\n    description: 'Correct course 3 times in a day.',\n    emoji: 'üß≠',\n    category: 'fun',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'hourglass',\n    name: 'The Hourglass',\n    description: 'Log activity every day for 14 days.',\n    emoji: '‚è≥',\n    category: 'fun',\n    rarity: 'rare'\n  },\n  {\n    id: 'touch_grass',\n    name: 'Touch Grass',\n    description: 'Keep total screen time under 3 hours in a day.',\n    emoji: 'üåø',\n    category: 'fun',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'alchemist',\n    name: 'The Alchemist',\n    description: 'Flip a rough day into a strong tomorrow.',\n    emoji: '‚öóÔ∏è',\n    category: 'fun',\n    rarity: 'rare'\n  },\n  {\n    id: 'archivist',\n    name: 'The Archivist',\n    description: 'Add notes or purpose to 20 saved items.',\n    emoji: 'üóÑÔ∏è',\n    category: 'fun',\n    rarity: 'uncommon'\n  },\n\n  // Social & Friends\n  {\n    id: 'first_rival',\n    name: 'First Rival',\n    description: 'Add your first friend.',\n    emoji: 'ü§ù',\n    category: 'social',\n    rarity: 'common'\n  },\n  {\n    id: 'good_sport',\n    name: 'Good Sport',\n    description: 'Complete a head-to-head week challenge.',\n    emoji: 'üèÖ',\n    category: 'social',\n    rarity: 'rare'\n  },\n  {\n    id: 'comeback_kid',\n    name: 'Comeback Kid',\n    description: 'Lose a day, win the next.',\n    emoji: 'üéØ',\n    category: 'social',\n    rarity: 'rare'\n  },\n  {\n    id: 'unbeaten',\n    name: 'Unbeaten',\n    description: 'Win 5 daily comparisons in a row.',\n    emoji: 'ü•ä',\n    category: 'social',\n    rarity: 'epic'\n  },\n  {\n    id: 'patron',\n    name: 'Patron',\n    description: 'Send 10 focus boosts to friends.',\n    emoji: 'üéÅ',\n    category: 'social',\n    rarity: 'uncommon'\n  },\n  {\n    id: 'the_standard',\n    name: 'The Standard',\n    description: 'A friend views your profile often.',\n    emoji: 'üèÅ',\n    category: 'social',\n    rarity: 'rare'\n  },\n\n  // Secret\n  {\n    id: 'narrow_escape',\n    name: 'The Narrow Escape',\n    description: 'Proceed anyway, but exit within 60 seconds.',\n    emoji: 'üèÉ',\n    category: 'secret',\n    rarity: 'secret',\n    secret: true\n  },\n  {\n    id: 'librarians_revenge',\n    name: \"The Librarian's Revenge\",\n    description: 'Open 3 reading items within 10 minutes of a paywall.',\n    emoji: 'üìñ',\n    category: 'secret',\n    rarity: 'secret',\n    secret: true\n  },\n  {\n    id: 'zero_hour',\n    name: 'Zero Hour',\n    description: 'Set your lowest idle ratio ever.',\n    emoji: 'üï≥Ô∏è',\n    category: 'secret',\n    rarity: 'secret',\n    secret: true\n  },\n  {\n    id: 'glass_cannon',\n    name: 'Glass Cannon',\n    description: 'Huge focus run with chaotic switching.',\n    emoji: 'üß®',\n    category: 'secret',\n    rarity: 'secret',\n    secret: true\n  },\n  {\n    id: 'surgical_strike',\n    name: 'Surgical Strike',\n    description: 'One focused session completes the day‚Äôs plan.',\n    emoji: 'ü©∫',\n    category: 'secret',\n    rarity: 'secret',\n    secret: true\n  }\n];\n","import { useEffect, useMemo, useState } from 'react';\nimport type { RendererApi, TrophyProfileSummary, TrophyStatus } from '@shared/types';\nimport { TROPHY_CATEGORY_LABELS } from '@shared/trophies';\n\ntype Props = {\n  api: RendererApi;\n};\n\nconst MAX_PINNED = 6;\n\nfunction formatMinutes(value: number) {\n  return `${Math.round(value)}m`;\n}\n\nfunction formatHours(value: number) {\n  return value >= 10 ? `${value.toFixed(0)}h` : `${value.toFixed(1)}h`;\n}\n\nexport default function Profile({ api }: Props) {\n  const [summary, setSummary] = useState<TrophyProfileSummary | null>(null);\n  const [trophies, setTrophies] = useState<TrophyStatus[]>([]);\n  const [previewMode, setPreviewMode] = useState(false);\n  const [busy, setBusy] = useState(false);\n\n  const refresh = async () => {\n    const [profileSummary, statuses] = await Promise.all([\n      api.trophies.profile(),\n      api.trophies.list()\n    ]);\n    setSummary(profileSummary);\n    setTrophies(statuses);\n  };\n\n  useEffect(() => {\n    refresh();\n  }, []);\n\n  const pinnedIds = useMemo(() => {\n    if (summary?.pinnedTrophies?.length) return summary.pinnedTrophies;\n    return trophies.filter((t) => t.pinned).map((t) => t.id);\n  }, [summary, trophies]);\n\n  const trophyById = useMemo(() => {\n    const map = new Map<string, TrophyStatus>();\n    trophies.forEach((trophy) => map.set(trophy.id, trophy));\n    return map;\n  }, [trophies]);\n\n  const pinnedTrophies = pinnedIds\n    .map((id) => trophyById.get(id))\n    .filter((trophy): trophy is TrophyStatus => Boolean(trophy));\n\n  const nextUp = useMemo(() => {\n    return trophies\n      .filter((trophy) => trophy.progress.state === 'locked')\n      .sort((a, b) => (b.progress.ratio - a.progress.ratio))\n      .slice(0, 4);\n  }, [trophies]);\n\n  const grouped = useMemo(() => {\n    const groups = new Map<string, TrophyStatus[]>();\n    trophies.forEach((trophy) => {\n      const key = trophy.category;\n      if (!groups.has(key)) groups.set(key, []);\n      groups.get(key)!.push(trophy);\n    });\n    return groups;\n  }, [trophies]);\n\n  const handleTogglePin = async (trophyId: string) => {\n    if (busy) return;\n    setBusy(true);\n    try {\n      const next = pinnedIds.includes(trophyId)\n        ? pinnedIds.filter((id) => id !== trophyId)\n        : [...pinnedIds, trophyId].slice(0, MAX_PINNED);\n      const pinned = await api.trophies.pin(next);\n      setSummary((prev) => (prev ? { ...prev, pinnedTrophies: pinned } : prev));\n      setTrophies((prev) => prev.map((trophy) => ({\n        ...trophy,\n        pinned: pinned.includes(trophy.id)\n      })));\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  const profileName = summary?.profile?.displayName ?? summary?.profile?.handle ?? 'You';\n  const profileHandle = summary?.profile?.handle ? `@${summary.profile.handle}` : 'Not synced yet';\n  const profileColor = summary?.profile?.color ?? 'var(--accent)';\n\n  return (\n    <section className=\"panel\">\n      <header className=\"panel-header\">\n        <div>\n          <p className=\"eyebrow\">Profile</p>\n          <h1>Trophy case</h1>\n          <p className=\"subtle\">Your public card, progression, and achievements.</p>\n        </div>\n        <button\n          type=\"button\"\n          className={`pill ghost ${previewMode ? 'active' : ''}`}\n          onClick={() => setPreviewMode((prev) => !prev)}\n        >\n          {previewMode ? 'Hide preview' : 'Public preview'}\n        </button>\n      </header>\n\n      <div className=\"profile-grid\">\n        <div className=\"card profile-card\">\n          <div className=\"profile-card-header\">\n            <div className=\"profile-avatar\" style={{ background: profileColor }}>\n              {profileName.trim().slice(0, 2).toUpperCase()}\n            </div>\n            <div>\n              <h2>{profileName}</h2>\n              <span className=\"subtle\">{profileHandle}</span>\n            </div>\n          </div>\n          <div className=\"profile-stats\">\n            <div>\n              <span className=\"label\">Weekly productive</span>\n              <strong>{summary ? formatMinutes(summary.stats.weeklyProductiveMinutes) : '--'}</strong>\n            </div>\n            <div>\n              <span className=\"label\">Best run</span>\n              <strong>{summary ? formatHours(summary.stats.bestRunMinutes / 60) : '--'}</strong>\n            </div>\n            <div>\n              <span className=\"label\">Recovery median</span>\n              <strong>{summary?.stats.recoveryMedianMinutes != null ? `${Math.round(summary.stats.recoveryMedianMinutes)}m` : '--'}</strong>\n            </div>\n            <div>\n              <span className=\"label\">Frivolity streak</span>\n              <strong>{summary ? `${summary.stats.currentFrivolityStreakHours}h` : '--'}</strong>\n            </div>\n          </div>\n          <div className=\"profile-pinned\">\n            <div className=\"profile-pinned-header\">\n              <span className=\"label\">Pinned trophies</span>\n              <span className=\"subtle\">{pinnedTrophies.length}/{MAX_PINNED}</span>\n            </div>\n            {pinnedTrophies.length === 0 ? (\n              <p className=\"subtle\" style={{ margin: 0 }}>Pin a few trophies so friends can see them.</p>\n            ) : (\n              <div className=\"profile-badges\">\n                {pinnedTrophies.map((trophy) => (\n                  <div key={trophy.id} className=\"trophy-badge\">\n                    <span className=\"emoji\">{trophy.emoji}</span>\n                    <span>{trophy.name}</span>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"card profile-next\">\n          <div className=\"card-header-row\">\n            <div>\n              <p className=\"eyebrow\">Next up</p>\n              <h2>Close to unlocking</h2>\n            </div>\n          </div>\n          {nextUp.length === 0 ? (\n            <p className=\"subtle\">No tracked trophies yet. Keep logging activity.</p>\n          ) : (\n            <div className=\"next-list\">\n              {nextUp.map((trophy) => (\n                <div key={trophy.id} className=\"next-item\">\n                  <div className=\"next-item-header\">\n                    <span className=\"emoji\">{trophy.emoji}</span>\n                    <div>\n                      <strong>{trophy.name}</strong>\n                      <span className=\"subtle\">{trophy.description}</span>\n                    </div>\n                  </div>\n                  <div className=\"progress-bar\">\n                    <span style={{ width: `${Math.round(trophy.progress.ratio * 100)}%` }} />\n                  </div>\n                  <span className=\"subtle\">{trophy.progress.label ?? `${trophy.progress.current}/${trophy.progress.target}`}</span>\n                </div>\n              ))}\n            </div>\n          )}\n          {summary?.earnedToday?.length ? (\n            <div className=\"earned-today\">\n              <span className=\"label\">Earned today</span>\n              <div className=\"profile-badges\">\n                {summary.earnedToday.map((id) => {\n                  const trophy = trophyById.get(id);\n                  if (!trophy) return null;\n                  return (\n                    <div key={id} className=\"trophy-badge\">\n                      <span className=\"emoji\">{trophy.emoji}</span>\n                      <span>{trophy.name}</span>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          ) : null}\n        </div>\n      </div>\n\n      {previewMode && (\n        <div className=\"card profile-preview\">\n          <div className=\"card-header-row\">\n            <div>\n              <p className=\"eyebrow\">Public preview</p>\n              <h2>What friends see</h2>\n            </div>\n          </div>\n          <div className=\"profile-preview-card\">\n            <div className=\"profile-avatar\" style={{ background: profileColor }}>\n              {profileName.trim().slice(0, 2).toUpperCase()}\n            </div>\n            <div>\n              <strong>{profileName}</strong>\n              <span className=\"subtle\">{profileHandle}</span>\n            </div>\n            <div className=\"profile-preview-badges\">\n              {pinnedTrophies.length === 0 ? (\n                <span className=\"subtle\">No pinned trophies yet.</span>\n              ) : pinnedTrophies.map((trophy) => (\n                <span key={trophy.id} className=\"trophy-badge\">\n                  <span className=\"emoji\">{trophy.emoji}</span>\n                  {trophy.name}\n                </span>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"card trophy-case\">\n        <div className=\"card-header-row\">\n          <div>\n            <p className=\"eyebrow\">Trophy case</p>\n            <h2>Full collection</h2>\n          </div>\n          <span className=\"subtle\">Pin trophies to feature them on your card.</span>\n        </div>\n        {Array.from(grouped.entries()).map(([category, list]) => (\n          <div key={category} className=\"trophy-group\">\n            <h3>{TROPHY_CATEGORY_LABELS[category as keyof typeof TROPHY_CATEGORY_LABELS]}</h3>\n            <div className=\"trophy-grid\">\n              {list.map((trophy) => {\n                const locked = !trophy.earnedAt;\n                const isSecret = trophy.secret && locked;\n                return (\n                  <div key={trophy.id} className={`trophy-card ${locked ? 'locked' : 'earned'}`}>\n                    <div className=\"trophy-card-header\">\n                      <span className=\"emoji\">{isSecret ? '‚ùì' : trophy.emoji}</span>\n                      <button\n                        type=\"button\"\n                        className={`pill ghost ${trophy.pinned ? 'active' : ''}`}\n                        onClick={() => handleTogglePin(trophy.id)}\n                        disabled={busy || !trophy.earnedAt}\n                        title={trophy.earnedAt ? 'Pin to profile' : 'Earn to pin'}\n                      >\n                        {trophy.pinned ? 'Pinned' : 'Pin'}\n                      </button>\n                    </div>\n                    <strong>{isSecret ? 'Classified' : trophy.name}</strong>\n                    <p className=\"subtle\">{isSecret ? 'Keep going to reveal this trophy.' : trophy.description}</p>\n                    {trophy.progress.state === 'untracked' ? (\n                      <span className=\"subtle\">{trophy.progress.label}</span>\n                    ) : (\n                      <div className=\"progress-bar\">\n                        <span style={{ width: `${Math.round(trophy.progress.ratio * 100)}%` }} />\n                      </div>\n                    )}\n                    {trophy.earnedAt && (\n                      <span className=\"subtle\">Earned {new Date(trophy.earnedAt).toLocaleDateString()}</span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        ))}\n      </div>\n    </section>\n  );\n}\n","import type { WalletSnapshot } from '@shared/types';\nimport SudokuChallenge from './SudokuChallenge';\n\ninterface GamesProps {\n  wallet: WalletSnapshot;\n}\n\nconst NYT_GAMES = [\n  {\n    name: 'The Crossword',\n    hint: 'Full daily crossword.',\n    url: 'https://www.nytimes.com/crosswords/game/daily'\n  },\n  {\n    name: 'The Mini',\n    hint: 'Quick 5-minute crossword.',\n    url: 'https://www.nytimes.com/crosswords/game/mini'\n  },\n  {\n    name: 'Connections',\n    hint: 'Find the four hidden groups.',\n    url: 'https://www.nytimes.com/games/connections'\n  },\n  {\n    name: 'Wordle',\n    hint: 'One word, six tries.',\n    url: 'https://www.nytimes.com/games/wordle/index.html'\n  },\n  {\n    name: 'Spelling Bee',\n    hint: 'Build words from seven letters.',\n    url: 'https://www.nytimes.com/puzzles/spelling-bee'\n  },\n  {\n    name: 'Strands',\n    hint: 'Find the themed word web.',\n    url: 'https://www.nytimes.com/games/strands'\n  }\n];\n\nexport default function Games({ wallet }: GamesProps) {\n  return (\n    <section className=\"games-view panel\">\n      <header className=\"games-hero\">\n        <div>\n          <h2>Games</h2>\n          <p className=\"subtle\">\n            Intentional time burners: quick fun, finite sessions, less doom-scroll.\n          </p>\n        </div>\n        <div className=\"games-wallet-pill\">\n          <span>Wallet</span>\n          <strong>{wallet.balance} f-coins</strong>\n        </div>\n      </header>\n\n      <section className=\"games-links-section\">\n        <div className=\"section-header-row\">\n          <div>\n            <h3>NYT quick launch</h3>\n            <p className=\"subtle\">If you want to burn a little time, do it on purpose.</p>\n          </div>\n          <a href=\"https://www.nytimes.com/crosswords\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"ghost button-link\">\n            Open NYT games hub\n          </a>\n        </div>\n        <div className=\"games-links-grid\">\n          {NYT_GAMES.map((game) => (\n            <a key={game.name} className=\"nyt-link-card\" href={game.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              <div className=\"nyt-link-title\">{game.name}</div>\n              <p className=\"subtle\">{game.hint}</p>\n              <span className=\"chip\">Open</span>\n            </a>\n          ))}\n        </div>\n      </section>\n\n      <section className=\"games-sudoku-section\">\n        <div className=\"section-header-row\">\n          <div>\n            <h3>Paywall Sudoku drill</h3>\n            <p className=\"subtle\">Practice the same challenge used in the paywall free-pass flow.</p>\n          </div>\n        </div>\n        <SudokuChallenge\n          title=\"Hard Sudoku practice\"\n          subtitle=\"Solve any 9 blank squares correctly.\"\n          requiredCorrect={9}\n        />\n      </section>\n    </section>\n  );\n}\n","import { useEffect, useRef } from 'react';\nimport type { RendererApi } from '@shared/types';\n\nconst api: RendererApi = window.twsp;\nconst MIN_CAPTURE_WIDTH = 160;\nconst MIN_CAPTURE_HEIGHT = 120;\nconst FRAME_WAIT_TIMEOUT_MS = 4000;\n\ntype CapturePayload = {\n  subject?: string | null;\n  domain?: string | null;\n};\n\nfunction sleep(ms: number) {\n  return new Promise<void>((resolve) => window.setTimeout(resolve, ms));\n}\n\nasync function waitForUsableFrame(video: HTMLVideoElement) {\n  const started = Date.now();\n  while (Date.now() - started < FRAME_WAIT_TIMEOUT_MS) {\n    const width = video.videoWidth;\n    const height = video.videoHeight;\n    if (\n      video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA &&\n      width >= MIN_CAPTURE_WIDTH &&\n      height >= MIN_CAPTURE_HEIGHT\n    ) {\n      return { width, height };\n    }\n    await sleep(80);\n  }\n  throw new Error(`Camera stream resolution unusable (${video.videoWidth}x${video.videoHeight})`);\n}\n\nfunction frameLooksBlank(ctx: CanvasRenderingContext2D, width: number, height: number) {\n  const sampleWidth = Math.max(1, Math.min(48, width));\n  const sampleHeight = Math.max(1, Math.min(48, height));\n  const { data } = ctx.getImageData(0, 0, sampleWidth, sampleHeight);\n  let brightCount = 0;\n  // Sample every 4th pixel to keep this cheap.\n  for (let i = 0; i < data.length; i += 16) {\n    const r = data[i] ?? 0;\n    const g = data[i + 1] ?? 0;\n    const b = data[i + 2] ?? 0;\n    // Perceived luminance.\n    const luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n    if (luma > 10) brightCount += 1;\n  }\n  return brightCount <= 1;\n}\n\nasync function captureFrame(payload: CapturePayload) {\n  let stream: MediaStream | null = null;\n  try {\n    stream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        width: { ideal: 1280 },\n        height: { ideal: 720 }\n      },\n      audio: false\n    });\n\n    const video = document.createElement('video');\n    video.srcObject = stream;\n    video.playsInline = true;\n    video.muted = true;\n    await video.play();\n    const { width, height } = await waitForUsableFrame(video);\n    const maxWidth = 640;\n    const scale = Math.min(1, maxWidth / width);\n    const targetWidth = Math.round(width * scale);\n    const targetHeight = Math.round(height * scale);\n\n    const canvas = document.createElement('canvas');\n    canvas.width = targetWidth;\n    canvas.height = targetHeight;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) {\n      throw new Error('Unable to capture camera frame');\n    }\n    ctx.drawImage(video, 0, 0, targetWidth, targetHeight);\n    // Some environments briefly return tiny/blank bootstrap frames; avoid storing junk.\n    if (frameLooksBlank(ctx, targetWidth, targetHeight)) {\n      await sleep(180);\n      ctx.drawImage(video, 0, 0, targetWidth, targetHeight);\n      if (frameLooksBlank(ctx, targetWidth, targetHeight)) {\n        throw new Error('Captured frame appears blank');\n      }\n    }\n    const dataUrl = canvas.toDataURL('image/jpeg', 0.82);\n    await api.camera.storePhoto({\n      dataUrl,\n      subject: payload.subject ?? null,\n      domain: payload.domain ?? null\n    });\n  } finally {\n    if (stream) {\n      stream.getTracks().forEach((track) => track.stop());\n    }\n  }\n}\n\nexport default function CameraCapture() {\n  const busyRef = useRef(false);\n\n  useEffect(() => {\n    const unsubscribe = api.events.on<CapturePayload>('camera:capture', async (payload) => {\n      if (busyRef.current) return;\n      busyRef.current = true;\n      try {\n        await captureFrame(payload ?? {});\n      } catch (error) {\n        console.warn('Camera capture failed', error);\n      } finally {\n        busyRef.current = false;\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  return null;\n}\n","import { useMemo, useState, useEffect } from 'react';\nimport type { EmergencyPolicyId } from '@shared/types';\n\nconst GREETINGS = [\n  'Hello beautiful.',\n  'Good morning, bright mind.',\n  'Hey superstar.',\n  'Hello again, steady heart.',\n  'Welcome back, focus machine.'\n];\n\nconst TAGLINES = [\n  'Set the tone. The day follows.',\n  'Small levers, huge outcomes.',\n  'One clear choice beats a thousand edits.',\n  'Pick your rules before the feed does.',\n  'Today is made in small agreements.'\n];\n\nfunction hashString(value: string) {\n  let hash = 0;\n  for (let i = 0; i < value.length; i += 1) {\n    hash = (hash << 5) - hash + value.charCodeAt(i);\n    hash |= 0;\n  }\n  return Math.abs(hash);\n}\n\nfunction pickPhrase(list: string[], seed: string) {\n  if (!list.length) return '';\n  const idx = hashString(seed) % list.length;\n  return list[idx];\n}\n\ntype DailyOnboardingValues = {\n  goalHours: number;\n  idleThreshold: number;\n  continuityWindowSeconds: number;\n  emergencyPolicy: EmergencyPolicyId;\n  note: string;\n};\n\ntype DailyOnboardingModalProps = {\n  open: boolean;\n  dayKey: string;\n  initial: DailyOnboardingValues;\n  saving?: boolean;\n  error?: string | null;\n  onSave(values: DailyOnboardingValues): void;\n  onSkip(values: Pick<DailyOnboardingValues, 'note'>): void;\n};\n\nexport function DailyOnboardingModal({ open, dayKey, initial, saving, error, onSave, onSkip }: DailyOnboardingModalProps) {\n  const [goalHours, setGoalHours] = useState(initial.goalHours);\n  const [idleThreshold, setIdleThreshold] = useState(initial.idleThreshold);\n  const [continuityWindowSeconds, setContinuityWindowSeconds] = useState(initial.continuityWindowSeconds);\n  const [emergencyPolicy, setEmergencyPolicy] = useState<EmergencyPolicyId>(initial.emergencyPolicy);\n  const [note, setNote] = useState(initial.note);\n\n  useEffect(() => {\n    if (!open) return;\n    setGoalHours(initial.goalHours);\n    setIdleThreshold(initial.idleThreshold);\n    setContinuityWindowSeconds(initial.continuityWindowSeconds);\n    setEmergencyPolicy(initial.emergencyPolicy);\n    setNote(initial.note);\n  }, [open, initial]);\n\n  const greeting = useMemo(() => pickPhrase(GREETINGS, dayKey), [dayKey]);\n  const tagline = useMemo(() => pickPhrase(TAGLINES, dayKey + 'tag'), [dayKey]);\n\n  if (!open) return null;\n\n  return (\n    <div className=\"daily-onboarding-overlay\" role=\"dialog\" aria-modal=\"true\">\n      <div className=\"daily-onboarding-card\">\n        <div className=\"daily-onboarding-header\">\n          <div className=\"daily-onboarding-hero\">\n            <div className=\"daily-onboarding-orb\" aria-hidden />\n            <div>\n              <p className=\"eyebrow\">Daily landing</p>\n              <h2>{greeting}</h2>\n              <p className=\"subtle\">{tagline}</p>\n            </div>\n          </div>\n          <div className=\"daily-onboarding-meta\">\n            <span className=\"pill ghost\">Morning tuning</span>\n            <span className=\"pill ghost\">One screen</span>\n          </div>\n        </div>\n\n        <div className=\"daily-onboarding-panels\">\n          <div className=\"daily-onboarding-panel\">\n            <h3>Set your day</h3>\n            <div className=\"daily-onboarding-grid\">\n              <label>\n                Productivity goal (hours)\n                <input\n                  type=\"number\"\n                  min=\"0.5\"\n                  max=\"12\"\n                  step=\"0.1\"\n                  value={goalHours}\n                  onChange={(e) => setGoalHours(Number(e.target.value))}\n                />\n              </label>\n              <label>\n                Idle threshold (seconds)\n                <input\n                  type=\"number\"\n                  min=\"5\"\n                  max=\"300\"\n                  value={idleThreshold}\n                  onChange={(e) => setIdleThreshold(Number(e.target.value))}\n                />\n              </label>\n              <label>\n                Continuity window (seconds)\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"900\"\n                  value={continuityWindowSeconds}\n                  onChange={(e) => setContinuityWindowSeconds(Number(e.target.value))}\n                />\n              </label>\n              <label>\n                Emergency policy\n                <select value={emergencyPolicy} onChange={(e) => setEmergencyPolicy(e.target.value as EmergencyPolicyId)}>\n                  <option value=\"off\">Off</option>\n                  <option value=\"gentle\">Gentle</option>\n                  <option value=\"balanced\">Balanced</option>\n                  <option value=\"strict\">Strict</option>\n                </select>\n              </label>\n            </div>\n          </div>\n\n          <div className=\"daily-onboarding-panel\">\n            <h3>Note for end-of-day you</h3>\n            <label className=\"daily-onboarding-note\">\n              <textarea\n                rows={4}\n                value={note}\n                onChange={(e) => setNote(e.target.value)}\n                placeholder=\"Write something kind, firm, or honest. We'll bring it back later.\"\n              />\n            </label>\n          </div>\n        </div>\n\n        {error && <p className=\"error-text\">{error}</p>}\n\n        <div className=\"daily-onboarding-actions\">\n          <button type=\"button\" className=\"ghost\" onClick={() => onSkip({ note })} disabled={saving}>\n            Not now\n          </button>\n          <button\n            type=\"button\"\n            className=\"primary\"\n            onClick={() => onSave({ goalHours, idleThreshold, continuityWindowSeconds, emergencyPolicy, note })}\n            disabled={saving}\n          >\n            {saving ? 'Saving...' : 'Set my day'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ntype DailyNoteModalProps = {\n  open: boolean;\n  note: string;\n  onClose(): void;\n};\n\nexport function DailyNoteModal({ open, note, onClose }: DailyNoteModalProps) {\n  if (!open) return null;\n  return (\n    <div className=\"daily-onboarding-overlay\" role=\"dialog\" aria-modal=\"true\">\n      <div className=\"daily-onboarding-card daily-note-card\">\n        <div className=\"daily-onboarding-header\">\n          <p className=\"eyebrow\">End-of-day note</p>\n          <h2>For you, from you.</h2>\n        </div>\n        <div className=\"daily-note-body\">\n          <p>{note}</p>\n        </div>\n        <div className=\"daily-onboarding-actions\">\n          <button type=\"button\" className=\"primary\" onClick={onClose}>\n            Got it\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useRef } from 'react';\nimport Dashboard from './components/Dashboard';\nimport Settings from './components/Settings';\nimport Analytics from './components/Analytics';\nimport PaywallOverlay from './components/PaywallOverlay';\nimport Library from './components/Library';\nimport Friends from './components/Friends';\nimport Profile from './components/Profile';\nimport Games from './components/Games';\nimport CameraCapture from './components/CameraCapture';\nimport { DailyOnboardingModal, DailyNoteModal } from './components/DailyOnboardingModal';\nimport type {\n  DailyOnboardingState,\n  EmergencyPolicyId,\n  EconomyState,\n  MarketRate,\n  RendererApi,\n  WalletSnapshot\n} from '@shared/types';\n\nconst api: RendererApi = window.twsp;\n\ntype View = 'dashboard' | 'library' | 'games' | 'analytics' | 'settings' | 'friends' | 'profile';\nconst VIEW_LIST: View[] = ['dashboard', 'library', 'games', 'analytics', 'settings', 'friends', 'profile'];\nconst isView = (value: string): value is View => VIEW_LIST.includes(value as View);\n\nconst DAILY_START_HOUR = 4;\nconst NOTE_DELIVERY_HOUR = 17;\n\nfunction dayKeyFor(date: Date) {\n  const local = new Date(date);\n  if (local.getHours() < DAILY_START_HOUR) {\n    local.setDate(local.getDate() - 1);\n  }\n  const year = local.getFullYear();\n  const month = String(local.getMonth() + 1).padStart(2, '0');\n  const day = String(local.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\nexport default function App() {\n  const [view, setView] = useState<View>('dashboard');\n  const [wallet, setWallet] = useState<WalletSnapshot>({ balance: 0 });\n  const [marketRates, setMarketRates] = useState<MarketRate[]>([]);\n  const [economyState, setEconomyState] = useState<EconomyState | null>(null);\n  const [theme, setTheme] = useState<'lavender' | 'olive'>(() => {\n    try {\n      const saved = localStorage.getItem('tws-theme');\n      return saved === 'olive' ? 'olive' : 'lavender';\n    } catch {\n      return 'lavender';\n    }\n  });\n  const [extensionStatus, setExtensionStatus] = useState<{ connected: boolean; lastSeen: number | null }>({ connected: true, lastSeen: null });\n  const [paywallBlock, setPaywallBlock] = useState<{\n    domain: string;\n    appName: string;\n    mode?: 'metered' | 'pack';\n    reason?: string;\n  } | null>(null);\n  const [dailyOnboardingState, setDailyOnboardingState] = useState<DailyOnboardingState | null>(null);\n  const [dailyOnboardingOpen, setDailyOnboardingOpen] = useState(false);\n  const [dailyOnboardingSaving, setDailyOnboardingSaving] = useState(false);\n  const [dailyOnboardingError, setDailyOnboardingError] = useState<string | null>(null);\n  const [dailyGoalHours, setDailyGoalHours] = useState(2);\n  const [dailyIdleThreshold, setDailyIdleThreshold] = useState(15);\n  const [dailyContinuityWindow, setDailyContinuityWindow] = useState(120);\n  const [dailyEmergencyPolicy, setDailyEmergencyPolicy] = useState<EmergencyPolicyId>('balanced');\n  const [dailyNote, setDailyNote] = useState('');\n  const [dailyNoteOpen, setDailyNoteOpen] = useState(false);\n  const [now, setNow] = useState(Date.now());\n\n  useEffect(() => {\n    api.wallet.get().then(setWallet);\n    api.market.list().then(setMarketRates);\n    api.economy.state().then(setEconomyState);\n  }, []);\n\n  useEffect(() => {\n    const timer = window.setInterval(() => setNow(Date.now()), 60_000);\n    return () => window.clearInterval(timer);\n  }, []);\n\n  useEffect(() => {\n    let active = true;\n    const loadDaily = async () => {\n      const dayKey = dayKeyFor(new Date());\n      const [state, goalHours, idleThreshold, continuityWindowSeconds, emergencyPolicy] = await Promise.all([\n        api.settings.dailyOnboardingState(),\n        api.settings.productivityGoalHours(),\n        api.settings.idleThreshold(),\n        api.settings.continuityWindowSeconds(),\n        api.settings.emergencyPolicy()\n      ]);\n      if (!active) return;\n      setDailyOnboardingState(state);\n      setDailyGoalHours(goalHours);\n      setDailyIdleThreshold(idleThreshold);\n      setDailyContinuityWindow(continuityWindowSeconds);\n      setDailyEmergencyPolicy(emergencyPolicy);\n      setDailyNote(state.note?.day === dayKey ? state.note.message : '');\n\n      if (state.completedDay !== dayKey && state.lastPromptedDay !== dayKey) {\n        const nextState = await api.settings.updateDailyOnboardingState({ lastPromptedDay: dayKey });\n        if (!active) return;\n        setDailyOnboardingState(nextState);\n        setDailyOnboardingOpen(true);\n      }\n    };\n    loadDaily().catch(() => { });\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!dailyOnboardingState?.note) return;\n    const note = dailyOnboardingState.note;\n    const dayKey = dayKeyFor(new Date(now));\n    if (note.acknowledged) return;\n    if (note.day && note.day > dayKey) return;\n    const local = new Date(now);\n    const isToday = note.day === dayKey;\n    if (isToday && local.getHours() < NOTE_DELIVERY_HOUR) return;\n    if (!dailyNoteOpen) {\n      setDailyNoteOpen(true);\n      if (!note.deliveredAt) {\n        const nextNote = { ...note, deliveredAt: new Date().toISOString() };\n        api.settings.updateDailyOnboardingState({ note: nextNote }).then(setDailyOnboardingState).catch(() => { });\n      }\n    }\n  }, [dailyOnboardingState, dailyNoteOpen, now]);\n\n  useEffect(() => {\n    const body = document.body;\n    body.classList.remove('theme-olive');\n    if (theme === 'olive') body.classList.add('theme-olive');\n    try {\n      localStorage.setItem('tws-theme', theme);\n    } catch {\n      // ignore\n    }\n  }, [theme]);\n\n  useEffect(() => {\n    const unsubscribe = api.events.on<{ view?: string }>('ui:navigate', (payload) => {\n      const next = payload?.view;\n      if (typeof next === 'string' && isView(next)) {\n        setView(next);\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  const extensionStatusRef = useRef(extensionStatus);\n  useEffect(() => {\n    extensionStatusRef.current = extensionStatus;\n  }, [extensionStatus]);\n\n  useEffect(() => {\n    const unsubWallet = api.events.on<WalletSnapshot>('wallet:update', setWallet);\n    const unsubEconomy = api.events.on<EconomyState>('economy:activity', setEconomyState);\n    const unsubMarket = api.events.on<Record<string, MarketRate>>('market:update', () => {\n      api.market.list().then(setMarketRates);\n    });\n\n    const unsubPaywallReq = api.events.on<{ domain: string; appName: string }>('paywall:required', (payload) => {\n      // If extension is connected, ignore paywall requests for browsers\n      // (The extension handles its own blocking/paywall UI)\n      if (extensionStatusRef.current.connected) {\n        const browsers = ['Google Chrome', 'Chrome', 'Brave Browser', 'Brave', 'Microsoft Edge', 'Edge', 'Arc', 'Firefox', 'Safari'];\n        if (browsers.some(b => payload.appName.includes(b))) {\n          console.log('Ignoring desktop paywall for browser activity (extension active):', payload);\n          return;\n        }\n      }\n      setPaywallBlock({ ...payload, reason: 'blocked' });\n    });\n\n    const unsubPaywallStart = api.events.on('paywall:session-started', () => {\n      setPaywallBlock(null);\n    });\n    const unsubExtStatus = api.events.on<{ connected: boolean; lastSeen: number | null }>('extension:status', (payload) => {\n      setExtensionStatus(payload);\n    });\n\n    const unsubPaywallEnd = api.events.on<{ domain: string; reason: string }>('paywall:session-ended', (payload) => {\n      if (payload.reason === 'insufficient-funds') {\n        setPaywallBlock({ domain: payload.domain, appName: '', reason: payload.reason });\n      }\n    });\n\n    return () => {\n      unsubWallet();\n      unsubEconomy();\n      unsubMarket();\n      unsubPaywallReq();\n      unsubPaywallStart();\n      unsubPaywallEnd();\n      unsubExtStatus();\n    };\n  }, []);\n\n  const handleDailySave = async (values: {\n    goalHours: number;\n    idleThreshold: number;\n    continuityWindowSeconds: number;\n    emergencyPolicy: EmergencyPolicyId;\n    note: string;\n  }) => {\n    if (dailyOnboardingSaving) return;\n    setDailyOnboardingSaving(true);\n    setDailyOnboardingError(null);\n    const dayKey = dayKeyFor(new Date());\n    try {\n      await api.settings.updateProductivityGoalHours(values.goalHours);\n      await api.settings.updateIdleThreshold(values.idleThreshold);\n      await api.settings.updateContinuityWindowSeconds(values.continuityWindowSeconds);\n      await api.settings.updateEmergencyPolicy(values.emergencyPolicy);\n      setDailyGoalHours(values.goalHours);\n      setDailyIdleThreshold(values.idleThreshold);\n      setDailyContinuityWindow(values.continuityWindowSeconds);\n      setDailyEmergencyPolicy(values.emergencyPolicy);\n      const note = values.note.trim();\n      const patch: Partial<DailyOnboardingState> = {\n        completedDay: dayKey,\n        lastPromptedDay: dayKey,\n        lastSkippedDay: null,\n        note: note\n          ? { day: dayKey, message: note, deliveredAt: null, acknowledged: false }\n          : null\n      };\n      const nextState = await api.settings.updateDailyOnboardingState(patch);\n      setDailyOnboardingState(nextState);\n      setDailyOnboardingOpen(false);\n    } catch {\n      setDailyOnboardingError('Failed to save your settings. Try again.');\n    } finally {\n      setDailyOnboardingSaving(false);\n    }\n  };\n\n  const handleDailySkip = async (values: { note: string }) => {\n    if (dailyOnboardingSaving) return;\n    setDailyOnboardingSaving(true);\n    setDailyOnboardingError(null);\n    const dayKey = dayKeyFor(new Date());\n    try {\n      const note = values.note.trim();\n      const patch: Partial<DailyOnboardingState> = {\n        lastPromptedDay: dayKey,\n        lastSkippedDay: dayKey,\n        note: note\n          ? { day: dayKey, message: note, deliveredAt: null, acknowledged: false }\n          : null\n      };\n      const nextState = await api.settings.updateDailyOnboardingState(patch);\n      setDailyOnboardingState(nextState);\n      setDailyOnboardingOpen(false);\n    } catch {\n      setDailyOnboardingError('Failed to save your note. Try again.');\n    } finally {\n      setDailyOnboardingSaving(false);\n    }\n  };\n\n  const handleDailyNoteClose = async () => {\n    if (!dailyOnboardingState?.note) {\n      setDailyNoteOpen(false);\n      return;\n    }\n    const nextNote = { ...dailyOnboardingState.note, acknowledged: true };\n    try {\n      const nextState = await api.settings.updateDailyOnboardingState({ note: nextNote });\n      setDailyOnboardingState(nextState);\n    } catch {\n      // ignore\n    } finally {\n      setDailyNoteOpen(false);\n    }\n  };\n\n  return (\n    <div className=\"app-shell\">\n      <CameraCapture />\n      {!extensionStatus.connected && (\n        <div className=\"extension-banner\">\n          <div>\n            <strong>Browser extension offline</strong>\n            <span className=\"subtle\"> Install or enable the TimeWellSpent extension to enforce in-browser paywalls.</span>\n          </div>\n          <button\n            className=\"primary\"\n            onClick={() => window.open('https://chromewebstore.google.com', '_blank', 'noopener')}\n          >\n            Get extension\n          </button>\n        </div>\n      )}\n      <div className=\"window-chrome\">\n        <div className=\"window-chrome-title\" aria-hidden>\n          <div className=\"title-dot\" />\n          <span>TimeWellSpent</span>\n        </div>\n        <div className=\"window-chrome-meta\">\n          <span className=\"pill ghost big\">{wallet?.balance ?? 0} f-coins</span>\n        </div>\n      </div>\n      <aside className=\"sidebar\">\n        <div className=\"brand\">\n          <div className=\"logo\">‚è≥</div>\n          <span>TimeWellSpent</span>\n        </div>\n\n        <nav className=\"nav-menu\">\n          <button\n            className={view === 'dashboard' ? 'active' : ''}\n            onClick={() => setView('dashboard')}\n          >\n            Dashboard\n          </button>\n          <button\n            className={view === 'library' ? 'active' : ''}\n            onClick={() => setView('library')}\n          >\n            Library\n          </button>\n          <button\n            className={view === 'games' ? 'active' : ''}\n            onClick={() => setView('games')}\n          >\n            Games\n          </button>\n          <button\n            className={view === 'settings' ? 'active' : ''}\n            onClick={() => setView('settings')}\n          >\n            Settings\n          </button>\n          <button\n            className={view === 'analytics' ? 'active' : ''}\n            onClick={() => setView('analytics')}\n          >\n            Analytics\n          </button>\n          <button\n            className={view === 'friends' ? 'active' : ''}\n            onClick={() => setView('friends')}\n          >\n            Friends\n          </button>\n          <button\n            className={view === 'profile' ? 'active' : ''}\n            onClick={() => setView('profile')}\n          >\n            Profile\n          </button>\n        </nav>\n\n        <div className=\"wallet-summary\">\n          <div className=\"balance\">\n            <span className=\"coin\">ü™ô</span>\n            <span className=\"amount\">{wallet?.balance ?? 0}</span>\n          </div>\n          <div className=\"rate\">\n            {economyState?.activeCategory === 'productive' ? '+5/min' :\n              economyState?.activeCategory === 'neutral' ? '+3/min' : '0/min'}\n          </div>\n        </div>\n      </aside>\n\n      <main className=\"content\">\n        {view === 'dashboard' && (\n          <Dashboard\n            api={api}\n            wallet={wallet}\n            economy={economyState}\n            productivityGoalHoursOverride={dailyGoalHours}\n          />\n        )}\n        {view === 'analytics' && (\n          <Analytics api={api} />\n        )}\n        {view === 'settings' && (\n          <Settings\n            api={api}\n            theme={theme}\n            onThemeChange={(next) => setTheme(next)}\n          />\n        )}\n        {view === 'library' && (\n          <Library api={api} />\n        )}\n        {view === 'games' && (\n          <Games wallet={wallet} />\n        )}\n        {view === 'friends' && (\n          <Friends api={api} />\n        )}\n        {view === 'profile' && (\n          <Profile api={api} />\n        )}\n      </main>\n\n      <DailyOnboardingModal\n        open={dailyOnboardingOpen}\n        dayKey={dayKeyFor(new Date())}\n        saving={dailyOnboardingSaving}\n        error={dailyOnboardingError}\n        initial={{\n          goalHours: dailyGoalHours,\n          idleThreshold: dailyIdleThreshold,\n          continuityWindowSeconds: dailyContinuityWindow,\n          emergencyPolicy: dailyEmergencyPolicy,\n          note: dailyNote\n        }}\n        onSave={handleDailySave}\n        onSkip={handleDailySkip}\n      />\n\n      <DailyNoteModal\n        open={dailyNoteOpen}\n        note={dailyOnboardingState?.note?.message ?? ''}\n        onClose={handleDailyNoteClose}\n      />\n\n      {paywallBlock && (\n        <PaywallOverlay\n          open={!!paywallBlock}\n          state={{\n            domain: paywallBlock.domain || paywallBlock.appName,\n            mode: paywallBlock.mode ?? 'pack',\n            reason: paywallBlock.reason\n          }}\n          wallet={wallet}\n          api={api}\n          marketRates={marketRates}\n          onWallet={setWallet}\n          onClose={() => setPaywallBlock(null)}\n        />\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\nimport './styles.css';\n\nReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n"],"names":["DAY_START_HOUR","shiftHourToDayStart","hour","dayStartHour","getLocalDayStartMs","referenceMs","date","PomodoroPanel","api","session","setSession","useState","remainingMs","setRemainingMs","mode","setMode","duration","setDuration","breakDuration","setBreakDuration","temporaryUnlock","setTemporaryUnlock","allowlist","setAllowlist","suggested","setSuggested","customAllowlist","setCustomAllowlist","loading","setLoading","useEffect","s","unsubTick","payload","prev","unsubStart","unsubStop","unsubPause","unsubResume","cfg","productives","value","defaults","merged","unique","seen","entry","key","formattedTime","useMemo","ms","totalSec","minutes","seconds","start","allowlistPayload","idx","config","next","error","addAllowlist","cleaned","removeAllowlist","stop","reason","pause","resume","triggerBreak","jsxs","jsx","Fragment","e","sel","categoryColors","DayCompass","summary","economy","view","setView","hoveredIndex","setHoveredIndex","aggregate","totals","slices","item","totalSeconds","sum","cursor","slice","sweep","path","buildArc","timeline","step","windowSeconds","arcs","slot","startAngle","endAngle","color","centerSeconds","activeTimelineSlot","activeTimelineDominant","breakdown","formatHours","row","formatMinutes","cx","cy","radius","polarToCartesian","end","largeArc","angleInDegrees","angleInRadians","hours","ActivityChart","activities","colors","hovered","setHovered","cutoff","stats","productive","neutral","frivolity","draining","idle","recentActivities","activity","totalActive","acc","curr","totalIdle","total","byCategory","raw","breakdownByCategory","base","ctx","cat","buckets","label","a","b","currentAngle","center","category","percentage","angle","x1","y1","x2","y2","largeArcFlag","pathData","highlight","tooltipCategory","tooltipSeconds","tooltipPercent","formatHoursMinutes","totalMinutes","categoryLabels","DayJourney","journey","isRemote","seg","neutralCounts","pct","title","MAX_NODES","MAX_TRANSITIONS","ROW_HEIGHT","MAP_WIDTH","MAP_PADDING","AttentionMap","nodes","transitions","labeled","transitionMap","from","to","weights","pathSegments","maxCount","mapHeight","leftX","rightX","midX","nodePositions","fromY","toY","width","y","formatTime","Insights","overview","onRefresh","isControlled","localOverview","setLocalOverview","localLoading","setLocalLoading","excludedKeywords","setExcludedKeywords","refresh","useCallback","data","resolvedOverview","resolvedLoading","formatHour","h","ampm","trendIcon","trendLabel","scrubText","keyword","escaped","insight","FriendDetailModal","open","friend","publicLibraryItems","trophies","onClose","activeSeconds","productivityScore","trophyById","trophy","friendTrophies","id","event","formatHoursFromSeconds","percentOfTotal","formatShortDate","height","maxTimeline","dominant","parsed","DASHBOARD_SCENES","Dashboard","wallet","productivityGoalHoursOverride","setActivities","setSummary","loadingSummary","setLoadingSummary","setOverview","loadingOverview","setLoadingOverview","lastFrivolityAt","setLastFrivolityAt","lastFrivolityLoaded","setLastFrivolityLoaded","frivolityCount24h","setFrivolityCount24h","now","setNow","devices","setDevices","selectedDeviceId","setSelectedDeviceId","localDeviceId","setLocalDeviceId","friends","setFriends","friendSummaries","setFriendSummaries","friendsReady","setFriendsReady","myFriendSummary","setMyFriendSummary","myProfile","setMyProfile","selectedFriend","setSelectedFriend","friendTimeline","setFriendTimeline","friendPublicLibrary","setFriendPublicLibrary","friendDetailOpen","setFriendDetailOpen","setTrophies","trophySummary","setTrophySummary","trophyToast","setTrophyToast","flowMetric","setFlowMetric","setJourney","competitiveOptIn","setCompetitiveOptIn","pomodoroOpen","setPomodoroOpen","productivityGoalHours","setProductivityGoalHours","dashboardScene","setDashboardScene","saved","scene","silent","recent","journeyData","refreshOverview","loadLastFrivolity","today","formatDayInput","yesterday","count24h","days","day","last","refreshDevices","status","deviceList","localId","normalized","device","refreshFriends","list","summaries","mySummaryResult","profile","refreshTrophies","summaryResult","statusResult","openFriendDetail","publicLibrary","unsub","unsubPaywallStart","isAggregateView","isRemoteView","activeLabel","activeCategory","totalHours","isExcludedLabel","haystack","topContexts","timelineWindow","sortedActivities","THRASH_WINDOW_SECONDS","switchesByHour","map","prevKey","prevHour","hourStart","toHourStart","thrashByHour","prevDuration","switchesPerHour","switches","lastKey","thrashPerHour","thrash","myHeadToHeadSummary","activityToFriendSummary","flowTrend","active","idleRatio","idleSeconds","longestProductiveRunHours","best","current","lastFrivolityAgeMs","streakTargetMs","streakProgress","streakHue","streakLight","streakColor","deepWorkMinutes","startOfDayMs","productiveTodaySeconds","slotStart","goalHours","goalSeconds","ringProgressRaw","ringProgress","ringPercent","ringRadius","ringCircumference","ringOffset","ringComplete","remainingSeconds","pinnedTrophies","nextTrophy","formatGoalHours","formatHoursMinutesFromSeconds","formatDuration","buildSparklinePath","renderCategoryBar","productivePct","neutralPct","frivolityPct","headToHeadPercentFromSummary","formatCount","values","max","min","range","x","me","myProductive","friendProductive","year","month","normaliseDomain","trimmed","uniq","result","d","Domains","variant","setConfig","saving","setSaving","setSaved","setError","newDomain","setNewDomain","newCategory","setNewCategory","load","err","saveConfig","setDomainCategory","domain","removeDomain","handleQuickAdd","wrapperClass","DomainList","props","subtitle","items","disabled","onRemove","CurveEditor","onChange","isDragging","setIsDragging","svgRef","useRef","handleInteraction","rect","clientX","clientY","barWidth","normalizedY","newValue","newValues","val","i","barHeight","EconomyTuner","setItems","selectedId","setSelectedId","activeTab","setActiveTab","activeSessions","setActiveSessions","saveMessage","setSaveMessage","exchangeTarget","setExchangeTarget","exchangeApplying","setExchangeApplying","exchangeMessage","setExchangeMessage","dailyResetEnabled","setDailyResetEnabled","dailyResetSaving","setDailyResetSaving","isAdding","setIsAdding","newPackMinutes","setNewPackMinutes","newPackPrice","setNewPackPrice","isAddingPack","setIsAddingPack","loadData","refreshSessions","unsubEnd","rates","sessionsList","rateMap","r","getRate","defaultRate","rate","m","sessionMap","filteredItems","timer","selectedItem","locked","handleRateChange","newRate","updateItemRate","handleCurveChange","newModifiers","toggleDailyReset","save","handleAddProfile","metrics","modifiers","maxMod","minMod","isEarnProfile","median","nums","n","sorted","mid","roundRate","typicalEarn","it","typicalSpend","currentExchange","effectiveTarget","spendMultiplier","target","applyExchangeToSpendProfiles","spendProfiles","lockedDomains","editable","updated","pack","metric","newPacks","SETTINGS_PANES","Settings","theme","onThemeChange","activePane","setActivePane","idleThreshold","setIdleThreshold","frivolousIdleThreshold","setFrivolousIdleThreshold","emergencyPolicy","setEmergencyPolicy","emergencyReminderInterval","setEmergencyReminderInterval","journalUrl","setJournalUrl","journalMinutes","setJournalMinutes","peekEnabled","setPeekEnabled","peekAllowNewPages","setPeekAllowNewPages","continuityWindowSeconds","setContinuityWindowSeconds","excludedKeywordsText","setExcludedKeywordsText","syncStatus","setSyncStatus","syncDevices","setSyncDevices","deviceName","setDeviceName","handle","setHandle","profileColor","setProfileColor","syncBusy","setSyncBusy","zoteroConfig","setZoteroConfig","zoteroCollections","setZoteroCollections","zoteroCollectionsLoading","setZoteroCollectionsLoading","resetScope","setResetScope","resetBusy","setResetBusy","resetMessage","setResetMessage","cameraModeEnabled","setCameraModeEnabled","guardrailColorFilter","setGuardrailColorFilter","alwaysGreyscale","setAlwaysGreyscale","cameraPhotos","setCameraPhotos","cameraLoading","setCameraLoading","cameraError","setCameraError","keywords","refreshCameraPhotos","photos","requestCameraPermission","stream","track","handleCameraModeToggle","enabled","refreshSync","selectedZoteroCollection","c","refreshZoteroCollections","cols","handleReset","warnings","handleCameraReveal","handleCameraDelete","photo","activePaneConfig","pane","activePaneIndex","showPaneHeader","cur","Analytics","timeRange","setTimeRange","timeOfDay","setTimeOfDay","patterns","setPatterns","trends","setTrends","o","t","p","tr","maxHourValue","frivolityPatterns","scrubLabel","prodPct","neutPct","frivPct","drainPct","dominantClass","baseTotal","percent","point","maxTotal","deepPct","drainStop","frivStop","neutralStop","pattern","HARD_PUZZLE","HARD_SOLUTION","BLANK_CELLS","rowIndex","colIndex","createEmptyEntries","SudokuChallenge","requiredCorrect","unlockLabel","onUnlock","puzzleKey","entries","setEntries","startedAt","setStartedAt","unlocking","setUnlocking","unlockError","setUnlockError","requiredSquares","correctSquares","count","cell","solvedEnough","progressPercent","updateEntry","rawValue","clearPuzzle","handleUnlock","isFixed","currentValue","hasValue","isCorrect","classNames","clamp","SUDOKU_REQUIRED_SQUARES","SUDOKU_PASS_MINUTES","PaywallOverlay","state","marketRates","onWallet","selectedMinutes","setSelectedMinutes","sliderBounds","maxFromPacks","defaultMinutes","startMetered","snapshot","buyPack","unlockViaSudoku","blocked","insufficient","baseRate","matchedPack","sliderPrice","walletPercent","coinsLeft","gaugeRadius","circumference","dashOffset","sliderAffordable","sliderMidLabel","meteredPreviewPercent","dayShare","walletSharePct","daySharePct","projections","proj","PURPOSES","purposeLabel","purpose","purposeTone","normaliseUrl","url","normalisePrice","formatDate","dateStr","formatDayLabel","capitalize","hashString","input","hash","shortenUrl","faviconUrl","thumbUrl","Library","filter","setFilter","pricedOnly","setPricedOnly","viewMode","setViewMode","historyDay","setHistoryDay","historyEntries","setHistoryEntries","historyDays","setHistoryDays","historyLoading","setHistoryLoading","historyError","setHistoryError","newUrl","setNewUrl","newPurpose","setNewPurpose","newPriceEnabled","setNewPriceEnabled","newPrice","setNewPrice","newTitle","setNewTitle","newNote","setNewNote","newPublic","setNewPublic","editingId","setEditingId","editPurpose","setEditPurpose","editPriceEnabled","setEditPriceEnabled","editPrice","setEditPrice","editTitle","setEditTitle","editNote","setEditNote","editPublic","setEditPublic","editError","setEditError","isSaving","setIsSaving","loadItems","loadHistory","visible","resetAddForm","handleAdd","price","startEdit","cancelEdit","handleUpdate","note","handleRemove","handleToggleConsumed","urlLabel","icon","cover","coverSeed","coverStyle","coverInitial","isEditing","doneLabel","IconOpen","IconCheck","IconEdit","IconTrash","isSession","pillClass","sessionMode","normalizeHandle","formatPct","headToHeadPercent","Friends","setProfile","requests","setRequests","setSummaries","mySummary","setMySummary","selectedTimeline","setSelectedTimeline","selectedPublicLibrary","setSelectedPublicLibrary","detailOpen","setDetailOpen","handleInput","setHandleInput","addHandle","setAddHandle","handlePreview","setHandlePreview","busy","setBusy","syncReady","setSyncReady","refreshAll","ready","profileResult","friendResult","requestResult","trophyResult","competitive","friendCards","drainingPct","updateHandle","previewHandle","sendRequest","acceptRequest","declineRequest","cancelRequest","removeFriend","toggleCompetitive","request","TROPHY_CATEGORY_LABELS","MAX_PINNED","Profile","previewMode","setPreviewMode","profileSummary","statuses","pinnedIds","nextUp","grouped","groups","handleTogglePin","trophyId","pinned","profileName","profileHandle","isSecret","NYT_GAMES","Games","game","MIN_CAPTURE_WIDTH","MIN_CAPTURE_HEIGHT","FRAME_WAIT_TIMEOUT_MS","sleep","resolve","waitForUsableFrame","video","started","frameLooksBlank","sampleWidth","sampleHeight","brightCount","g","captureFrame","scale","targetWidth","targetHeight","canvas","dataUrl","CameraCapture","busyRef","unsubscribe","GREETINGS","TAGLINES","pickPhrase","seed","DailyOnboardingModal","dayKey","initial","onSave","onSkip","setGoalHours","setNote","greeting","tagline","DailyNoteModal","VIEW_LIST","isView","DAILY_START_HOUR","NOTE_DELIVERY_HOUR","dayKeyFor","local","App","setWallet","setMarketRates","economyState","setEconomyState","setTheme","extensionStatus","setExtensionStatus","paywallBlock","setPaywallBlock","dailyOnboardingState","setDailyOnboardingState","dailyOnboardingOpen","setDailyOnboardingOpen","dailyOnboardingSaving","setDailyOnboardingSaving","dailyOnboardingError","setDailyOnboardingError","dailyGoalHours","setDailyGoalHours","dailyIdleThreshold","setDailyIdleThreshold","dailyContinuityWindow","setDailyContinuityWindow","dailyEmergencyPolicy","setDailyEmergencyPolicy","dailyNote","setDailyNote","dailyNoteOpen","setDailyNoteOpen","nextState","nextNote","body","extensionStatusRef","unsubWallet","unsubEconomy","unsubMarket","unsubPaywallReq","unsubExtStatus","unsubPaywallEnd","handleDailySave","patch","handleDailySkip","handleDailyNoteClose","ReactDOM","React"],"mappings":"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"}