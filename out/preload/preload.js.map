{"version":3,"file":"preload.js","sources":["../../src/main/preload.ts"],"sourcesContent":["import { contextBridge, ipcRenderer } from 'electron';\nimport type { IpcRendererEvent } from 'electron';\nimport type { RendererApi } from '@shared/types';\n\nconst api: RendererApi = {\n  wallet: {\n    get: () => ipcRenderer.invoke('wallet:get'),\n    earn: (amount, meta) => ipcRenderer.invoke('wallet:earn', { amount, meta }),\n    spend: (amount, meta) => ipcRenderer.invoke('wallet:spend', { amount, meta })\n  },\n  focus: {\n    start: (duration) => ipcRenderer.invoke('focus:start', { duration }),\n    stop: (completed) => ipcRenderer.invoke('focus:stop', { completed }),\n    onTick: (callback) => {\n      const listener = (_event: IpcRendererEvent, payload: { remaining: number; progress: number }) => {\n        callback(payload);\n      };\n      ipcRenderer.on('focus:tick', listener);\n      return () => {\n        ipcRenderer.removeListener('focus:tick', listener);\n      };\n    }\n  },\n  activities: {\n    recent: (limit) => ipcRenderer.invoke('activities:recent', { limit }),\n    summary: (windowHours) => ipcRenderer.invoke('activities:summary', { windowHours })\n  },\n  market: {\n    list: () => ipcRenderer.invoke('market:list'),\n    upsert: (rate) => ipcRenderer.invoke('market:update', rate),\n    delete: (domain) => ipcRenderer.invoke('market:delete', { domain })\n  },\n  intentions: {\n    list: (date) => ipcRenderer.invoke('intentions:list', { date }),\n    add: (payload) => ipcRenderer.invoke('intentions:add', payload),\n    toggle: (id, completed) => ipcRenderer.invoke('intentions:toggle', { id, completed }),\n    remove: (id) => ipcRenderer.invoke('intentions:remove', { id })\n  },\n  budgets: {\n    list: () => ipcRenderer.invoke('budgets:list'),\n    add: (payload) => ipcRenderer.invoke('budgets:add', payload),\n    remove: (id) => ipcRenderer.invoke('budgets:remove', { id })\n  },\n  economy: {\n    state: () => ipcRenderer.invoke('economy:state'),\n    setNeutralClock: (enabled) => ipcRenderer.invoke('economy:neutral-clock', { enabled })\n  },\n  paywall: {\n    startMetered: (domain) => ipcRenderer.invoke('paywall:start-metered', { domain }),\n    buyPack: (domain, minutes) => ipcRenderer.invoke('paywall:buy-pack', { domain, minutes }),\n    decline: (domain) => ipcRenderer.invoke('paywall:decline', { domain }),\n    cancelPack: (domain) => ipcRenderer.invoke('paywall:cancel-pack', { domain }),\n    end: (domain, options) => ipcRenderer.invoke('paywall:end', { domain, refundUnused: options?.refundUnused }),\n    sessions: () => ipcRenderer.invoke('paywall:sessions'),\n    pause: (domain) => ipcRenderer.invoke('paywall:pause', { domain }),\n    resume: (domain) => ipcRenderer.invoke('paywall:resume', { domain })\n  },\n  settings: {\n    categorisation: () => ipcRenderer.invoke('settings:categorisation'),\n    updateCategorisation: (value) => ipcRenderer.invoke('settings:update-categorisation', value),\n    idleThreshold: () => ipcRenderer.invoke('settings:idle-threshold'),\n    updateIdleThreshold: (value) => ipcRenderer.invoke('settings:update-idle-threshold', value),\n    frivolousIdleThreshold: () => ipcRenderer.invoke('settings:frivolous-idle-threshold'),\n    updateFrivolousIdleThreshold: (value) => ipcRenderer.invoke('settings:update-frivolous-idle-threshold', value),\n    emergencyPolicy: () => ipcRenderer.invoke('settings:emergency-policy'),\n    updateEmergencyPolicy: (value) => ipcRenderer.invoke('settings:update-emergency-policy', value),\n    emergencyReminderInterval: () => ipcRenderer.invoke('settings:emergency-reminder-interval'),\n    updateEmergencyReminderInterval: (value) => ipcRenderer.invoke('settings:update-emergency-reminder-interval', value),\n    economyExchangeRate: () => ipcRenderer.invoke('settings:economy-exchange-rate'),\n    updateEconomyExchangeRate: (value) => ipcRenderer.invoke('settings:update-economy-exchange-rate', value),\n    journalConfig: () => ipcRenderer.invoke('settings:journal-config'),\n    updateJournalConfig: (value) => ipcRenderer.invoke('settings:update-journal-config', value)\n  },\n  integrations: {\n    zotero: {\n      config: () => ipcRenderer.invoke('integrations:zotero-config'),\n      updateConfig: (value) => ipcRenderer.invoke('integrations:update-zotero-config', value),\n      collections: () => ipcRenderer.invoke('integrations:zotero-collections')\n    }\n  },\n  library: {\n    list: () => ipcRenderer.invoke('library:list'),\n    add: (payload) => ipcRenderer.invoke('library:add', payload),\n    update: (id, payload) => ipcRenderer.invoke('library:update', { id, ...payload }),\n    remove: (id) => ipcRenderer.invoke('library:remove', { id }),\n    findByUrl: (url) => ipcRenderer.invoke('library:find-by-url', { url })\n  },\n  analytics: {\n    overview: (days) => ipcRenderer.invoke('analytics:overview', { days }),\n    timeOfDay: (days) => ipcRenderer.invoke('analytics:time-of-day', { days }),\n    patterns: (days) => ipcRenderer.invoke('analytics:patterns', { days }),\n    engagement: (domain, days) => ipcRenderer.invoke('analytics:engagement', { domain, days }),\n    trends: (granularity) => ipcRenderer.invoke('analytics:trends', { granularity })\n  },\n  friends: {\n    identity: () => ipcRenderer.invoke('friends:identity'),\n    enable: (payload) => ipcRenderer.invoke('friends:enable', payload),\n    disable: () => ipcRenderer.invoke('friends:disable'),\n    publishNow: () => ipcRenderer.invoke('friends:publish'),\n    list: () => ipcRenderer.invoke('friends:list'),\n    add: (friend) => ipcRenderer.invoke('friends:add', friend),\n    remove: (id) => ipcRenderer.invoke('friends:remove', { id }),\n    fetchAll: () => ipcRenderer.invoke('friends:fetch-all')\n  },\n  events: {\n    on: <T = unknown>(channel: string, callback: (payload: T) => void) => {\n      const listener = (_event: IpcRendererEvent, payload: T) => callback(payload);\n      ipcRenderer.on(channel, listener);\n      return () => ipcRenderer.removeListener(channel, listener);\n    }\n  }\n};\n\ncontextBridge.exposeInMainWorld('twsp', api);\n"],"names":["ipcRenderer","contextBridge"],"mappings":"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"}